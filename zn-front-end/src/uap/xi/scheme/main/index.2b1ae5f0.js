/*! @ncctag {"date":"2020-5-11 23:45:29"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uap/xi/scheme/main/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uap/xi/scheme/main/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,o){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="../../../../",o(o.s=84)}({0:function(t,o){t.exports=e},1:function(e,o){e.exports=t},2:function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o=function(e,t){var o=e[1]||"",r=e[3];if(!r)return o;if(t&&"function"==typeof btoa){var a=(s=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),n=r.sources.map((function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"}));return[o].concat(n).concat([a]).join("\n")}var s;return[o].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+o+"}":o})).join("")},t.i=function(e,o){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},a=0;a<this.length;a++){var n=this[a][0];"number"==typeof n&&(r[n]=!0)}for(a=0;a<e.length;a++){var s=e[a];"number"==typeof s[0]&&r[s[0]]||(o&&!s[2]?s[2]=o:o&&(s[2]="("+s[2]+") and ("+o+")"),t.push(s))}},t}},3:function(e,t,o){var r,a,n={},s=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=r.apply(this,arguments)),a}),l=function(e){var t={};return function(o){return void 0===t[o]&&(t[o]=e.call(this,o)),t[o]}}((function(e){return document.querySelector(e)})),i=null,c=0,u=[],p=o(4);function d(e,t){for(var o=0;o<e.length;o++){var r=e[o],a=n[r.id];if(a){a.refs++;for(var s=0;s<a.parts.length;s++)a.parts[s](r.parts[s]);for(;s<r.parts.length;s++)a.parts.push(y(r.parts[s],t))}else{var l=[];for(s=0;s<r.parts.length;s++)l.push(y(r.parts[s],t));n[r.id]={id:r.id,refs:1,parts:l}}}}function m(e,t){for(var o=[],r={},a=0;a<e.length;a++){var n=e[a],s=t.base?n[0]+t.base:n[0],l={css:n[1],media:n[2],sourceMap:n[3]};r[s]?r[s].parts.push(l):o.push(r[s]={id:s,parts:[l]})}return o}function f(e,t){var o=l(e.insertInto);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=u[u.length-1];if("top"===e.insertAt)r?r.nextSibling?o.insertBefore(t,r.nextSibling):o.appendChild(t):o.insertBefore(t,o.firstChild),u.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");o.appendChild(t)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function v(e){var t=document.createElement("style");return e.attrs.type="text/css",b(t,e.attrs),f(e,t),t}function b(e,t){Object.keys(t).forEach((function(o){e.setAttribute(o,t[o])}))}function y(e,t){var o,r,a,n;if(t.transform&&e.css){if(!(n=t.transform(e.css)))return function(){};e.css=n}if(t.singleton){var s=c++;o=i||(i=v(t)),r=k.bind(null,o,s,!1),a=k.bind(null,o,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(o=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",b(t,e.attrs),f(e,t),t}(t),r=E.bind(null,o,t),a=function(){h(o),o.href&&URL.revokeObjectURL(o.href)}):(o=v(t),r=w.bind(null,o),a=function(){h(o)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else a()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var o=m(e,t);return d(o,t),function(e){for(var r=[],a=0;a<o.length;a++){var s=o[a];(l=n[s.id]).refs--,r.push(l)}e&&d(m(e,t),t);for(a=0;a<r.length;a++){var l;if(0===(l=r[a]).refs){for(var i=0;i<l.parts.length;i++)l.parts[i]();delete n[l.id]}}}};var g,x=(g=[],function(e,t){return g[e]=t,g.filter(Boolean).join("\n")});function k(e,t,o,r){var a=o?"":r.css;if(e.styleSheet)e.styleSheet.cssText=x(t,a);else{var n=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(n,s[t]):e.appendChild(n)}}function w(e,t){var o=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}function E(e,t,o){var r=o.css,a=o.sourceMap,n=void 0===t.convertToAbsoluteUrls&&a;(t.convertToAbsoluteUrls||n)&&(r=p(r)),a&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var s=new Blob([r],{type:"text/css"}),l=e.href;e.href=URL.createObjectURL(s),l&&URL.revokeObjectURL(l)}},4:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var o=t.protocol+"//"+t.host,r=o+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var a,n=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(n)?e:(a=0===n.indexOf("//")?n:0===n.indexOf("/")?o+n:r+n.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")}))}},5:function(e,t){e.exports=o},84:function(e,t,o){"use strict";var r,a,n=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),s=o(1),l=d(s),i=d(o(5)),c=o(0),u=o(85),p=o(89);function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o(90);var f=c.base.NCDiv,h=c.base.NCButton,v=(c.high.Refer,c.high.FormulaEditor),b=(r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.call(o),o.formId="schemeinfo",o.state={account:"",billtype:"",exsystem:"",aamlevel:"",billitemArr:[],formulaEditorShow:!1,formulaEditorValue:"",formulaInValue:"",formulaOutValue:"",classid:"",selectAttr:"",modaltile:"",editAttr:"",selectForm:"",ruleValue:"",varValue:"",billdefination:{},json:{},inlt:null},o.rule_table={},o.globle_table={},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentDidMount",value:function(){this.changeButtonVisable(this.props)}},{key:"componentWillMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"xi-scheme",domainName:"uap",callback:function(t,o,r){o?e.setState({json:t,inlt:r}):console.log("未加载到多语资源")}})}},{key:"dirMove",value:function(e){var t=this.state.modifyNode,o=(this.props.syncTree.getSyncTreeValue("tree1"),this.props.syncTree.getSyncTreeValue("tree1",t.pid)),r=void 0,a=void 0;o.children.find((function(e,o){e.refpk===t.refpk&&(r=e,a=o)})),o.children.splice(a,1),-1==e?a+e>-1?o.children.splice(a+e,0,r):o.children.splice(o.children.length,0,r):a<o.children.length?o.children.splice(a+e,0,r):o.children.splice(0,0,r),o.children.find((function(e,o){e.refpk===t.refpk&&(r=e,a=o)})),this.setState({currIndex:a,currNode:r})}},{key:"render",value:function(){var e=this,t=this.props,o=t.modal,r=t.button,a=t.form,n=t.syncTree,s=o.createModal,i=a.createForm,c=(r.createButtonApp,n.createSyncTree),d=this.props.DragWidthCom,m=this.props.BillHeadInfo.createBillHeadInfo,h=l.default.createElement("div",{className:"tree-area"},c({treeId:"tree1",metaId:this.formId,needEdit:!0,showLine:!0,disabledSearch:!0,needSearch:!1,draggable:!1,defaultExpandAll:!0,showModal:!1,clickEditIconEve:this.clickEditIconEve.bind(this),clickAddIconEve:this.clickAddIconEve.bind(this),clickDelIconEve:this.clickDelIconEve.bind(this),addNodeCallBack:this.addNodeCallBack.bind(this),onMouseEnterEve:this.onMouseEnterEve.bind(this),onSelectEve:this.onSelectEve})),b=l.default.createElement("div",{className:"table-area"},l.default.createElement("div",{className:"nc-bill-table-area"},i(this.formId,{onAfterEvent:this.onAfterFormEvent.bind(this),onBeforeEvent:this.onBeforeFormEvent.bind(this)})));return l.default.createElement("div",{className:"nc-single-table"},l.default.createElement(f,{areaCode:f.config.HEADER},l.default.createElement("div",{fieldid:"header-area",className:"nc-singleTable-header-area"},l.default.createElement("div",{className:"header-title-search-area"},m({title:""+this.state.json["1221000025-000012"],initShowBackBtn:!1})),l.default.createElement("div",{className:"header-button-area"},this.props.button.createButtonApp({area:"page_header",buttonLimit:8,onButtonClick:u.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")})))),l.default.createElement("div",{className:"tree-table"},l.default.createElement(d,{leftDom:h,rightDom:b,defLeftWid:"20%"})),l.default.createElement(v,{ref:"formulaEditor",value:this.state.formulaEditorValue,show:this.state.formulaEditorShow,attrConfig:[{tab:this.state.json["1221000025-000005"],TabPaneContent:p.schemeDom,key:"schemeDom",params:{dataact:this.state.billitemArr}}],noShowAttr:[this.state.json["1221000025-000006"]],onHide:function(){e.formulaEditorCancel("")},onOk:function(t){e.formulaEditorOK(t)},onCancel:function(t){e.formulaEditorCancel(t)},metaParam:{classid:this.state.classid}}),s("insertnode",{title:this.state.json["1221000025-000014"],content:this.insertnode(),beSureBtnClick:this.insertnodeBtnClick.bind(this),size:"lg"}),s("openModal",{title:this.state.json["1221000025-000007"],content:this.pramaSet(),beSureBtnClick:this.beSureBtnClick.bind(this),size:"lg"}),s("recordModal",{title:this.state.json["1221000025-000008"],content:this.recordSet(),beSureBtnClick:this.recordbeSureBtnClick.bind(this),size:"lg"}),s("wholeModal",{title:this.state.json["1221000025-000008"],content:this.wholeSet(),beSureBtnClick:this.wholebeSureBtnClick.bind(this),size:"lg"}),s("comprule",{title:this.state.modaltile,content:this.comprule(),beSureBtnClick:this.combeSureBtnClick.bind(this),cancelBtnClick:this.combecancelBtnClick.bind(this),closeModalEve:this.combecancelBtnClick.bind(this),size:"lg"}),s("globlemanager",{title:this.state.modaltile,content:this.globlemanager(),beSureBtnClick:this.globleSureBtnClick.bind(this),cancelBtnClick:this.globlecancelBtnClick.bind(this),closeModalEve:this.globlecancelBtnClick.bind(this),size:"lg"}),s("listIndex",{title:this.state.json["1221000025-000021"],content:this.listnode(),beSureBtnClick:this.moveFieldBtnClick.bind(this),cancelBtnClick:this.cancelBtnClick.bind(this),size:"lg"}))}}]),t}(s.Component),a=function(){var e=this;this.changeButtonVisable=function(e){e.button.setButtonVisible(["savebtn"],!1)},this.insertnode=function(){var t=e.props,o=t.syncTree,r=t.form.createForm;o.createSyncTree;return l.default.createElement("div",{className:"scheme"},l.default.createElement("p",{className:"u-p"},e.state.json["1221000025-000017"]),l.default.createElement("hr",null),r(e.formId,{onAfterEvent:e.onAfterFormEvent.bind(e),onBeforeEvent:e.onBeforeFormEvent.bind(e)}))},this.listnode=function(){return l.default.createElement("div",null,l.default.createElement(h,{onClick:e.dirMove.bind(e,-1)},e.state.json["1221000025-000015"]),l.default.createElement(h,{onClick:e.dirMove.bind(e,1)},e.state.json["1221000025-000016"]))},this.moveFieldBtnClick=function(){var t=e.state,o=t.currIndex,r=t.currNode;console.log(o,r);e.props.form.getAllFormValue(e.formId);var a=o,n={pid:r.pid,pk:r.refpk,billtype:e.state.billtype,exsystem:e.state.exsystem,aamlevel:e.state.aamlevel,index:a};(0,c.ajax)({url:"/nccloud/pfxx/scheme/movenode.do",data:n,success:function(e){e.success&&(0,c.toast)({color:"success"})},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})},this.cancelBtnClick=function(){var t=e,o=e.state,r=o.account,a=o.billtype,n=o.exsystem,s=o.aamlevel,l=null;(0,c.ajax)({url:"/nccloud/pfxx/scheme/schemeTreeQuery.do",data:{account:r,billtype:a,exsystem:n,aamlevel:s},success:function(e){(l=e.data)&&l.data&&(t.props.syncTree.setSyncTreeData("tree1",l.data.rows),t.props.syncTree.setNodeSelected("tree1",l.data.rows[0].children[0].refpk),t.props.syncTree.openNodeByPk("tree1",l.data.rows[0].children[0].refpk))},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})},this.pramaSet=function(){var t=e.props,o=t.syncTree,r=t.form.createForm;o.createSyncTree;return l.default.createElement("div",{className:"scheme"},l.default.createElement("p",{className:"u-p"},e.state.json["1221000025-000009"]),l.default.createElement("hr",null),r("paramset",{onAfterEvent:u.afterEvent}))},this.recordSet=function(){var t=e.props,o=(t.syncTree,t.form.createForm);return l.default.createElement("div",{className:"scheme"},l.default.createElement("p",{className:"u-p"},e.state.json["1221000025-000010"]),l.default.createElement("hr",null),o("record",{onAfterEvent:u.afterEvent}))},this.wholeSet=function(){var t=e.props,o=(t.syncTree,t.form.createForm);return l.default.createElement("div",{className:"scheme"},l.default.createElement("p",{className:"u-p"},e.state.json["1221000025-000011"]),l.default.createElement("hr",null),o("whole",{onAfterEvent:e.onAfterFormEvent.bind(e)}))},this.comprule=function(){var t=e.props,o=(t.syncTree,t.editTable.createEditTable);return l.default.createElement("div",{className:"scheme"},l.default.createElement("div",{className:"header-button-scheme"},e.props.button.createButtonApp({area:"page_body",buttonLimit:8,onButtonClick:u.buttonClick.bind(e),popContainer:document.querySelector(".header-button-area")})),l.default.createElement("hr",null),o("comprule",{showCheck:!0,showIndex:!0,onAfterEvent:u.afterEvent}))},this.globlemanager=function(){var t=e.props,o=(t.syncTree,t.editTable.createEditTable);return l.default.createElement("div",{className:"scheme"},l.default.createElement("div",{className:"header-button-scheme"},e.props.button.createButtonApp({area:"page_body",buttonLimit:8,onButtonClick:e.globleButtonClick.bind(e),popContainer:document.querySelector(".header-button-area")})),l.default.createElement("hr",null),o("globlemanager",{showCheck:!0,showIndex:!0,onAfterEvent:u.afterEvent}))},this.globleButtonClick=function(t,o){switch(o){case"addlinebtn":e.props.editTable.addRow("globlemanager");break;case"dellinebtn":var r=t.editTable.getCheckedRows("globlemanager");if(0==r.length)return void(0,c.toast)({content:e.state.json["1221000025-000013"],color:"warning"});var a=r.map((function(e){return e.index}));e.props.editTable.deleteTableRowsByIndex("globlemanager",a)}},this.beSureBtnClick=function(){var t=e,o=t.props.form.getFormItemsValue("paramset","account"),r=t.props.form.getFormItemsValue("paramset","billtype"),a=t.props.form.getFormItemsValue("paramset","exsystem"),n=t.props.form.getFormItemsValue("paramset","aamlevel"),s=null;(0,c.ajax)({url:"/nccloud/pfxx/scheme/schemeTreeQuery.do",data:{account:o,billtype:r,exsystem:a,aamlevel:n},success:function(e){if((s=e.data)&&s.data){t.props.form.EmptyAllFormValue(t.formId),t.props.syncTree.setSyncTreeData("tree1",s.data.rows),t.props.syncTree.setNodeSelected("tree1",s.data.rows[0].children[0].refpk),t.props.syncTree.openNodeByPk("tree1",s.data.rows[0].children[0].refpk),t.setState({account:o,billtype:r,exsystem:a,aamlevel:n});var l=t.props.meta.getMeta();l[t.formId].items.map((function(e){"type"==e.attrcode&&(e.options=[],e.options=s.type)})),t.props.meta.setMeta(l)}},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})},this.insertnodeBtnClick=function(){var t=e.props.syncTree.getSelectNode("tree1"),o=e,r=e.props.form.getAllFormValue(e.formId),a={pid:t.pid,pk:t.refpk,billtype:e.state.billtype,exsystem:e.state.exsystem,aamlevel:e.state.aamlevel,schemeform:{schemeform:r}},n=null;(0,c.ajax)({url:"/nccloud/pfxx/scheme/schemeinsert.do",data:a,success:function(e){e.success&&((n=e.data)&&(o.props.syncTree.setSyncTreeData("tree1",n.rows),o.props.syncTree.setNodeSelected("tree1",n.rows[0].children[0].refpk),o.props.syncTree.openNodeByPk("tree1",n.rows[0].children[0].refpk)),(0,c.toast)({color:"success"}))},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})},this.recordbeSureBtnClick=function(){var t=e.props.syncTree.getSelectNode("tree1"),o=e,r=e.props.form.getAllFormValue("record"),a={pid:t.pid,pk:t.refpk,billtype:e.state.billtype,exsystem:e.state.exsystem,aamlevel:e.state.aamlevel,schemeform:{schemeform:r}};(0,c.ajax)({url:"/nccloud/pfxx/scheme/schemeRecordSave.do",data:a,success:function(e){e.success&&(o.props.form.setFormStatus(o.formId,"browse"),o.props.button.setButtonVisible(["savebtn"],!1),(0,c.toast)({color:"success"}))},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})},this.wholebeSureBtnClick=function(){var t=e.props.syncTree.getSelectNode("tree1"),o=e,r=e.props.form.getAllFormValue("whole"),a={pid:t.pid,pk:t.refpk,billtype:e.state.billtype,exsystem:e.state.exsystem,aamlevel:e.state.aamlevel,schemeform:{schemeform:r}};(0,c.ajax)({url:"/nccloud/pfxx/scheme/schemeRecordSave.do",data:a,success:function(e){e.success&&(o.props.form.setFormStatus(o.formId,"edit"),o.props.button.setButtonVisible(["savebtn"],!1),(0,c.toast)({color:"success"}))},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})},this.combeSureBtnClick=function(){var t=e,o=t.props.editTable.getAllRows("comprule");e.rule_table=t.props.editTable.getAllData("comprule");var r="",a=e.state.editAttr,n=e.state.selectForm;o.map((function(e){if(3!=e.status){var t=e.values.code.value,o=e.values.name.value;""==t&&""==o||(""==r||(r+=";"),r=r+t+"="+o)}}));var s=e.props.meta.getMeta();s[n].items.map((function(e){if(e.attrcode==a){var o={display:r,value:r};return 1==e.options.length?e.options.unshift(o):e.options[0]=o,"rule"==e.attrcode&&t.props.form.setFormItemsValue(n,{rule:{value:o.value,display:o.display}}),"varsDisplay"==e.attrcode&&t.props.form.setFormItemsValue(n,{varsDisplay:{value:o.value,display:o.display}}),"rule"==e.attrcode?t.setState({ruleValue:r}):t.setState({varValue:r}),void t.props.modal.close("comprule")}})),t.props.meta.setMeta(s)},this.combecancelBtnClick=function(){e.props.editTable.getAllRows("comprule");var t=e,o=e.state.editAttr,r=e.state.selectForm;e.props.meta.getMeta()[r].items.map((function(a){if(a.attrcode==o)if(1==a.options.length)if("rule"==o){var n={display:e.state.ruleValue,value:e.state.ruleValue};a.options.unshift(n),t.props.form.setFormItemsValue(r,{rule:{value:n.value,display:n.display}})}else{var s={display:e.state.varValue,value:e.state.varValue};a.options.unshift(s),t.props.form.setFormItemsValue(r,{varsDisplay:{value:s.value,display:s.display}})}else"rule"==o?t.props.form.setFormItemsValue(r,{rule:{value:a.options[0].value,display:a.options[0].display}}):t.props.form.setFormItemsValue(r,{varsDisplay:{value:a.options[0].value,display:a.options[0].display}})}))},this.globleSureBtnClick=function(){var t=e;e.globle_table=e.props.editTable.getAllData("globlemanager");var o=t.props.editTable.getAllRows("globlemanager"),r="",a=e.state.editAttr,n=e.state.selectForm;o.map((function(e){var t=e.values.code.value,o=e.values.name.value;""==t&&""==o||(""==r||(r+=";"),r=r+t+"="+o)}));var s=e.props.meta.getMeta();s[n].items.map((function(e){if(e.attrcode==a){var o={display:r,value:r};1==e.options.length?e.options.unshift(o):e.options[0]=o,"rule"==e.attrcode&&t.props.form.setFormItemsValue(n,{rule:{value:o.value,display:o.display}}),"varsDisplay"==e.attrcode&&t.props.form.setFormItemsValue(n,{varsDisplay:{value:o.value,display:o.display}}),"rule"==e.attrcode?t.setState({ruleValue:r}):t.setState({varValue:r})}})),e.props.meta.setMeta(s)},this.globlecancelBtnClick=function(){var t=e,o=e.state.editAttr,r=e.state.selectForm;e.props.meta.getMeta()[r].items.map((function(a){if(a.attrcode!=o);else{if(1==a.options.length)if("rule"==o){var n={display:e.state.ruleValue,value:e.state.ruleValue};a.options.unshift(n),t.props.form.setFormItemsValue(r,{rule:{value:n.value,display:n.display}})}else{var s={display:e.state.varValue,value:e.state.varValue};a.options.unshift(s),t.props.form.setFormItemsValue(r,{varsDisplay:{value:s.value,display:s.display}})}else"rule"==o?t.props.form.setFormItemsValue(r,{rule:{value:a.options[0].value,display:a.options[0].display}}):t.props.form.setFormItemsValue(r,{varsDisplay:{value:a.options[0].value,display:a.options[0].display}});t.props.modal.close("selectForm")}})),t.props.modal.close("selectForm")},this.onBeforeFormEvent=function(t,o,r,a,n,s){return e.setState({selectAttr:r}),"formulaIn"==r?e.setState({formulaEditorValue:e.state.formulaInValue}):"formulaOut"==r&&e.setState({formulaEditorValue:e.state.formulaOutValue}),!0},this.clickEditIconEve=function(t){if(t.isleaf)e.setState({modifyNode:t}),e.props.modal.show("listIndex");else{var o=e,r=o.state.billtype,a=o.state.exsystem,n=o.state.aamlevel,s=t.pid,l=t.refpk;o.props.form.EmptyAllFormValue(o.formId);var i={pid:s,pk:l,billtype:r,exsystem:a,aamlevel:n};(0,c.ajax)({url:"/nccloud/pfxx/scheme/RecordQuery.do",data:i,success:function(e){e.success;var t=e.data;if(t)if(o.props.form.setFormStatus(o.formId,"edit"),"root"==l){t.comparelist?(o.globle_table=t.comparelist.comparelist,o.props.editTable.setTableData("globlemanager",o.globle_table)):o.props.editTable.setTableData("globlemanager",{rows:[]}),o.props.form.setAllFormValue(m({},"whole",t.bill.bill)),o.props.form.setFormStatus("whole","edit");var r=t.bill.bill.rows[0].values.varsDisplay.value;null==r&&(r="");var a=o.props.meta.getMeta();a.whole.items.map((function(e){if("varsDisplay"==e.attrcode){var t={display:r,value:r};1==e.options.length?e.options.unshift(t):e.options[0]=t}})),o.props.meta.setMeta(a),o.setState({selectForm:"whole",varValue:r}),o.props.modal.show("wholeModal")}else o.props.form.setAllFormValue(m({},"record",t.record.record)),o.props.form.setFormStatus("record","edit"),o.props.modal.show("recordModal"),o.setState({selectForm:"record"})},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})}},this.clickAddIconEve=function(e){},this.delNodeCallBack=function(e){},this.clickDelIconEve=function(t){(0,c.promptBox)({color:"warning",title:e.state.json["1221000025-000018"],content:e.state.json["1221000025-000019"],beSureBtnClick:function(){var o=t.pid,r=t.refpk,a=e.state.billtype,n=e.state.exsystem,s=e.state.aamlevel,l=e,i={pid:o,pk:r,billtype:a,exsystem:n,aamlevel:s};(0,c.ajax)({url:"/nccloud/pfxx/scheme/schemedelete.do",data:i,success:function(e){if(e.success){var o=t,r=e.data;l.props.syncTree.setSyncTreeData("tree1",r.rows),setTimeout((function(){l.props.syncTree.openNodeByPk("tree1",o.pid),l.props.syncTree.setNodeSelected("tree1",o.pid)}),1),l.props.button.setButtonVisible(["savebtn"],!1),l.props.form.EmptyAllFormValue(l.formId),(0,c.toast)({color:"success"})}},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})}})},this.addNodeCallBack=function(e,t,o){},this.onMouseEnterEve=function(t,o){if(o.isleaf){e.props.syncTree.hideIcon("tree1",o.eventKey,{delIcon:!0,editIcon:!0,addIcon:!1})}else{e.props.syncTree.hideIcon("tree1",o.eventKey,{delIcon:!1,editIcon:!0,addIcon:!1})}},this.onAfterFormEvent=function(t,o,r,a,n,s){"formulaIn"!=r&&"formulaOut"!=r||"editformula"==a.value&&e.setState({formulaEditorShow:!0}),"rule"!=r&&"varsDisplay"!=r||("rule"==r&&"editrule"==a.value&&e.setState({editAttr:"rule",modaltile:e.state.json["1221000025-000003"]}),"varsDisplay"==r&&"editvar"==a.value&&e.setState({editAttr:"varsDisplay",modaltile:e.state.json["1221000025-000004"]}),"schemeinfo"==o?(e.props.editTable.setTableData("comprule",e.rule_table),e.props.editTable.setStatus("comprule","edit"),e.props.modal.show("comprule")):"whole"==o&&(e.props.editTable.setTableData("globlemanager",e.globle_table),e.props.editTable.setStatus("globlemanager","edit"),e.props.modal.show("globlemanager")))},this.formulaEditorCancel=function(t){var o=e,r=o.state.selectAttr;e.props.meta.getMeta()[e.formId].items.map((function(t){if(t.attrcode!=r);else{if(1==t.options.length)if("formulaIn"==r){var a={display:e.state.formulaInValue,value:e.state.formulaInValue};t.options.unshift(a),o.props.form.setFormItemsValue(o.formId,{formulaIn:{value:a.value,display:a.display}})}else{var n={display:e.state.formulaOutValue,value:e.state.formulaOutValue};t.options.unshift(n),o.props.form.setFormItemsValue(o.formId,{formulaOut:{value:n.value,display:n.display}})}else"formulaIn"==r?o.props.form.setFormItemsValue(e.formId,{formulaIn:{value:t.options[0].value,display:t.options[0].display}}):o.props.form.setFormItemsValue(e.formId,{formulaOut:{value:t.options[0].value,display:t.options[0].display}});o.setState({formulaEditorShow:!1})}})),o.setState({formulaEditorShow:!1})},this.formulaEditorOK=function(t){var o=e,r=o.state.selectAttr,a=o.props.meta.getMeta();a[o.formId].items.map((function(e){if(e.attrcode==r){var a={display:t,value:t};return 1==e.options.length?e.options.unshift(a):e.options[0]=a,"formulaIn"==e.attrcode&&o.props.form.setFormItemsValue(o.formId,{formulaIn:{value:a.value,display:a.display}}),"formulaOut"==e.attrcode&&o.props.form.setFormItemsValue(o.formId,{formulaOut:{value:a.value,display:a.display}}),"formulaIn"==e.attrcode?o.setState({formulaInValue:t}):o.setState({formulaOutValue:t}),void o.setState({formulaEditorShow:!1})}})),o.props.meta.setMeta(a)},this.onSelectEve=function(t,o){var r=e,a=r.state.billtype,n=r.state.exsystem,s=r.state.aamlevel,l=o.pid,i=o.refpk;if(r.props.form.EmptyAllFormValue(r.formId),o.isleaf){var u={pid:l,pk:i,billtype:a,exsystem:n,aamlevel:s},p=null;(0,c.ajax)({url:"/nccloud/pfxx/scheme/schemeQuery.do",data:u,success:function(e){if(p=e.data,e.success){var t=r.props.meta.getMeta();r.props.form.setAllFormValue(m({},r.formId,p.schemeinfo.schemeinfo)),p.comparelist?(r.rule_table=p.comparelist.comparelist,r.props.editTable.setTableData("comprule",r.rule_table)):r.props.editTable.setTableData("comprule",{rows:[]});var o=p.schemeinfo.schemeinfo.rows[0].values.formulaIn.value;null==o&&(o="");var a=p.schemeinfo.schemeinfo.rows[0].values.rule.value;null==a&&(a="");var n=p.schemeinfo.schemeinfo.rows[0].values.formulaOut.value;null==n&&(n=""),t[r.formId].items.map((function(e){if("type"==e.attrcode)e.options=[],e.options=p.type;else if("formulaIn"==e.attrcode){var t={display:o,value:o};1==e.options.length?e.options.unshift(t):e.options[0]=t}else if("formulaOut"==e.attrcode){var r={display:n,value:n};1==e.options.length?e.options.unshift(r):e.options[0]=r}else if("rule"==e.attrcode){var s={display:a,value:a};1==e.options.length?e.options.unshift(s):e.options[0]=s}})),r.setState({billitemArr:p.formulaitemlist,formulaInValue:o,formulaOutValue:n,rulevalue:a,selectForm:r.formId}),r.props.meta.setMeta(t),r.props.button.setButtonVisible("savebtn",!0),r.props.form.setFormStatus(r.formId,"edit")}},error:function(e){(0,c.toast)({content:e.message,color:"danger"})}})}else console.log("非叶子节点模态框点击编辑按钮")}},r);b=(0,c.createPage)({initTemplate:u.initTemplate})(b),i.default.render(l.default.createElement(b,null),document.querySelector("#app")),b=(0,c.createPage)({initTemplate:u.initTemplate})(b),i.default.render(l.default.createElement(b,null),document.querySelector("#app"))},85:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.afterEvent=t.buttonClick=t.initTemplate=void 0;var r=s(o(86)),a=s(o(87)),n=s(o(88));function s(e){return e&&e.__esModule?e:{default:e}}t.initTemplate=r.default,t.buttonClick=a.default,t.afterEvent=n.default},86:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.createUIDom({pagecode:"12210709_card"},(function(t){if(t){if(t.button){var o=t.button;e.button.setButtons(o)}if(t.template){t.template.schemeinfo.status="edit";var r=t.template;e.meta.setMeta(r)}}}))};o(0)},87:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=this,a=e.syncTree.getSelectNode("tree1");switch(t){case"insertnode":var n=e.syncTree.getSelectNode("tree1");if(null==n||n.isleaf||"root"==n.refpk)return void(0,r.toast)({content:this.state.json["1221000025-000020"],color:"danger"});e.form.setFormStatus("schemeinfo","edit"),e.modal.show("insertnode");break;case"openbtn":(0,r.ajax)({url:"/nccloud/pfxx/scheme/SchemeQueryInfo.do",success:function(t){t.success;var r=t.data;if(r){var a=o.props.meta.getMeta();a.paramset.items.map((function(e){"account"==e.attrcode&&(e.options=[],e.options=r.account,o.props.form.setFormItemsValue("paramset",{account:{value:e.options[0].value,display:e.options[0].display}}))})),a.paramset.items.map((function(e){"aamlevel"==e.attrcode&&(e.options=[],e.options=r.aamlevel)})),o.props.form.setFormItemsValue("paramset",{aamlevel:{value:"0",display:o.state.json["1221000025-000000"]}}),e.form.setFormStatus("paramset","edit"),e.modal.show("openModal")}},error:function(e){(0,r.toast)({content:e.message,color:"danger"})}});break;case"addlinebtn":this.props.editTable.addRow("comprule");break;case"dellinebtn":var s=e.editTable.getCheckedRows("comprule");if(0==s.length)return void(0,r.toast)({content:this.state.json["1221000025-000013"],color:"warning"});var l=s.map((function(e){return e.index}));this.props.editTable.deleteTableRowsByIndex("comprule",l);break;case"savebtn":var i=e.form.getAllFormValue("schemeinfo");e.syncTree.setNodeDisable("tree1","","");var c=a.pid,u=a.refpk,p=this.state.billtype,d=this.state.exsystem,m=this.state.aamlevel,f={pid:c,pk:u,billtype:p,exsystem:d,aamlevel:m,schemeform:{schemeform:i}};(0,r.ajax)({url:"/nccloud/pfxx/scheme/schemeSave.do",data:f,success:function(t){if(t.success){var o=a;o.key=i.rows[0].values.matchTag.value,o.refcode=i.rows[0].values.matchTag.value,o.refpk=i.rows[0].values.matchTag.value,o.refname=i.rows[0].values.desc.value;var n=t.data;e.syncTree.setSyncTreeData("tree1",n.rows),setTimeout((function(){e.syncTree.openNodeByPk("tree1",o.pid),e.syncTree.setNodeSelected("tree1",o.refpk)}),1),e.form.setFormStatus("schemeinfo","browse"),e.button.setButtonVisible(["savebtn"],!1),(0,r.toast)({color:"success"})}},error:function(e){(0,r.toast)({content:e.message,color:"danger"})}})}};var r=o(0);r.base.NCMessage},88:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,r,a){if("comprule"===t){var n=e.editTable.getChangedRows("comprule",!1);if(!e.editTable.checkRequired("comprule",n))return}else if("globlemanager"===t){var s=e.editTable.getChangedRows("globlemanager",!1);if(!e.editTable.checkRequired("globlemanager",s))return}};o(0)},89:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.schemeDom=void 0;var r,a=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),n=o(1),s=(r=n)&&r.__esModule?r:{default:r},l=o(0);l.base.NCSelect.NCOption;var i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o._createTabPaneContent=function(e){return e.map((function(e,t){var r=e.inputSig,a=e.displayName,n=e.hintMsg;return s.default.createElement("li",{className:"tab-content-item",onClick:function(){o.props.setExplain(n)},onDoubleClick:function(){o.props.setName(r)}},a)}))},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=(e.table,e.editTable);e.DragWidthCom,e.onClick,e.onDbClick,t.createEditTable;return s.default.createElement("div",{className:"nc-bill-list"},s.default.createElement("div",{className:"nc-bill-table-area"},s.default.createElement("ul",{className:"tab-content"},this._createTabPaneContent(this.props.dataact))))}}]),t}(n.Component),c=(0,l.createPage)({})(i);t.schemeDom=c},90:function(e,t,o){var r=o(91);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};o(3)(r,a);r.locals&&(e.exports=r.locals)},91:function(e,t,o){(e.exports=o(2)(!1)).push([e.i,"#schemePage {\n  min-width: 1200px;\n  padding: 0 20px 20px 20px;\n}\n#schemePage .header {\n  background-color: #fff;\n  height: 64px;\n  padding: 17px 10px 10px 10px;\n  border-bottom: 2px solid #edecec;\n}\n#schemePage .header .header-title-search-area {\n  float: left;\n  color: #474d54;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n#schemePage .header .header-title-search-area h2.title-search-detail {\n  font-size: 16px;\n  font-family: PingFangHK-Medium;\n  height: 32px;\n  line-height: 32px;\n}\n#schemePage .header .header-title-search-area .title-search-detail {\n  margin-right: 20px;\n  font-family: PingFangSC-Regular;\n  font-size: 13px;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n#schemePage .header .headerBtn {\n  text-align: right;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n  padding-right: 10px;\n}\n#schemePage .header .headerBtn button {\n  margin: 5px;\n}\n#schemePage .leftBox {\n  width: 20%;\n  float: left;\n  height: 100%;\n  border-right: 1px solid #ddd;\n  overflow: scroll;\n}\n#schemePage .rightBox {\n  width: 80%;\n  float: left;\n  padding: 15px;\n}\n#schemePage .borderLine {\n  display: inline-block;\n  width: 90%;\n  height: 1px;\n  background-color: #ddd;\n}\n#schemePage .showHideBtn {\n  cursor: pointer;\n}\n#schemePage .showHideBtn:hover {\n  color: #0f87dd;\n}\n#schemePage .hideThisDom {\n  display: none;\n}\n#schemePage .formBox {\n  min-height: 310px;\n  border-bottom: 2px solid #ddd;\n}\n#schemePage .btnBox {\n  width: 100%;\n  text-align: right;\n  padding: 10px 0;\n}\n#schemePage .btnBox button {\n  margin-left: 10px;\n}\n#schemePage .lineBox {\n  padding-left: 15px;\n}\n.header-button-scheme .button-app-wrapper {\n  left: 79%;\n}\n",""])}})}));
//# sourceMappingURL=index.2b1ae5f0.js.map