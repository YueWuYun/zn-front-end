/*! @ncctag {"date":"2020-5-11 23:33:34"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uap/bcbd/matcoderuleorg/main/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uap/bcbd/matcoderuleorg/main/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,a){return function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=288)}({1:function(t,a){t.exports=e},148:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conf=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return React.createElement(n,o({},r,e))};var n=a(1).high.Refer,r=t.conf={multiLang:{domainName:"uap",currentLocale:"zh-CN",moduleId:"uapRefer"},queryTreeUrl:"/nccloud/riart/ref/groupRefTreeAction.do",refType:"tree",placeholder:"1880000025-000061",refName:"1880000025-000061",rootNode:{refname:"1880000025-000061",refpk:"root"}}},152:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conf=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return React.createElement(l,o({},i,e))};var n=a(1),r=a(148),l=n.high.Refer;r.conf.fieldid="group";var i=t.conf={multiLang:{domainName:"uapbd",currentLocale:"zh-CN",moduleId:"refer_uapbd"},refType:"tree",refName:"refer-000201",refCode:"uapbd.refer.org.BusinessUnitTreeRef",rootNode:{refname:"refer-000201",refpk:"root"},placeholder:"refer-000201",queryTreeUrl:"/nccloud/uapbd/org/BusinessUnitTreeRef.do",treeConfig:{name:["refer-000002","refer-000003"],code:["refcode","refname"]},isMultiSelectedEnabled:!1,unitProps:r.conf,isShowUnit:!1}},2:function(e,a){e.exports=t},223:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.headerButtonClick=t.beforeEvent=t.afterEvent=t.initTemplate=void 0;var o=i(a(224)),n=i(a(225)),r=i(a(226)),l=i(a(227));function i(e){return e&&e.__esModule?e:{default:e}}t.initTemplate=o.default,t.afterEvent=n.default,t.beforeEvent=l.default,t.headerButtonClick=r.default},224:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.createUIDom({pagecode:"1057060301",appcode:"1057MBCRDS"},(function(t){if(t){if(t.button){var a=t.button;e.button.setButtons(a)}if(t.template){var o=t.template;e.meta.setMeta(o)}}}))}},225:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o,n,r,l){"pk_matbasclass"==a&&o&&(o.refpk?(e.editTable.setValByKeyAndIndex(t,r,"pk_matbasclass",{value:o.refpk,display:o.refcode},!1),e.editTable.setValByKeyAndIndex(t,r,"pk_matbasclass.name",{value:o.refname,display:o.refname},!1)):(e.editTable.setValByKeyAndIndex(t,r,"pk_matbasclass",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,r,"pk_matbasclass.name",{value:"",display:""},!1)),e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid.name",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid.version",{value:"",display:""},!1));"cmaterialvid"==a&&o&&(e.editTable.setValByKeyAndIndex(t,r,"pk_matbasclass",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,r,"pk_matbasclass.name",{value:"",display:""},!1),o.refpk?(e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid",{value:o.refpk,display:o.refcode},!1),e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid.name",{value:o.refname,display:o.refname},!1)):(e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid.name",{value:"",display:""},!1)),o.values&&o.values.version?e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid.version",{value:o.values.version.value,display:o.values.version.value},!1):e.editTable.setValByKeyAndIndex(t,r,"cmaterialvid.version",{value:"",display:""},!1))};a(1)},226:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=this,l=void 0;switch(t){case"add":if(!a.state.foolValue||!a.state.foolValue.value)return void(0,o.toast)({color:"warning",content:a.state.json["dictcodeorg-000002"]});var i=e.editTable.getNumberOfRows("material");"browse"==a.pagestatus?(a.pagestatus="add",a.initButtonStatus(!1,a),a.props.editTable.addRow("material",i,!1,{pk_org:a.state.foolValue,pk_group:a.state.loginfo.pk_group,creationtime:a.state.loginfo.createTime,creator:a.state.loginfo.user})):a.props.editTable.addRow("material",i,!1,{pk_org:a.state.foolValue,pk_group:a.state.loginfo.pk_group,creationtime:a.state.loginfo.createTime,creator:a.state.loginfo.user});break;case"edit":a.pagestatus="edit",a.initButtonStatus(!1,a),a.props.editTable.setStatus("material","edit");break;case"del":if("browse"!=a.pagestatus){var s=a.props.editTable.getCheckedRows("material");if(!s||s.length<=0)return void(0,o.toast)({color:"warning",content:a.state.json["dictcodeorg-000003"]});var u=[];s.map((function(e){return u.push(e.index),u})),a.props.editTable.deleteTableRowsByIndex("material",u)}else{var d=a.props.editTable.getCheckedRows("material");if(!d||d.length<=0)return void(0,o.toast)({color:"warning",content:a.state.json["dictcodeorg-000004"]});e.ncmodal.show("ncmodal",{title:React.createElement("span",{className:"nc-theme-common-font-c"},a.state.json["dictcodeorg-000005"]),beSureBtnClick:function(){for(var e=[],t=[],n=0;n<d.length;n++){var r=d[n];e.push(r.index),t.push(r.data)}l={material:{rows:t}},(0,o.ajax)({url:"/nccloud/bcbd/meterial/del.do",data:l,success:function(t){t.success&&t.data&&(t.data.status?(a.props.editTable.deleteTableRowsByIndex("material",e),a.initButtonStatus(!0,a),(0,o.toast)({color:"success"})):(0,o.toast)({color:"danger",content:t.data.message}))}})}})}break;case"setDefault":l={material:{rows:[a.props.editTable.getCheckedRows("material")[0].data]}},n(a,{pk_org:a.state.foolValue.value,material:l},"/nccloud/bcbd/meterial/setdeFault.do",!0);break;case"save":if(!a.state.foolValue||!a.state.foolValue.value)return void(0,o.toast)({color:"warning",content:a.state.json["dictcodeorg-000002"]});if(!a.props.editTable.checkRequired("material",a.props.editTable.getAllRows("material")))return;a.props.editTable.filterEmptyRows("material",["isdefault"]);var c=a.props.editTable.getChangedRows("material");if(!c||c.length<=0)return a.initButtonStatus(!0,a),void(0,o.toast)({color:"success"});for(var p=[],f=[],b=[],m=0;m<c.length;m++){var v=c[m];"2"==v.status?p.push({values:v.values}):"3"==v.status?b.push({values:v.values}):"1"==v.status&&f.push({values:v.values})}var h={addrows:p&&p.length>0?{material:{rows:p}}:"",editrows:f&&f.length>0?{material:{rows:f}}:"",delrows:b&&b.length>0?{material:{rows:b}}:"",nodeType:"ORG_NODE",pk_org:a.state.foolValue.value};n(a,h,"/nccloud/bcbd/meterial/save.do",!0);break;case"cancel":e.ncmodal.show("ncmodal",{title:React.createElement("span",{className:"nc-theme-common-font-c"},this.state.json["dictcodeorg-000006"]),beSureBtnClick:function(){a.showMaterialData("ORG_NODE",a.state.foolValue.value),a.initButtonStatus(!0,a)}});break;case"printor":var y=r(a);if(!y||y.length<=0)return;(0,o.print)("pdf","/nccloud/bcbd/meterial/print.do",{funcode:"1057MBCRD",appcode:"1057MBCRD",nodekey:"metercoderule",oids:y});break;case"preview":var g=r(a);if(!g||g.length<=0)return;(0,o.print)("pdf","/nccloud/bcbd/meterial/print.do",{funcode:"1057MBCRD",appcode:"1057MBCRD",nodekey:"metercoderule",oids:g});break;case"exportor":var T=r(a);if(!T||T.length<=0)return;var k={funcode:"1057MBCRD",appcode:"1057MBCRD",nodekey:"metercoderule",oids:T,outputType:"output"};(0,o.output)({url:"/nccloud/bcbd/meterial/print.do",data:k,callback:function(){}});break;case"freshen":a.showMaterialData(a.state.nodeType,a.state.foolValue.value)}};var o=a(1);function n(e,t,a,n){(0,o.ajax)({url:a,data:t,success:function(t){t.success&&t.data&&(t.data.status?(n&&(e.showMaterialData("ORG_NODE",e.state.foolValue.value),e.initButtonStatus(!0,e)),(0,o.toast)({color:"success"})):(0,o.toast)({color:"danger",content:t.data.message}))}})}function r(e){var t=[],a=e.props.editTable.getAllRows("material");return!a||a.length<=0?((0,o.toast)({color:"danger",content:e.state.json["dictcodeorg-000009"]}),t):(a.map((function(e){return t.push(e.values.pk_matruledist.value),t})),t)}},227:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o,n,r){var l=this,i=!0;if("pk_matbasclass"==a.attrcode)return!r.values.cmaterialvid.value||(l.props.ncmodal.show("ncmodal",{title:React.createElement("span",{className:"nc-theme-common-font-c"},l.state.json["dictcodeorg-000000"]),beSureBtnClick:function(){e.editTable.setValByKeyAndIndex(t,o,"cmaterialvid",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,o,"cmaterialvid.name",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,o,"cmaterialvid.version",{value:"",display:""},!1),i=!0},cancelBtnClick:function(){i=!1}}),i);if("cmaterialvid"==a.attrcode)return!r.values.pk_matbasclass.value||(l.props.ncmodal.show("ncmodal",{title:React.createElement("span",{className:"nc-theme-common-font-c"},l.state.json["dictcodeorg-000001"]),beSureBtnClick:function(){e.editTable.setValByKeyAndIndex(t,o,"pk_matbasclass",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,o,"pk_matbasclass.name",{value:"",display:""},!1),i=!0},cancelBtnClick:function(){i=!1}}),i);if("matbarcoderule_v"==a.attrcode){l.props.renderItem("table",t,"matbarcoderule_v",null);var s=l.props.meta.getMeta();s[t].items.find((function(e){return"matbarcoderule_v"==e.attrcode})).queryCondition=function(){return{pk_org:l.state.foolValue.value,GridRefActionExt:"nccloud.web.bcbd.code.sqlbuilder.CodeRuleMatSqlBuilder"}},l.props.meta.setMeta(s)}return!0};a(1)},288:function(e,t,a){"use strict";var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),n=a(2),r=d(n),l=d(a(3)),i=a(1),s=a(223),u=d(a(152));function d(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={nodeType:"ORG_NODE",foolValue:{},json:{},loginfo:{}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"componentWillMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"1057-1057mbcrds",domainName:"uap",callback:function(t,a,o){a?e.setState({json:t,inlt:o}):console.log("未加载到多语资源")}})}},{key:"componentDidMount",value:function(){this.showMaterialData("ORG_NODE"),this.initButtonStatus(!0,this),this.getLoginfo(),this.pagestatus="browse"}},{key:"componentDidUpdate",value:function(){var e=this.props.editTable.getStatus("material");window.onbeforeunload=e&&"browse"!=e?function(){return""}:null}},{key:"getLoginfo",value:function(){var e=this;(0,i.ajax)({url:"/nccloud/bcbd/login/loginfo.do",loading:!1,success:function(t){e.setState({loginfo:t.data})}})}},{key:"initButtonStatus",value:function(e,t){e&&(t.pagestatus="browse",t.props.editTable.setStatus("material","browse"),t.props.button.setButtonDisabled({setDefault:!0})),t.props.button.setButtonVisible(["edit","setDefault","print","freshen"],e),t.props.button.setButtonVisible(["save","cancel"],!e)}},{key:"showMaterialData",value:function(e,t){var a=this;t?(0,i.ajax)({url:"/nccloud/bcbd/meterial/queryAll.do",data:{nodeType:e,pk_org:t,pageid:"1057060301"},success:function(e){e&&e.success&&e.data&&e.data.material?a.props.editTable.setTableData("material",e.data.material):a.props.editTable.setTableData("material",{rows:[]})}}):a.props.editTable.setTableData("material",{rows:[]})}},{key:"onSelected",value:function(e,t,a,o,n){if("browse"==this.pagestatus){var r=this.props.editTable.getCheckedRows(t);!r||r.length<=0?this.props.button.setButtonDisabled({setDefault:!0}):1==r.length?n?this.props.button.setButtonDisabled({setDefault:a.values.isdefault.value}):this.onSelected(e,t,r[0].data,r[0].index,!0):this.props.button.setButtonDisabled({setDefault:!0})}}},{key:"onSelectedAll",value:function(e,t,a,o){if("browse"==this.pagestatus)if(a){if(o>1)this.props.button.setButtonDisabled({setDefault:!0});else if(1==o){var n=this.props.editTable.getCheckedRows(t);this.onSelected(e,t,n[0].data,n[0].index,a)}}else this.props.button.setButtonDisabled({setDefault:!0})}},{key:"changeOrg",value:function(e,t){this.setState({foolValue:t}),"browse"==this.pagestatus&&this.showMaterialData("ORG_NODE",t.value)}},{key:"render",value:function(){var e=this.props.BillHeadInfo.createBillHeadInfo,t=i.base.NCDiv;return r.default.createElement("div",{className:"nc-single-table"},this.props.ncmodal.createModal("ncmodal"),r.default.createElement(t,{areaCode:t.config.HEADER},r.default.createElement("div",{className:"nc-singleTable-header-area"},r.default.createElement("div",{className:"header-title-search-area"},r.default.createElement("span",null,e({title:""+this.state.json["dictcodeorg-000007"],initShowBackBtn:!1})),r.default.createElement("div",null,r.default.createElement(u.default,{fieldid:"mbcrds_org",foolValue:this.state.foolValue,onChange:this.changeOrg.bind(this),placeholder:this.state.json["dictcodeorg-000008"],queryCondition:{TreeRefActionExt:"nccloud.web.rbac.authres.sqlbuilder.AuthResOrgPermSqlBuilder"}}))),r.default.createElement("div",{className:"header-button-area"},this.props.button.createButtonApp({area:"page_header",onButtonClick:s.headerButtonClick.bind(this),popContainer:document.querySelector(".header-button-area")})))),r.default.createElement("div",{className:"nc-singleTable-table-area"},this.props.editTable.createEditTable("material",{showIndex:!0,showCheck:!0,adaptionHeight:!0,onAfterEvent:s.afterEvent.bind(this),onBeforeEvent:s.beforeEvent.bind(this),onSelected:this.onSelected.bind(this),onSelectedAll:this.onSelectedAll.bind(this)})))}}]),t}(n.Component);c=(0,i.createPage)({initTemplate:s.initTemplate})(c),l.default.render(r.default.createElement(c,null),document.querySelector("#app"))},3:function(e,t){e.exports=a}})}));
//# sourceMappingURL=index.cc7762fc.js.map