/*! @ncctag {"date":"2020-5-11 23:33:34"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front")):"function"==typeof define&&define.amd?define(["nc-lightapp-front"],t):"object"==typeof exports?exports["uap/bcbd/matcoderuleorg/events/index"]=t(require("nc-lightapp-front")):e["uap/bcbd/matcoderuleorg/events/index"]=t(e["nc-lightapp-front"])}(window,(function(e){return function(e){var t={};function a(o){if(t[o])return t[o].exports;var l=t[o]={i:o,l:!1,exports:{}};return e[o].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(o,l,function(t){return e[t]}.bind(null,l));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=223)}({1:function(t,a){t.exports=e},223:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.headerButtonClick=t.beforeEvent=t.afterEvent=t.initTemplate=void 0;var o=s(a(224)),l=s(a(225)),n=s(a(226)),r=s(a(227));function s(e){return e&&e.__esModule?e:{default:e}}t.initTemplate=o.default,t.afterEvent=l.default,t.beforeEvent=r.default,t.headerButtonClick=n.default},224:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.createUIDom({pagecode:"1057060301",appcode:"1057MBCRDS"},(function(t){if(t){if(t.button){var a=t.button;e.button.setButtons(a)}if(t.template){var o=t.template;e.meta.setMeta(o)}}}))}},225:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o,l,n,r){"pk_matbasclass"==a&&o&&(o.refpk?(e.editTable.setValByKeyAndIndex(t,n,"pk_matbasclass",{value:o.refpk,display:o.refcode},!1),e.editTable.setValByKeyAndIndex(t,n,"pk_matbasclass.name",{value:o.refname,display:o.refname},!1)):(e.editTable.setValByKeyAndIndex(t,n,"pk_matbasclass",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,n,"pk_matbasclass.name",{value:"",display:""},!1)),e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid.name",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid.version",{value:"",display:""},!1));"cmaterialvid"==a&&o&&(e.editTable.setValByKeyAndIndex(t,n,"pk_matbasclass",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,n,"pk_matbasclass.name",{value:"",display:""},!1),o.refpk?(e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid",{value:o.refpk,display:o.refcode},!1),e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid.name",{value:o.refname,display:o.refname},!1)):(e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid.name",{value:"",display:""},!1)),o.values&&o.values.version?e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid.version",{value:o.values.version.value,display:o.values.version.value},!1):e.editTable.setValByKeyAndIndex(t,n,"cmaterialvid.version",{value:"",display:""},!1))};a(1)},226:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=this,r=void 0;switch(t){case"add":if(!a.state.foolValue||!a.state.foolValue.value)return void(0,o.toast)({color:"warning",content:a.state.json["dictcodeorg-000002"]});var s=e.editTable.getNumberOfRows("material");"browse"==a.pagestatus?(a.pagestatus="add",a.initButtonStatus(!1,a),a.props.editTable.addRow("material",s,!1,{pk_org:a.state.foolValue,pk_group:a.state.loginfo.pk_group,creationtime:a.state.loginfo.createTime,creator:a.state.loginfo.user})):a.props.editTable.addRow("material",s,!1,{pk_org:a.state.foolValue,pk_group:a.state.loginfo.pk_group,creationtime:a.state.loginfo.createTime,creator:a.state.loginfo.user});break;case"edit":a.pagestatus="edit",a.initButtonStatus(!1,a),a.props.editTable.setStatus("material","edit");break;case"del":if("browse"!=a.pagestatus){var i=a.props.editTable.getCheckedRows("material");if(!i||i.length<=0)return void(0,o.toast)({color:"warning",content:a.state.json["dictcodeorg-000003"]});var d=[];i.map((function(e){return d.push(e.index),d})),a.props.editTable.deleteTableRowsByIndex("material",d)}else{var u=a.props.editTable.getCheckedRows("material");if(!u||u.length<=0)return void(0,o.toast)({color:"warning",content:a.state.json["dictcodeorg-000004"]});e.ncmodal.show("ncmodal",{title:React.createElement("span",{className:"nc-theme-common-font-c"},a.state.json["dictcodeorg-000005"]),beSureBtnClick:function(){for(var e=[],t=[],l=0;l<u.length;l++){var n=u[l];e.push(n.index),t.push(n.data)}r={material:{rows:t}},(0,o.ajax)({url:"/nccloud/bcbd/meterial/del.do",data:r,success:function(t){t.success&&t.data&&(t.data.status?(a.props.editTable.deleteTableRowsByIndex("material",e),a.initButtonStatus(!0,a),(0,o.toast)({color:"success"})):(0,o.toast)({color:"danger",content:t.data.message}))}})}})}break;case"setDefault":r={material:{rows:[a.props.editTable.getCheckedRows("material")[0].data]}},l(a,{pk_org:a.state.foolValue.value,material:r},"/nccloud/bcbd/meterial/setdeFault.do",!0);break;case"save":if(!a.state.foolValue||!a.state.foolValue.value)return void(0,o.toast)({color:"warning",content:a.state.json["dictcodeorg-000002"]});if(!a.props.editTable.checkRequired("material",a.props.editTable.getAllRows("material")))return;a.props.editTable.filterEmptyRows("material",["isdefault"]);var c=a.props.editTable.getChangedRows("material");if(!c||c.length<=0)return a.initButtonStatus(!0,a),void(0,o.toast)({color:"success"});for(var p=[],f=[],m=[],v=0;v<c.length;v++){var b=c[v];"2"==b.status?p.push({values:b.values}):"3"==b.status?m.push({values:b.values}):"1"==b.status&&f.push({values:b.values})}var y={addrows:p&&p.length>0?{material:{rows:p}}:"",editrows:f&&f.length>0?{material:{rows:f}}:"",delrows:m&&m.length>0?{material:{rows:m}}:"",nodeType:"ORG_NODE",pk_org:a.state.foolValue.value};l(a,y,"/nccloud/bcbd/meterial/save.do",!0);break;case"cancel":e.ncmodal.show("ncmodal",{title:React.createElement("span",{className:"nc-theme-common-font-c"},this.state.json["dictcodeorg-000006"]),beSureBtnClick:function(){a.showMaterialData("ORG_NODE",a.state.foolValue.value),a.initButtonStatus(!0,a)}});break;case"printor":var g=n(a);if(!g||g.length<=0)return;(0,o.print)("pdf","/nccloud/bcbd/meterial/print.do",{funcode:"1057MBCRD",appcode:"1057MBCRD",nodekey:"metercoderule",oids:g});break;case"preview":var k=n(a);if(!k||k.length<=0)return;(0,o.print)("pdf","/nccloud/bcbd/meterial/print.do",{funcode:"1057MBCRD",appcode:"1057MBCRD",nodekey:"metercoderule",oids:k});break;case"exportor":var h=n(a);if(!h||h.length<=0)return;var B={funcode:"1057MBCRD",appcode:"1057MBCRD",nodekey:"metercoderule",oids:h,outputType:"output"};(0,o.output)({url:"/nccloud/bcbd/meterial/print.do",data:B,callback:function(){}});break;case"freshen":a.showMaterialData(a.state.nodeType,a.state.foolValue.value)}};var o=a(1);function l(e,t,a,l){(0,o.ajax)({url:a,data:t,success:function(t){t.success&&t.data&&(t.data.status?(l&&(e.showMaterialData("ORG_NODE",e.state.foolValue.value),e.initButtonStatus(!0,e)),(0,o.toast)({color:"success"})):(0,o.toast)({color:"danger",content:t.data.message}))}})}function n(e){var t=[],a=e.props.editTable.getAllRows("material");return!a||a.length<=0?((0,o.toast)({color:"danger",content:e.state.json["dictcodeorg-000009"]}),t):(a.map((function(e){return t.push(e.values.pk_matruledist.value),t})),t)}},227:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o,l,n){var r=this,s=!0;if("pk_matbasclass"==a.attrcode)return!n.values.cmaterialvid.value||(r.props.ncmodal.show("ncmodal",{title:React.createElement("span",{className:"nc-theme-common-font-c"},r.state.json["dictcodeorg-000000"]),beSureBtnClick:function(){e.editTable.setValByKeyAndIndex(t,o,"cmaterialvid",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,o,"cmaterialvid.name",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,o,"cmaterialvid.version",{value:"",display:""},!1),s=!0},cancelBtnClick:function(){s=!1}}),s);if("cmaterialvid"==a.attrcode)return!n.values.pk_matbasclass.value||(r.props.ncmodal.show("ncmodal",{title:React.createElement("span",{className:"nc-theme-common-font-c"},r.state.json["dictcodeorg-000001"]),beSureBtnClick:function(){e.editTable.setValByKeyAndIndex(t,o,"pk_matbasclass",{value:"",display:""},!1),e.editTable.setValByKeyAndIndex(t,o,"pk_matbasclass.name",{value:"",display:""},!1),s=!0},cancelBtnClick:function(){s=!1}}),s);if("matbarcoderule_v"==a.attrcode){r.props.renderItem("table",t,"matbarcoderule_v",null);var i=r.props.meta.getMeta();i[t].items.find((function(e){return"matbarcoderule_v"==e.attrcode})).queryCondition=function(){return{pk_org:r.state.foolValue.value,GridRefActionExt:"nccloud.web.bcbd.code.sqlbuilder.CodeRuleMatSqlBuilder"}},r.props.meta.setMeta(i)}return!0};a(1)}})}));
//# sourceMappingURL=index.cc7762fc.js.map