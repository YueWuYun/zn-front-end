/*! @ncctag {"date":"2020-5-19 0:19:19"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uap/common/components/printOnClient/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uap/common/components/printOnClient/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,n){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="../../../../",n(n.s=259)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},10:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},12:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gerRequestVO=t.isWindowSystem=t.findCurrPrinterNameObjById=t.initTempalteIdInfo=t.initFormVal=t.modifyMeta=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=n(0),o=r.viewModel.getGlobalStorage;function a(e){return!Object.keys(e).length}function l(e){return!e||!Object.keys(e).length}var s=function(e){var t=[];return e.nccloudPrinterList.length?(e.nccloudPrinterList.forEach((function(e){t.push(i({},e,{display:e.printerName,value:e.printerId}))})),t):t},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return"Array"!==Object.prototype.toString.call(e).slice(8,-1)||!e.length};function d(e,t){var n=this.state.responseAllData.currentNCCloudPrinter,i=void 0===n?{}:n;if(!t&&a(i)||!t&&!i.printerName)return e[0];if(!t&&!a(i))return function(e,t){var n={};return p(e)?n:n=e.find((function(e){return e.printerName==t.printerName}))}(e,i);if(t){var r=e.find((function(e){return t===e.printerId}));return!r||a(r)?e[0]:r}}function c(e,t){return d.call(this,e,t)}function u(e,t){var n=[];return e.nccloudPaperResourceList&&e.nccloudPaperResourceList.length?(e.nccloudPaperResourceList.forEach((function(e){!n.some((function(t){return t.display==e.paperSourceName}))&&n.push({display:e.paperSourceName,value:e.paperSourceId})})),n):n}function f(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=[];return e.paperList&&e.paperList.length?(e.paperList.forEach((function(e){t.push(i({},e,{display:e.paperName,value:e.paperId}))})),t):t}function m(e){var t=this.state.responseAllData,n=(void 0===t?{}:t).currentNccloudPaper,i=void 0===n?{}:n,r={};return a(i)?e.paperList[0]:(r=e.paperList.find((function(e){return e.paperName.trim()==i.paperName.trim()})))?r:(r=e.paperList.find((function(e){return e.paperName.trim().includes("自定义纸张")||e.paperId.trim().includes("defined")})),r=Object.assign({},r,i))}var g=function(e){var t=[];return p(e.nccloudTemplateInfoList)?t:(e.nccloudTemplateInfoList.forEach((function(e){t.push({display:e.templateName,value:e.templateId})})),t)};function h(){var e={},t=this.props.form.getAllFormValue("printRange").rows[0].values;for(var n in t)e[n]=t[n].value;return e.doubleside=0!=e.doubleside,e.isDuplex=1!=e.doubleside,e}function v(){var e={},t=this.props.form.getAllFormValue("printMachine").rows[0].values;for(var n in t)e[n]=t[n].value;return e}function y(){var e={},t=this.props.form.getAllFormValue("printStyle").rows[0].values;for(var n in t)e[n]=t[n].value;return e}t.modifyMeta=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.state.responseAllData,n=this.props.meta.getMeta(),i=s.call(this,t);if(this.printerVO=c.call(this,t.nccloudPrinterList,e),i){var r=u.call(this,this.printerVO,e),o=f.call(this,this.printerVO,e),a=g.call(this,t);n.printTemplate.items.map((function(e){"templateInfoList"===e.attrcode&&(e.options=a)})),n.printMachine.items.map((function(e){"PrinterList"===e.attrcode&&(e.options=i),"paperResourceList"===e.attrcode&&(e.options=r)})),n.printStyle.items.map((function(e){"paperList"===e.attrcode&&(e.options=o)})),this.props.meta.setMeta(n)}else toast({content:this.state.json.index_067})},t.initFormVal=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2];var t=this.state.configParams,n={};if(console.log({ais:JSON.parse(o("localStorage",t.asid))}),this.state.asid&&o("localStorage",t.asid)){var i=JSON.parse(o("localStorage",t.asid)).toEndInfo;n=JSON.parse(i.ncclouPrintSetting)}var r=this.state.json.index_027,a=0;!l(n)&&n.doubleside&&(n.isDuplex?n.isDuplex&&(r=this.state.json.index_029,a=2):(r=this.state.json.index_028,a=1));var s={rows:[{values:{pageRangeType:{display:l(n)?this.state.json.index_000:n.pageRangeType.display,value:l(n)?0:n.pageRangeType},pageFrom:{value:l(n)?1:n.pageFrom},pageTo:{value:l(n)?1:n.pageTo},pageWholeType:{display:l(n)||0==n.pageWholeType?this.state.json.index_020:1==n.pageWholeType?this.state.json.index_021:this.state.json.index_022,value:l(n)?0:n.pageWholeType},copies:{value:l(n)?1:n.copies||1},collated:{value:!l(n)&&n.collated},doubleside:{display:r,value:a}}}]};!l(n)&&n.doubleside.value&&this.props.form.setFormItemsDisabled("printRange",{isDuplex:!1}),l(n)||1!=n.pageRangeType.value||this.props.form.setFormItemsVisible("printRange",{pageFrom:!0,pageTo:!0});var p={rows:[{values:{PrinterList:{display:this.printerVO.printerName,value:this.printerVO.printerId},printerStatus:{display:this.printerVO.printerStatus?this.state.json.index_062:this.state.json.index_063,value:this.printerVO.printerStatus},twoSide:{display:this.printerVO.twoSide?this.state.json.index_064:this.state.json.index_065,value:this.printerVO.twoSide},paperResourceList:{display:this.printerVO.nccloudPaperResourceList.length?this.printerVO.nccloudPaperResourceList[0].paperSourceName:"",value:this.printerVO.nccloudPaperResourceList.length?this.printerVO.nccloudPaperResourceList[0].paperSourceId:""}}}]},d=m.call(this,this.printerVO),c=d.paperWidth,u=d.paperHeight;e.paperCheck&&(c=e.nccloudPaperDirect?d.paperHeight:d.paperWidth,u=e.nccloudPaperDirect?d.paperWidth:d.paperHeight,(d.paperName.trim().includes("自定义纸张")||d.paperId.trim().includes("defined"))&&(e.nccloudPaperDirect?(c=d.paperWidth<d.paperHeight?d.paperWidth:d.paperHeight,u=d.paperWidth<d.paperHeight?d.paperHeight:d.paperWidth):(c=d.paperWidth>d.paperHeight?d.paperWidth:d.paperHeight,u=d.paperWidth>d.paperHeight?d.paperHeight:d.paperWidth)));var f={rows:[{values:{paperList:{display:d.paperName,value:d.paperId},paperWidth:{value:c},paperHeight:{value:u},nccloudPaperDirect:{display:e.nccloudPaperDirect?this.state.json.index_039:this.state.json.index_038,value:e.nccloudPaperDirect||!1},isMultiColor:{value:!1}}}]};this.props.form.setFormItemsDisabled("printStyle",{paperWidth:this.state.json.index_015!==d.paperName,paperHeight:this.state.json.index_015!==d.paperName}),this.props.form.setAllFormValue({printRange:s}),this.props.form.setAllFormValue({printMachine:p}),this.props.form.setAllFormValue({printStyle:f})},t.initTempalteIdInfo=function(e){var t=this.state.configParams.printTemplateID,n={};if(p(e.nccloudTemplateInfoList))return{display:"",value:""};n=e.nccloudTemplateInfoList[0],t?(n=e.nccloudTemplateInfoList.find((function(e){return e.templateId==t})))&&!p(e.nccloudTemplateInfoList)||(n=e.nccloudTemplateInfoList[0]):e.currentNCCloudTemplateInfo&&Object.keys(e.currentNCCloudTemplateInfo).length&&(n=e.currentNCCloudTemplateInfo),this.props.form.setFormItemsValue("printTemplate",{templateInfoList:{display:n.templateName,value:n.templateId}})},t.findCurrPrinterNameObjById=d,t.isWindowSystem=function(){return navigator.userAgent.toLowerCase().includes("windows")},t.gerRequestVO=function(){console.log(this.props.params);var e=(0,r.deepClone)(this.props.params),t=this.state.nopreview;e.formulaConfig&&delete e.formulaConfig;var n,i,o={},a={},l={},s=y.call(this),p=v.call(this),d=h.call(this);for(var c in p)l[c]=p[c];var u=this.props.form.getFormItemsValue("printMachine","PrinterList");for(var f in l.printerId=u.value,l.printerName=u.display,l.PrinterList&&delete l.PrinterList,s)a[f]=s[f];var m=this.props.form.getFormItemsValue("printStyle","paperList");for(var g in a.paperList&&delete a.paperList,a.paperName=m.display,a.paperId=m.value,o.nccloudPaperDirect=a.nccloudPaperDirect,d)o[g]=d[g];o.doubleside=0!=o.doubleside,o.isDuplex=1!=o.doubleside,o.isMultiColor=a.isMultiColor,delete a.isMultiColor;var b=this.props.form.getFormItemsValue("printMachine","paperResourceList");n={paperSourceId:b.value||"",paperSourceName:b.display||""};var x=this.props.form.getFormItemsValue("printTemplate","templateInfoList");return i={templateId:x.value||"",templateName:x.display||""},o=Object.assign({},o,{currentNccloudPaper:a,currentNCCloudPaperResource:n,currentNCCloudPrinter:l,currentNCCloudTemplateInfo:i,nopreview:t}),console.log({requestVO:Object.assign({},e,{ncclouPrintSetting:o})}),Object.assign({},e,{printTemplateID:i.templateId||null,ncclouPrintSetting:JSON.stringify(o),printSetting:JSON.stringify(o),nopreview:t})}},15:function(e,t,n){(function(e){!function(n,i){"use strict";var r={};n.PubSub=r;var o=n.define;!function(e){var t={},n=-1;function i(e){var t;for(t in e)if(e.hasOwnProperty(t))return!0;return!1}function r(e,t,n){try{e(t,n)}catch(e){setTimeout(function(e){return function(){throw e}}(e),0)}}function o(e,t,n){e(t,n)}function a(e,n,i,a){var l,s=t[n],p=a?o:r;if(t.hasOwnProperty(n))for(l in s)s.hasOwnProperty(l)&&p(s[l],e,i)}function l(e,n,r,o){var l=function(e,t,n){return function(){var i=String(e),r=i.lastIndexOf(".");for(a(e,e,t,n);-1!==r;)r=(i=i.substr(0,r)).lastIndexOf("."),a(e,i,t,n)}}(e="symbol"==typeof e?e.toString():e,n,o);return!!function(e){for(var n=String(e),r=Boolean(t.hasOwnProperty(n)&&i(t[n])),o=n.lastIndexOf(".");!r&&-1!==o;)o=(n=n.substr(0,o)).lastIndexOf("."),r=Boolean(t.hasOwnProperty(n)&&i(t[n]));return r}(e)&&(!0===r?l():setTimeout(l,0),!0)}e.publish=function(t,n){return l(t,n,!1,e.immediateExceptions)},e.publishSync=function(t,n){return l(t,n,!0,e.immediateExceptions)},e.subscribe=function(e,i){if("function"!=typeof i)return!1;e="symbol"==typeof e?e.toString():e,t.hasOwnProperty(e)||(t[e]={});var r="uid_"+String(++n);return t[e][r]=i,r},e.subscribeOnce=function(t,n){var i=e.subscribe(t,(function(){e.unsubscribe(i),n.apply(this,arguments)}));return e},e.clearAllSubscriptions=function(){t={}},e.clearSubscriptions=function(e){var n;for(n in t)t.hasOwnProperty(n)&&0===n.indexOf(e)&&delete t[n]},e.unsubscribe=function(n){var i,r,o,a="string"==typeof n&&(t.hasOwnProperty(n)||function(e){var n;for(n in t)if(t.hasOwnProperty(n)&&0===n.indexOf(e))return!0;return!1}(n)),l=!a&&"string"==typeof n,s="function"==typeof n,p=!1;if(!a){for(i in t)if(t.hasOwnProperty(i)){if(r=t[i],l&&r[n]){delete r[n],p=n;break}if(s)for(o in r)r.hasOwnProperty(o)&&r[o]===n&&(delete r[o],p=!0)}return p}e.clearSubscriptions(n)}}(r),"function"==typeof o&&o.amd?o((function(){return r})):(void 0!==e&&e.exports&&(t=e.exports=r),t.PubSub=r,e.exports=t=r)}("object"==typeof window&&window||this)}).call(this,n(10)(e))},2:function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var r=(a=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),o=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[n].concat(o).concat([r]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n})).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(260)),r=l(n(261)),o=l(n(270)),a=l(n(15));function l(e){return e&&e.__esModule?e:{default:e}}var s={printOnClient:i.default,printPreview:r.default,printerView:o.default,PubSub:a.default};t.default=s},260:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.default=function(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=function(l,s,d){if((0,o.isWindowSystem)()){(0,r.getMultiLang)({moduleId:"contains_printOnClient",callback:function(i,r,o){r?p(e,t,n,a,i):console.log("未加载到多语资源")}})}else(0,r.print)("pdf",t,i({},n,{sysType:(0,o.isWindowSystem)()?"1":"2"}),a)};l()};a(n(1)),a(n(4));var r=n(0),o=n(12);function a(e){return e&&e.__esModule?e:{default:e}}var l=r.Cipher.opaqueDecrypt,s=r.viewModel.getGlobalStorage,p=function(e,t,n,o,a){(0,r.ajax)({url:"/nccloud/riart/printtool/sessionid.do",data:{printTemplateID:n.printTemplateID,nodekey:n.nodekey,appcode:n.appcode,num:3==n.type?n.oids.length.toString():"1"},success:function(l){var p=l.success,c=l.data;if(p)if(c.authority){var f=null;console.log("asid",s("localStorage",c.asid)),c.asid&&s("localStorage",c.asid)&&(f=JSON.parse(s("localStorage",c.asid)).toEndInfo);var m=i({},n,{nccloudsessionid:c.sessionid,ncclouPrintSetting:f,asid:c.asid});f&&f.printTemplateID?u(e,t,i({},m,{printTemplateID:f.printTemplateID}),a):o?d(e,t,m,a):u(e,t,m,a)}else(0,r.toast)({color:"warning",content:a.index_051});else(0,r.toast)({color:"error",content:a.index_047})},error:function(e){console.error(e.message)}})},d=function(e,t,n,o){var a=null;(0,r.ajax)({method:"post",url:"/nccloud/platform/print/queryTemplates.do",data:n,success:function(l){var s=l.success,p=l.data;if(s){if(!p||!p.length)return(0,r.toast)({color:"warning",content:"未查询到任何模板信息"});a=p[0].m_ctemplateid?p[0].m_ctemplateid:null,u(e,t,i({},n,{printTemplateID:a}),o)}},error:function(e){(0,r.toast)({color:"danger",content:e.message})}})},c=null,u=function(e,t,n,i){var o=null,a=n.beginUrl||window.location.protocol+"//"+window.location.hostname+":"+window.location.port,p=l(s("localStorage","cowboy")),d=s("localStorage","rockin")||!1;if(null!=o&&1==o.readyState)(0,r.toast)({color:"warning",content:i.index_043});else if("WebSocket"in window){o=null;var u=new WebSocket("ws://"+(n.socketIp||"127.0.0.1")+":9999/websocket");u.onopen=function(e){console.log("连接成功"),c=window.open("");var t="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;"">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110518_e60c0d16_919028.png"/></p>\n              <span>...</span>\n            </div>\n          </div>\n        </div>    \n        ';c.document.body.innerHTML=t},u.onclose=function(e){console.log("关闭连接")},u.onerror=function(i){e.openTo("/uap/printExeDown/ExeDownload/main/index.html?pk_message=dd",{appcode:n.appcode,pagecode:n.pagecode,actionUrl:t})},u.onmessage=function(e){var t="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 102px;"">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110533_f85d3142_919028.png"/></p>\n              <span>'+i.index_061+"</span>\n            </div>\n          </div>\n        </div>    \n        ",n="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 96px;"">\n              <p><img style="width: 30px; height: 30px;" src="https://images.gitee.com/uploads/images/2019/0314/110526_3b417874_919028.png"/></p>\n              <span>'+i.index_060+"</span>\n            </div>\n          </div>\n        </div>    \n        ";e&&(Object.keys(e).length||e.data)&&(u.close(),c.document.body.innerHTML=e.data.includes(i.index_056)?t:n)};var f={},m=setInterval((function(){if(u.readyState==WebSocket.OPEN){if(clearInterval(m),f=Object.assign({},n,{compalteAddress:t,type:n.type,nccloudsessionid:n.nccloudsessionid,download:n.download||null,suffx:n.suffx||null,beginUrl:a,aeskey:p,rockin:d}),s("localStorage",f.asid)){var e=JSON.parse(s("localStorage",f.asid)).toEndInfo;f.ncclouPrintSetting=e?e.ncclouPrintSetting:null}var i=JSON.stringify(f);u.send(i)}}),1e3)}else(0,r.toast)({color:"warning",content:i.index_057+"websocket"})}},261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.default=function(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if((0,a.isWindowSystem)()){var l=function(i,r){r?d(e,t,n,o,i):console.log("未加载到多语资源")};(0,r.getMultiLang)({moduleId:"contains_printOnClient",callback:l})}else(0,r.print)("pdf",t,i({},n,{sysType:(0,a.isWindowSystem)()?"1":"2"}),o)};l(n(1)),l(n(4));var r=n(0),o=l(n(63)),a=n(12);function l(e){return e&&e.__esModule?e:{default:e}}var s=r.Cipher.opaqueDecrypt,p=r.viewModel.getGlobalStorage,d=function(e,t,n,o,a){(0,r.ajax)({url:"/nccloud/riart/printtool/sessionid.do",data:{printTemplateID:n.printTemplateID,nodekey:n.nodekey,appcode:n.appcode,num:"1"},success:function(l){var s=l.success,d=l.data;if(s){var u=null;d.asid&&p("localStorage",d.asid)&&(u=JSON.parse(p("localStorage",d.asid)).toEndInfo);var f=i({},n,{nccloudsessionid:d.sessionid,ncclouPrintSetting:u,asid:d.asid,isPrinterView:!1,searchTemplate:o,authority:d.authority,hidePreviewCheck:!0});c(e,t,f,o,a)}else(0,r.toast)({color:"error",content:a.index_047})},error:function(e){console.error(e.message)}})},c=function(e,t,n,a,l){(0,o.default)(e,t,n,a,(function(o){n.authority?f(e,t,i({},o,{type:n.virType?n.virType:"1"}),l):(0,r.toast)({color:"warning",content:l.index_051})}))},u=null,f=function(e,t,n,i){var o=null,a=n.beginUrl||window.location.protocol+"//"+window.location.hostname+":"+window.location.port,l=s(p("localStorage","cowboy")),d=p("localStorage","rockin")||!1;if(null!=o&&1==o.readyState)(0,r.toast)({color:"warning",content:i.index_043});else if("WebSocket"in window){o=null;var c=new WebSocket("ws://"+(n.socketIp||"127.0.0.1")+":9999/websocket");c.onopen=function(e){console.log("连接成功"),(u=window.open("")).document.title=i.index_049;var t="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;"">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110518_e60c0d16_919028.png"/></p>\n              <span>...</span>\n            </div>\n          </div>\n        </div>    \n        ';u.document.body.innerHTML=t},c.onclose=function(e){console.log("关闭连接")},c.onerror=function(i){e.openTo("/uap/printExeDown/ExeDownload/main/index.html?pk_message=dd",{appcode:n.appcode,pagecode:n.pagecode,actionUrl:t})},c.onmessage=function(e){var t="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 102px;"">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110533_f85d3142_919028.png"/></p>\n              <span>'+i.index_061+"</span>\n            </div>\n          </div>\n        </div>    \n        ",n="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 96px;"">\n              <p><img style="width: 30px; height: 30px;" src="https://images.gitee.com/uploads/images/2019/0314/110526_3b417874_919028.png"/></p>\n              <span>'+i.index_060+"</span>\n            </div>\n          </div>\n        </div>    \n        ";e&&(Object.keys(e).length||e.data)&&(c.close(),u.document.body.innerHTML=e.data.includes(i.index_056)?t:n)};var f={},m=setInterval((function(){if(c.readyState==WebSocket.OPEN){clearInterval(m),f=Object.assign({},n,{compalteAddress:t,type:n.type,nccloudsessionid:n.nccloudsessionid,download:null,beginUrl:a,aeskey:l,rockin:d});var e=JSON.stringify(f);c.send(e)}}),1e3)}else(0,r.toast)({color:"warning",content:i.index_057+"websocket"})}},262:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(1),a=y(o),l=y(n(4)),s=n(0),p=y(n(263)),d=y(n(264)),c=y(n(265)),u=y(n(64)),f=n(12),m=y(n(65)),g=y(n(266)),h=y(n(267)),v=y(n(15));function y(e){return e&&e.__esModule?e:{default:e}}function b(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,n){return function i(r,o){try{var a=t[r](o),l=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(l).then((function(e){i("next",e)}),(function(e){i("throw",e)}));e(l)}("next")}))}}var x=s.viewModel.getCookie,w=s.viewModel.setGlobalStorage,_=s.viewModel.getGlobalStorage,S=(s.viewModel.removeGlobalStorage,new(0,s.gzip)),P=s.Cipher.opaqueDecrypt,I=s.base.NCButton,O=(s.base.NCInput,s.base.NCRow),T=s.base.NCCol,C=s.base.NCIcon,j=s.base.NCCheckbox,k=s.base.NCLoading;n(268);var N=function(e){function t(e){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r,o,a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.saveFrontCache=function(){var e=f.gerRequestVO.call(a),t=i({},e),n={toEndInfo:t};return w("localStorage",a.state.asid,JSON.stringify(n)),t},a.save=function(){a.cancel();var e=a.saveFrontCache();a.props.onEnsureInfoSave&&"function"==typeof a.props.onEnsureInfoSave&&a.props.onEnsureInfoSave(e)},a.cancel=function(){a.setState({modalVis:!1});var e=l.default.findDOMNode(a);l.default.unmountComponentAtNode(e);var t=e.parentNode;t.parentNode&&t.parentNode.removeChild(t)},a.getCurrentPages=(r=b(regeneratorRuntime.mark((function e(t){var r,o,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a.state.configParams,o=r.printTemplateID,l=null,r.asid&&_("localStorage",r.asid)&&(l=JSON.stringify(JSON.parse(_("localStorage",r.asid)).toEndInfo)),s=i({},r,{printTemplateID:o,appcode:r.appcode,nodeKey:r.nodekey,ncclouPrintSetting:l?i({},l,{changeType:1}):l,download:"preview",sysType:3}),(0,h.default)({newProps:a.props,url:t.url,params:s,enctype:2}),console.log("gzipStatus",_("localStorage","gzip")),a.getUnzipCurrentPage("current");case 8:case"end":return e.stop()}}),e,n)}))),function(e){return r.apply(this,arguments)}),a.getTotalPages=function(e){var t=(0,s.deepClone)(e.params),n=i({},t,{download:"previewTotalPages"});(0,g.default)({newProps:a.props,url:e.url,params:n,enctype:2}),console.log("gzipStatus",_("localStorage","gzip")),a.getUnzipTotalPage("total")},a.getUnzipCurrentPage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"current",t=P(_("localStorage","cowboy")),n=x("cookiets")||Date.now(),i=(n=isNaN(n)?n:Number(n),a),r=0,o=setInterval((function(){var n="total"==e?window.frames.totalPageIframe:window.frames.currentPageIframe;if(n){(r+=1)>200&&clearInterval(o);var a=n.document.getElementsByTagName("pre")[0];if(a&&a.innerHTML){console.log(_("localStorage","rockin"));var l=a.innerHTML;"string"==typeof a.innerHTML&&"true"==_("localStorage","rockin")&&(l=s.Cipher.decrypt(a.innerHTML,t)),clearInterval(o),l="1"==_("localStorage","gzip")?S.unzip(l):JSON.parse(l),console.log("res",l),"total"==e?i.setState({totalPages:l.data}):"current"===e&&i.setState({currentPages:l.data})}}}),800)},a.getUnzipTotalPage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"total",t=P(_("localStorage","cowboy")),n=x("cookiets")||Date.now(),i=(n=isNaN(n)?n:Number(n),a),r=0,o=setInterval((function(){var n="total"==e?window.frames.totalPageIframe:window.frames.currentPageIframe;if(n){(r+=1)>2e3&&clearInterval(o);var a=n.document.getElementsByTagName("pre")[0];if(a&&a.innerHTML){console.log(_("localStorage","rockin"));var l=a.innerHTML;"string"==typeof a.innerHTML&&"true"==_("localStorage","rockin")&&(l=s.Cipher.decrypt(a.innerHTML,t)),clearInterval(o),l="1"==_("localStorage","gzip")?S.unzip(l):JSON.parse(l),console.log("res",l),"total"==e?i.setState({totalPages:l.data}):"current"===e&&i.setState({currentPages:l.data})}}}),1e3)},a.initFormData=(o=b(regeneratorRuntime.mark((function e(){var t,r,o,l,p,d,c,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.configParams,r=u.printTemplateID?u.printTemplateID:t.printTemplateID,e.next=4,(0,m.default)(a.props,a.props.url,i({},t,{printTemplateID:r}),a.state.json);case 4:o=e.sent,l=a.state.responseAllData,p=o.nccloudPrinterList,a.setState({nccloudPrinterList:p}),d=a,c=null,t.asid&&_("localStorage",t.asid)&&(c=JSON.stringify(JSON.parse(_("localStorage",t.asid)).toEndInfo)),a.setState({currPrintTemplateID:r,nopreview:!!c&&JSON.parse(c).nopreview||!1}),(0,s.ajax)({url:"/nccloud/riart/printtool/down.do",data:{printTemplateID:r,appcode:t.appcode,nodeKey:t.nodekey,ncclouPrintSetting:u.printTemplateID?i({},c,{changeType:1}):c},success:function(e){var t=e.success,n=e.data;if(t){if(l=i({},e.data,{paperCheck:!1!==n.paperCheck,nccloudPrinterList:p,printTemplateID:r}),c&&!l.currentNCCloudPrinter){var o=JSON.parse(JSON.parse(c).ncclouPrintSetting),a=o.currentNCCloudPrinter;l.currentNCCloudPrinter=a;var s=o.currentNCCloudPaperResource;l.currentNCCloudPaperResource=s}d.setState({responseAllData:l});var f=!u.printTemplateID;d.formatData(l,f)}}});case 13:case"end":return e.stop()}}),e,n)}))),function(){return o.apply(this,arguments)}),a.formatData=function(e,t){f.modifyMeta.call(a,e.printerId||""),f.initFormVal.call(a,e,"",e.printTemplateID),t&&f.initTempalteIdInfo.call(a,e)},a.reloadPDFile=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a.toggleShowLoad.call(a,!0);var t=f.gerRequestVO.call(a),n=a.state.configParams;(0,u.default)({newProps:a.props,params:i({},t,{printTemplateID:e||n.printTemplateID,changeType:e?1:2,hadPlugin:!0}),url:a.props.url,enctype:2,hasModal:!0},a.state.json),setTimeout((function(){a.toggleShowLoad.call(a,!1)}),1500)},a.resetIframeStyle=function(){},a.changePreviewStatus=function(e){a.setState({nopreview:e})},a.output=function(){var e=a.state,t=e.configParams,n=e.configUrl;(0,s.output)({url:n,data:i({},t,{download:null,outputType:"output",searchTemplate:!1}),callback:a.onButtonClick})},a.state={showLoad:!1,modalVis:!1,nopreview:!1,totalPages:0,currentPages:0,asid:a.props.params.asid,responseAllData:{nccloudPrinterList:[],currentNCCloudTemplateInfo:{},currentNccloudPaper:{},nccloudTemplateInfoList:[],currentNCCloudPrinter:{}},json:{},init:null,configParams:a.props.params,configUrl:a.props.url},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentWillMount",value:function(){var e=this;(0,s.getMultiLang)({moduleId:"contains_printOnClient",callback:function(t,n,i){n?e.setState({json:t,inlt:i}):console.log("未加载到多语资源")}})}},{key:"componentDidMount",value:function(){var e=this,t=this.state.configParams;this.setState({showModal:!0}),this.initFormData(),this.getTotalPages({params:t,url:this.props.url}),this.getCurrentPages({params:t,url:this.props.url}),v.default.subscribe("modifySfVar",(function(n,i){var r=JSON.parse(decodeURI(t.userjson));for(var o in i)r[o]=i[o];t.userjson=encodeURI(JSON.stringify(r)),e.setState({configParams:t})})),v.default.subscribe("modifySfPaper",(function(t,n){var r=e.state.configParams,o=r.printTemplateID,a=void 0===o?null:o,l=r.userjson,s=void 0===l?{}:l;for(var p in s=JSON.parse(decodeURI(s)),n)s[p]=n[p];r.userjson=encodeURI(JSON.stringify(s));var d=f.gerRequestVO.call(e);(0,u.default)({newProps:e.props,params:i({},d,{printTemplateID:a||r.printTemplateID,changeType:a?1:2,hadPlugin:!0}),url:e.props.url,enctype:2,hasModal:!0},e.state.json)}))}},{key:"toggleShowLoad",value:function(e){this.setState({showLoad:e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.form,i=t.params,r=n.createForm,l=this.state,s=l.showModal,p=l.configParams;return console.log({configParams:p}),a.default.createElement("div",{className:"print-preview-model",style:{display:s?"block":"none"}},a.default.createElement("iframe",{id:"totalPageIframe",name:"totalPageIframe",style:{display:"none"}}),a.default.createElement("iframe",{id:"currentPageIframe",name:"currentPageIframe",style:{display:"none"}}),a.default.createElement("div",{className:"print-preview-model-dialog"}),a.default.createElement("div",{className:"model-body"},a.default.createElement("header",{className:"model-header"},a.default.createElement("span",null,this.state.json.index_003),a.default.createElement(C,{type:"uf-close",className:"close-modal",onClick:this.cancel})),a.default.createElement(O,null,a.default.createElement(T,{md:9},a.default.createElement("div",{style:{position:"absolute",zIndex:100,height:57,backgroundColor:"#525659",width:"96%"}}),a.default.createElement("iframe",{id:"printPreviewModal",name:"printPreviewModal",style:{width:"100%",height:"430px"},onLoad:function(){e.resetIframeStyle()}})),a.default.createElement(T,{md:3},a.default.createElement(k,{container:this,show:this.state.showLoad}),a.default.createElement("div",{className:"print-form-contain"},i.hideTemplate?null:a.default.createElement(o.Fragment,null,a.default.createElement("h4",{className:"header-title header-title-first"},this.state.json.index_004),r("printTemplate",{onAfterEvent:c.default.bind(this),onBeforeEvent:d.default.bind(this)})),a.default.createElement("h4",{className:"header-title"},this.state.json.index_005),r("printRange",{onAfterEvent:c.default.bind(this),onBeforeEvent:d.default.bind(this)}),a.default.createElement("h4",{className:"header-title"},this.state.json.index_006),r("printMachine",{onAfterEvent:c.default.bind(this),onBeforeEvent:d.default.bind(this)}),a.default.createElement("h4",{className:"header-title"},this.state.json.index_007),r("printStyle",{onAfterEvent:c.default.bind(this),onBeforeEvent:d.default.bind(this)}),i.formulaConfig?i.formulaConfig:null))),a.default.createElement("footer",{className:"model-footer"},p.hidePreviewCheck?null:a.default.createElement(j,{checked:this.state.nopreview,fieldid:"preview_check",value:this.state.nopreview,onChange:this.changePreviewStatus},this.state.json.index_008),i.hideTemplate?null:a.default.createElement("p",{className:"total-paegs"},"(",this.state.json.index_009,this.state.currentPages,this.state.json.index_010,")",this.state.json.index_011,this.state.totalPages,this.state.json.index_010),a.default.createElement(I,{onClick:this.save,fieldid:"print_btn",colors:"danger"},this.state.json.index_012),p.notNeedOutPutBtn?null:a.default.createElement(I,{onClick:this.output,fieldid:"output_btn"},this.state.json.index_013),a.default.createElement(I,{onClick:this.cancel,fieldid:"cancel_btn"},this.state.json.index_014))))}}]),t}(o.Component);N=(0,s.createPage)({initTemplate:p.default})(N),t.default=N},263:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};(0,i.getMultiLang)({moduleId:"contains_printOnClient",callback:function(n,i,o){i?(t={printTemplate:{moduletype:"form",items:[{attrcode:"templateInfoList",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"select",showClear:!1,options:[],label:n.index_004+"："}],status:"edit"},printRange:{moduletype:"form",items:[{attrcode:"pageRangeType",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"radio",showClear:!1,options:[{display:""+n.index_000,value:0},{display:""+n.index_016,value:1}],label:n.index_005+"："},{attrcode:"pageFrom",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!1,itemtype:"number",label:""+n.index_018},{attrcode:"pageTo",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!1,itemtype:"number",label:""+n.index_019},{attrcode:"pageWholeType",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"select",showClear:!1,options:[{display:""+n.index_020,value:0},{display:""+n.index_021,value:1},{display:""+n.index_022,value:2}],label:""+n.index_023},{attrcode:"copies",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"number",label:""+n.index_024},{attrcode:"collated",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"switch",label:""+n.index_025},{attrcode:"doubleside",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"select",showClear:!1,label:""+n.index_026,options:[{display:""+n.index_027,value:0},{display:""+n.index_028,value:1},{display:""+n.index_029,value:2}]}],status:"edit"},printMachine:{moduletype:"form",items:[{attrcode:"PrinterList",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"select",showClear:!1,options:[],label:""+n.index_030},r({attrcode:"printerStatus",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,disabled:!0,itemtype:"input",label:""+n.index_031},"disabled",!0),{attrcode:"paperResourceList",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"select",showClear:!1,options:[],label:""+n.index_032},{attrcode:"twoSide",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"input",label:""+n.index_033,disabled:!0}],status:"edit"},printStyle:{moduletype:"form",items:[{attrcode:"paperList",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"select",showClear:!1,options:[],label:""+n.index_034},{attrcode:"paperWidth",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"input",label:""+n.index_035,disabled:!0},{attrcode:"paperHeight",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"input",label:""+n.index_036,disabled:!0},{attrcode:"nccloudPaperDirect",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"radio",label:""+n.index_037,options:[{display:""+n.index_038,value:!1},{display:""+n.index_039,value:!0}]},{attrcode:"isMultiColor",placeholder:"",value:"",leftspace:0,rightspace:0,required:!1,visible:!0,itemtype:"switch",label:""+n.index_040}],status:"edit"}},e.meta.setMeta(t)):console.log("未加载到多语资源")}})};var i=n(0);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i,r){["pageFrom","pageTo"].includes(n)&&function(e,t){1!=e.form.getFormItemsValue(t,"pageRangeType")&&e.form.setFormItemsValue(t,{pageRangeType:{display:"页面",value:1}})}(e,t);return!0}},265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i,s){var p=i.value.key?i.value.key:i.value;i.display;"PrinterList"===n&&o.call(this,p);"nccloudPaperDirect"===n&&r.call(this,p);if(["paperList"].includes(n)&&i!==s){var d=this.props.meta.getMeta(),c=[];d.printStyle.items.map((function(e){"paperList"===e.attrcode&&(c=e.options)})),console.log({paperList:c}),a.call(this,c,p),this.props.form.setFormItemsDisabled(t,{paperWidth:this.state.json.index_015!==i.display,paperHeight:this.state.json.index_015!==i.display})}["templateInfoList"].includes(n)&&l.call(this,p);"pageRangeType"===n&&e.form.setFormItemsVisible("printRange",{pageFrom:!!Number(p),pageTo:!!Number(p)})};var i=n(12);function r(e){var t=this.props.form.getFormItemsValue("printStyle",["paperWidth","paperHeight"]);console.log({printStyleVO:t}),this.props.form.setFormItemsValue("printStyle",{paperWidth:{value:t[1].value},paperHeight:{value:t[0].value}}),this.reloadPDFile()}function o(e){i.modifyMeta.call(this,e);var t=this.props.form.getFormItemsValue("printStyle","paperList"),n=this.props.form.getFormItemsValue("printMachine","paperResourceList"),r=[],o=[],a=!1,l=this.props.meta.getMeta(),s=this.state.responseAllData.nccloudPrinterList.find((function(t){return e==t.printerId}));l.printStyle.items.find((function(e){if("paperList"===e.attrcode)return r=e.options,!0})),l.printMachine.items.find((function(e){if("paperResourceList"===e.attrcode)return o=e.options,!0})),o.length&&(a=o.some((function(e){return e.display==n.display}))),r.some((function(e){return e.display==t.display}))||(this.props.form.setFormItemsValue("printStyle",{paperList:{display:r[0].display,value:r[0].value}}),this.reloadPDFile()),!o.length||a?this.props.form.setFormItemsValue("printMachine",{paperResourceList:{display:o.length?o[0].display:"",value:o.length?o[0].value:""}}):this.props.form.setFormItemsValue("printMachine",{paperResourceList:{display:n.display?n.display:o[0].display,value:n.value?n.value:o[0].value}}),this.props.form.setFormItemsValue("printMachine",{printerStatus:{display:s.printerStatus?this.state.json.index_062:this.state.json.index_063,value:s.printerStatus},twoSide:{display:s.twoSide?this.state.json.index_064:this.state.json.index_065,value:s.twoSide}})}function a(e,t){var n=e.find((function(e){return e.value===t}));this.props.form.setFormItemsValue("printStyle",{paperWidth:{value:parseInt(n.paperWidth)},paperHeight:{value:parseInt(n.paperHeight)},nccloudPaperDirect:{value:n.paperWidth<n.paperHeight}}),this.reloadPDFile()}function l(e){this.initFormData({printTemplateID:e}),this.reloadPDFile(e)}},266:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.default=function(e){e.newProps;var t=e.params,n=e.url,r=e.enctype,o=(e.hasModal,arguments.length>1&&void 0!==arguments[1]&&arguments[1],""),a="",l=window.parent.location.hash.split("?");if(l&&l[1]){var s=l[1].split("&");s&&s instanceof Array&&s.forEach((function(e){-1!=e.indexOf("=")&&e.split("=")&&e.split("=")instanceof Array&&("n"===e.split("=")[0]&&e.split("=")[1]&&(o=decodeURIComponent(decodeURIComponent(e.split("=")[1]))),"c"===e.split("=")[0]&&e.split("=")[1]&&(a=decodeURIComponent(decodeURIComponent(e.split("=")[1]))))}))}var p=(o||null)+"-"+(window.actionName||null),d={sys_busiaction:p,sys_appcode:a,sys_ts:(new Date).getTime()},c=[{target:"totalPageIframe",method:"POST",enctype:r=function(e){switch(e){case 1:return"multipart/form-data";case 2:return"application/x-www-form-urlencoded";case 3:return"text/plain";default:return"multipart/form-data"}}(r),type:"hidden",action:n||""},document.createElement("form")],u=c[0],f=c[1];Object.assign(f,u);var m=i({},t,d),g=function(e){if(m[e]instanceof Array)m[e].forEach((function(t,n){var i=document.createElement("input");i.type="hidden",i.name=e,i.value=t,f.appendChild(i)}));else{var t=document.createElement("input");t.type="hidden",t.name=e,t.value=m[e],f.appendChild(t)}};for(var h in m)g(h);return document.body.appendChild(f),f.submit(),document.body.removeChild(f),!1};var r,o=n(4);(r=o)&&r.__esModule},267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.default=function(e){e.newProps;var t=e.params,n=e.url,r=e.enctype,o=(e.hasModal,arguments.length>1&&void 0!==arguments[1]&&arguments[1],""),a="",l=window.parent.location.hash.split("?");if(l&&l[1]){var s=l[1].split("&");s&&s instanceof Array&&s.forEach((function(e){-1!=e.indexOf("=")&&e.split("=")&&e.split("=")instanceof Array&&("n"===e.split("=")[0]&&e.split("=")[1]&&(o=decodeURIComponent(decodeURIComponent(e.split("=")[1]))),"c"===e.split("=")[0]&&e.split("=")[1]&&(a=decodeURIComponent(decodeURIComponent(e.split("=")[1]))))}))}var p=(o||null)+"-"+(window.actionName||null),d={sys_busiaction:p,sys_appcode:a,sys_ts:(new Date).getTime()},c=[{target:"currentPageIframe",method:"POST",enctype:r=function(e){switch(e){case 1:return"multipart/form-data";case 2:return"application/x-www-form-urlencoded";case 3:return"text/plain";default:return"multipart/form-data"}}(r),type:"hidden",action:n||""},document.createElement("form")],u=c[0],f=c[1];Object.assign(f,u);var m=i({},t,d),g=function(e){if(m[e]instanceof Array)m[e].forEach((function(t,n){var i=document.createElement("input");i.type="hidden",i.name=e,i.value=t,f.appendChild(i)}));else{var t=document.createElement("input");t.type="hidden",t.name=e,t.value=m[e],f.appendChild(t)}};for(var h in m)g(h);return document.body.appendChild(f),f.submit(),document.body.removeChild(f),!1};var r,o=n(4);(r=o)&&r.__esModule},268:function(e,t,n){var i=n(269);"string"==typeof i&&(i=[[e.i,i,""]]);var r={transform:void 0};n(3)(i,r);i.locals&&(e.exports=i.locals)},269:function(e,t,n){(e.exports=n(2)(!1)).push([e.i,".print-preview-model .u-col-md-9,\n.print-preview-model .u-col-md-3 {\n  padding-right: 0;\n}\n.print-preview-model .u-col-md-9 {\n  width: 73%;\n}\n.print-preview-model .u-col-md-3 {\n  padding-left: 0;\n  width: 27%;\n}\n.print-preview-model .print-preview-model-dialog {\n  position: fixed;\n  z-index: 100;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.4);\n}\n.print-preview-model .lightapp-component-form {\n  padding: 0;\n}\n.print-preview-model .lightapp-component-form .form-item .form-item-label {\n  width: 100px;\n  min-width: 50px;\n}\n.print-preview-model .lightapp-component-form .form-item .form-item-control {\n  width: calc(100% - 100px);\n}\n.print-preview-model .model-body {\n  position: fixed;\n  z-index: 110;\n  left: 50%;\n  top: 20px;\n  -webkit-transform: translateX(-50%);\n          transform: translateX(-50%);\n  width: 80%;\n  height: 520px;\n  top: 360;\n  background: #fff;\n}\n.print-preview-model .model-header {\n  padding: 12px 15px;\n  background: #f3f3f3;\n  font-size: 16px;\n}\n.print-preview-model .model-header .close-modal {\n  float: right;\n  cursor: pointer;\n}\n.print-preview-model .model-footer {\n  position: relative;\n  padding: 10px 8px;\n  text-align: right;\n  border-top: 1px solid #ddd;\n}\n.print-preview-model .model-footer .u-checkbox {\n  float: left;\n  line-height: 18px;\n}\n.print-preview-model .model-footer .u-checkbox-label {\n  padding-top: 5px;\n}\n.print-preview-model .model-footer .u-checkbox-label::before,\n.print-preview-model .model-footer .u-checkbox-label::after {\n  top: 8px;\n}\n.print-preview-model .print-form-contain {\n  height: 430px;\n  width: 95%;\n  overflow-y: auto;\n}\n.print-preview-model .header-title {\n  padding: 0 0 0 16px;\n  margin-top: 5px;\n  height: 32px;\n  line-height: 32px;\n  font-size: 13px;\n  background-color: #eceff5;\n}\n.print-preview-model .header-title.header-title-first {\n  margin-top: 0;\n}\n.print-preview-model .total-paegs {\n  position: absolute;\n  right: 26%;\n  bottom: 18px;\n}\n.print-preview-model .group-form-wrapper {\n  position: relative;\n}\n.print-preview-model .form-item.pageFrom,\n.print-preview-model .form-item.pageTo {\n  position: relative;\n  left: 86px;\n  top: 0;\n}\n.print-preview-model .form-item.pageFrom .form-item-label,\n.print-preview-model .form-item.pageTo .form-item-label {\n  padding-right: 5px;\n  width: 45px;\n  min-width: 0;\n}\n.print-preview-model .form-item.pageFrom .form-item-control,\n.print-preview-model .form-item.pageTo .form-item-control {\n  width: 46px;\n  padding-right: 0;\n}\n.print-preview-model .pageFrom,\n.print-preview-model .pageTo {\n  width: 32% !important;\n}\n",""])},270:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.default=function(e,t,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if((0,a.isWindowSystem)()){var l=function(i,r,a){r?d(e,t,n,o,i):console.log("未加载到多语资源")};(0,r.getMultiLang)({moduleId:"contains_printOnClient",callback:l})}else(0,r.print)("pdf",t,i({},n,{sysType:(0,a.isWindowSystem)()?"1":"2"}),o)};l(n(1)),l(n(4));var r=n(0),o=l(n(63)),a=n(12);function l(e){return e&&e.__esModule?e:{default:e}}var s=r.Cipher.opaqueDecrypt,p=r.viewModel.getGlobalStorage,d=function(e,t,n,o,a){(0,r.ajax)({url:"/nccloud/riart/printtool/sessionid.do",data:{printTemplateID:n.printTemplateID,nodekey:n.nodekey,appcode:n.appcode,num:"1"},success:function(l){var s=l.success,d=l.data;if(s){var u=null;d.asid&&p("localStorage",d.asid)&&(u=JSON.parse(p("localStorage",d.asid)).toEndInfo);var m=i({},n,{nccloudsessionid:d.sessionid,ncclouPrintSetting:u,asid:d.asid,isPrinterView:!0,searchTemplate:o,authority:d.authority});if(u&&u.printTemplateID&&u.nopreview){var g=(0,r.deepClone)(u);g=g.ncclouPrintSetting,m=Object.assign({},m,{ncclouPrintSetting:g}),f(e,t,i({},m,{printTemplateID:o?u.printTemplateID:n.printTemplateID}),a)}else c(e,t,m,o,a)}else(0,r.toast)({color:"error",content:a.index_047})},error:function(e){console.error(e.message)}})},c=function(e,t,n,i,r){(0,o.default)(e,t,n,i,(function(i){var o=Object.assign({},i,{type:n.virType?n.virType:"1"});console.log({queryParams:o}),f(e,t,o,r)}))},u=null,f=function(e,t,n,i){var o=null,a=n.beginUrl||window.location.protocol+"//"+window.location.hostname+":"+window.location.port,l=s(p("localStorage","cowboy")),d=p("localStorage","rockin")||!1;if(null!=o&&1==o.readyState)(0,r.toast)({color:"warning",content:i.index_043});else if("WebSocket"in window){o=null;var c=new WebSocket("ws://"+(n.socketIp||"127.0.0.1")+":9999/websocket");c.onopen=function(e){console.log("连接成功"),(u=window.open("")).document.title=i.index_049;var t="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;"">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110518_e60c0d16_919028.png"/></p>\n              <span>...</span>\n            </div>\n          </div>\n        </div>    \n        ';u.document.body.innerHTML=t},c.onclose=function(e){console.log("关闭连接")},c.onerror=function(i){e.openTo("/uap/printExeDown/ExeDownload/main/index.html?pk_message=dd",{appcode:n.appcode,pagecode:n.pagecode,actionUrl:t})},c.onmessage=function(e){var t="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 102px;"">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110533_f85d3142_919028.png"/></p>\n              <span>'+i.index_061+"</span>\n            </div>\n          </div>\n        </div>    \n        ",n="<div><h2 style='border-bottom: 1px solid #ddd;padding: 10px 0'>"+i.index_050+'</h2>\n          <div style="width: 560px; margin: 0 auto; position: relative;">\n            <div style="display:inline-block; text-align:center;">\n              <p><img style="width: 34px; height: 34px;" src="https://images.gitee.com/uploads/images/2019/0314/110540_e2d0849a_919028.png"/></p>\n              <span>'+i.index_058+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 48px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 150px;">\n              <p><img style="width: 40px; height: 40px;" src="https://images.gitee.com/uploads/images/2019/0314/110508_a5f9c80c_919028.png"/></p>\n              <span>'+i.index_059+'</span>\n            </div>\n            <p style="width:180px; border-bottom: 1px solid #ddd;position: absolute; top: 23px; left: 286px;"></p>\n            <div style="display:inline-block; text-align:center; margin-left: 96px;"">\n              <p><img style="width: 30px; height: 30px;" src="https://images.gitee.com/uploads/images/2019/0314/110526_3b417874_919028.png"/></p>\n              <span>'+i.index_060+"</span>\n            </div>\n          </div>\n        </div>    \n        ";e&&(Object.keys(e).length||e.data)&&(c.close(),u.document.body.innerHTML=e.data.includes(i.index_056)?t:n)};var f={},m=setInterval((function(){if(c.readyState==WebSocket.OPEN){clearInterval(m),f=Object.assign({},n,{compalteAddress:t,type:n.type,nccloudsessionid:n.nccloudsessionid,download:null,beginUrl:a,aeskey:l,rockin:d});var e=JSON.stringify(f);c.send(e)}}),1e3)}else(0,r.toast)({color:"warning",content:"不支持websocket"})}},3:function(e,t,n){var i,r,o={},a=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),l=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e.call(this,n)),t[n]}}((function(e){return document.querySelector(e)})),s=null,p=0,d=[],c=n(5);function u(e,t){for(var n=0;n<e.length;n++){var i=e[n],r=o[i.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](i.parts[a]);for(;a<i.parts.length;a++)r.parts.push(y(i.parts[a],t))}else{var l=[];for(a=0;a<i.parts.length;a++)l.push(y(i.parts[a],t));o[i.id]={id:i.id,refs:1,parts:l}}}}function f(e,t){for(var n=[],i={},r=0;r<e.length;r++){var o=e[r],a=t.base?o[0]+t.base:o[0],l={css:o[1],media:o[2],sourceMap:o[3]};i[a]?i[a].parts.push(l):n.push(i[a]={id:a,parts:[l]})}return n}function m(e,t){var n=l(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=d[d.length-1];if("top"===e.insertAt)i?i.nextSibling?n.insertBefore(t,i.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),d.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=d.indexOf(e);t>=0&&d.splice(t,1)}function h(e){var t=document.createElement("style");return e.attrs.type="text/css",v(t,e.attrs),m(e,t),t}function v(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function y(e,t){var n,i,r,o;if(t.transform&&e.css){if(!(o=t.transform(e.css)))return function(){};e.css=o}if(t.singleton){var a=p++;n=s||(s=h(t)),i=w.bind(null,n,a,!1),r=w.bind(null,n,a,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",v(t,e.attrs),m(e,t),t}(t),i=S.bind(null,n,t),r=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=h(t),i=_.bind(null,n),r=function(){g(n)});return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||(t.singleton=a()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=f(e,t);return u(n,t),function(e){for(var i=[],r=0;r<n.length;r++){var a=n[r];(l=o[a.id]).refs--,i.push(l)}e&&u(f(e,t),t);for(r=0;r<i.length;r++){var l;if(0===(l=i[r]).refs){for(var s=0;s<l.parts.length;s++)l.parts[s]();delete o[l.id]}}}};var b,x=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function w(e,t,n,i){var r=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=x(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function _(e,t){var n=t.css,i=t.media;if(i&&e.setAttribute("media",i),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function S(e,t,n){var i=n.css,r=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||o)&&(i=c(i)),r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([i],{type:"text/css"}),l=e.href;e.href=URL.createObjectURL(a),l&&URL.revokeObjectURL(l)}},4:function(e,t){e.exports=n},5:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,i=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var r,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o)?e:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")}))}},63:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.default=function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments[4],a=function(o,a){a?s(e,t,n,i,r,o):console.log("未加载到多语资源")};(0,o.getMultiLang)({moduleId:"contains_printOnClient",callback:a})};l(n(1)),l(n(4));var r=l(n(64)),o=n(0),a=n(12);function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t,n,r,a,l){var s=n.ncclouPrintSetting;s&&s.printTemplateID?p(e,t,i({},n,{printTemplateID:r?s.printTemplateID:n.printTemplateID,printSetting:JSON.stringify(s)}),a,l):r?function(e,t,n,r,a){var l=null;(0,o.ajax)({method:"post",url:"/nccloud/platform/print/queryTemplates.do",data:n,success:function(s){var d=s.success,c=s.data;if(d){if(!c||!c.length)return(0,o.toast)({color:"warning",content:a.index_048});l=c[0].m_ctemplateid?c[0].m_ctemplateid:null,p(e,t,i({},n,{printTemplateID:l}),r,a)}}})}(e,t,n,a,l):p(e,t,n,a,l)};function p(e,t,n,o,l){var s=(0,a.isWindowSystem)()?"1":"2";n.sysType&&(s=n.sysType),(0,r.default)({newProps:e,params:i({},n,{realData:n.realData||!1,download:"preview",sysType:s}),url:t,enctype:2},o,l)}},64:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},r=s(n(4)),o=n(0),a=s(n(262)),l=s(n(65));function s(e){return e&&e.__esModule?e:{default:e}}var p,d,c=o.base.NCLoading,u=window.document.createElement("div");function f(e){r.default.render(React.createElement(c,{show:!0,fullScreen:!0,container:e}),e)}function m(e){e.className="",r.default.unmountComponentAtNode(e),e.parentElement&&e.parentElement.removeChild(e)}window.document.body.appendChild(u),u.className="nc-loading-hidden",t.default=(p=regeneratorRuntime.mark((function e(t){var n,s,p,d,c,g,h,v,y,b,x,w,_,S,P=t.newProps,I=t.params,O=t.url,T=t.enctype,C=t.hasModal,j=void 0!==C&&C,k=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},N=arguments[2];return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(I.hadPlugin){e.next=10;break}return f(u),e.next=4,(0,l.default)(P,O,{});case 4:if("error"!==e.sent){e.next=9;break}return(0,o.toast)({color:"error",content:N.index_052}),m(u),e.abrupt("return");case 9:m(u);case 10:for(S in j||(n=document.body,(s=document.createElement("section")).classList.add("form-preview-print-contain"),n.appendChild(s),r.default.render(React.createElement(a.default,i({},P,{params:I,url:O,onEnsureInfoSave:k})),s)),p="",d="",(c=window.parent.location.hash.split("?"))&&c[1]&&(g=c[1].split("&"))&&g instanceof Array&&g.forEach((function(e){-1!=e.indexOf("=")&&e.split("=")&&e.split("=")instanceof Array&&("n"===e.split("=")[0]&&e.split("=")[1]&&(p=decodeURIComponent(decodeURIComponent(e.split("=")[1]))),"c"===e.split("=")[0]&&e.split("=")[1]&&(d=decodeURIComponent(decodeURIComponent(e.split("=")[1]))))})),h=(p||null)+"-"+(window.actionName||null),v={sys_busiaction:h,sys_appcode:d,sys_ts:(new Date).getTime()},T=function(e){switch(e){case 1:return"multipart/form-data";case 2:return"application/x-www-form-urlencoded";case 3:return"text/plain";default:return"multipart/form-data"}}(T),y=[{target:"printPreviewModal",method:"POST",enctype:T,type:"hidden",action:O||""},document.createElement("form")],b=y[0],x=y[1],Object.assign(x,b),w=i({},I,v,{formulaConfig:null}),_=function(e){if(w[e]instanceof Array)w[e].forEach((function(t,n){var i=document.createElement("input");i.type="hidden",i.name=e,i.value=t,x.appendChild(i)}));else{var t=document.createElement("input");t.type="hidden",t.name=e,t.value=w[e],x.appendChild(t)}},w)_(S);return document.body.appendChild(x),x.submit(),document.body.removeChild(x),e.abrupt("return",!1);case 26:case"end":return e.stop()}}),e,this)})),d=function(){var e=p.apply(this,arguments);return new Promise((function(t,n){return function i(r,o){try{var a=e[r](o),l=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(l).then((function(e){i("next",e)}),(function(e){i("throw",e)}));t(l)}("next")}))},function(e){return d.apply(this,arguments)})},65:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){var o=null;return new Promise((function(a,l){if(null!=o&&1==o.readyState)(0,i.toast)({color:"warning",content:r.index_043});else if("WebSocket"in window){o=null;var s=new WebSocket("ws://"+(n.socketIp||"127.0.0.1")+":9999/websocket");s.onopen=function(e){console.log("连接成功")},s.onclose=function(e){console.log("关闭连接")},s.onerror=function(i){return e.openTo("/uap/printExeDown/ExeDownload/main/index.html?pk_message=dd",{appcode:n.appcode,pagecode:n.pagecode,actionUrl:t}),a("error")},s.onmessage=function(e){console.log("msg",JSON.parse(e.data));var t={};if(e&&(Object.keys(e).length||e.data))return s.close(),t.nccloudPrinterList=JSON.parse(e.data).nccloudPrinterList,a(t)};var p={},d=setInterval((function(){if(s.readyState==WebSocket.OPEN){clearInterval(d),(p=Object.assign({},n,{compalteAddress:t,type:"2",nccloudsessionid:n.nccloudsessionid})).formulaConfig&&delete p.formulaConfig;var e=JSON.stringify(p);s.send(e)}}),1e3)}else(0,i.toast)({color:"warning",content:r.index_046})}))};var i=n(0)}})}));
//# sourceMappingURL=index.js.map