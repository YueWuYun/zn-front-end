/*! @ncctag {"date":"2020-5-11 23:39:24"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uap/rbac/changeAuthority/main/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uap/rbac/changeAuthority/main/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,o){return function(e){var t={};function o(a){if(t[a])return t[a].exports;var s=t[a]={i:a,l:!1,exports:{}};return e[a].call(s.exports,s,s.exports,o),s.l=!0,s.exports}return o.m=e,o.c=t,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="../../../../",o(o.s=589)}({1:function(t,o){t.exports=e},2:function(e,o){e.exports=t},220:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RoleDutyModal=void 0;var a=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),s=o(2),n=l(s),r=(l(o(3)),o(1));function l(e){return e&&e.__esModule?e:{default:e}}r.base.NCModal,r.base.NCButton,r.base.NCForm,r.base.NCFormControl,r.base.NCRadio;var i=r.base.NCSelect,c=(r.base.NCCheckbox,i.NCOption,t.RoleDutyModal=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.showdata=function(){var e=o,t=e.props.pk_responsibility;null!=t&&null!=t&&(0,r.ajax)({url:"/nccloud/rabc/role/respInfo.do",data:t,success:function(t){t.success&&(null!=t.data?e.props.syncTree.setSyncTreeData("tree1",t.data):e.props.syncTree.setSyncTreeData("tree1",[]))},error:function(e){(0,r.toast)({content:e.message,color:"danger"})}})},o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillMount",value:function(){this.showdata()}},{key:"render",value:function(){var e=this.props,t=e.syncTree,o=(e.modal,t.createSyncTree);return n.default.createElement("div",null,o({treeId:"tree1",needSearch:!0,needEdit:!1}))}}]),t}(s.Component));t.default=t.RoleDutyModal=c=(0,r.createPage)({})(c)},244:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o="rolepermlist",s=this.state.print_type;"card"==s&&("rolepermcard",o="rolepermcard");var n="10120FUNCPERMPF",r=function(e,t){var o=[];switch(t){case"list":var a=e.props.table.getAllTableData("RolePermissionPF");a&&(a=a.rows),null!=a&&a.length>0&&a.map((function(e){o.push(e.values.pk_roleperm_pf.value)}));break;case"card":var s=e.props.form.getFormItemsValue("RolePermissionPF","pk_roleperm_pf");o.push(s.value)}return o}(this,s);if(null==r||r.length<=0)return(0,a.toast)({content:this.state.json["0011"],color:"danger"}),!1;switch(t){case"printor":(0,a.print)("pdf","/nccloud/rbac/roleperm/print.do",{funcode:n,appcode:n,nodekey:o,oids:r});break;case"export":var l={funcode:n,appcode:n,nodekey:o,oids:r,outputType:"output"};(0,a.output)({url:"/nccloud/rbac/roleperm/print.do",data:l,callback:function(){console.log("输出成功")}})}};var a=o(1)},3:function(e,t){e.exports=o},362:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),s=o(2),n=o(1),r=o(363);n.base.NCBackBtn;var l=n.base.NCTabs,i=n.cardCache.updateCache,c=n.cardCache.addCache,u=n.high.ApproveDetail,p=n.high.ApprovalTrans,d=l.NCTabPane,f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.InitChangeData=function(e,t,a){var s=o.props,r=o.props.getUrlParam("id");if(e&&(r=e),!r)return s.button.setButtonVisible(["commit","edit","unapprove","del","save","cancel","print","callback","lookfun"],!1),void s.button.setButtonVisible(["add"],!0);var l=o;(0,n.ajax)({url:"/nccloud/rbac/roleChangeAuth/detail.do",data:r,success:function(e){if(e.success){if(null!=e.data&&null!=e.data.RolePermissionPF){s.form.setAllFormValue({RolePermissionPF:e.data.RolePermissionPF.RolePermissionPF});var t=e.data.RolePermissionPF.RolePermissionPF.rows[0].values.vbillstatus.value;l.setButtonStatus(t,s),"edit"==a?i("pk_roleperm_pf",r,e.data.RolePermissionPF.RolePermissionPF,"RolePermissionPF","uap.rbac.changeAuthority.cache",e.data.RolePermissionPF.RolePermissionPF.rows[0].values):"add"==a&&c(r,e.data.RolePermissionPF,"RolePermissionPF","uap.rbac.changeAuthority.cache",e.data.RolePermissionPF.RolePermissionPF.rows[0].values)}else s.form.EmptyAllFormValue("RolePermissionPF");null!=e.data&&null!=e.data.pfrespinfos?s.editTable.setTableData("pfrespinfos",e.data.pfrespinfos.pfrespinfos):s.editTable.setTableData("pfrespinfos",{rows:[]}),null!=e.data&&null!=e.data.pforginfos?s.editTable.setTableData("pforginfos",e.data.pforginfos.pforginfos):s.editTable.setTableData("pforginfos",{rows:[]})}},error:function(e){(0,n.toast)({content:e.message,color:"danger"})}})},o.getAssginUsedr=function(e){var t=o;o.setState({compositedisplay:!1}),(0,n.ajax)({url:"/nccloud/rbac/changeAuthority/commit.do",data:{pks:[t.props.getUrlParam("id")],type:"form",workflow:e},success:function(e){e.data.status?(t.setButtonStatus(e.data.result.RolePermissionPF.rows[0].values.vbillstatus.value,t.props),t.props.form.setAllFormValue({RolePermissionPF:e.data.result.RolePermissionPF}),(0,n.toast)({color:"success"})):(0,n.toast)({content:e.data.message,color:"danger"})},error:function(e){(0,n.toast)({content:e.message,color:"danger"})}})},o.turnOff=function(){o.setState({compositedisplay:!1})},o.openApprove=function(){o.setState({show:!0})},o.closeApprove=function(){o.setState({show:!1})},o.state={print_type:"card",compositedisplay:!1,compositedata:{},backbtnstatus:"",tabvalue:"1",show:!1,json:{},inlt:null},o.getAssginUsedr=o.getAssginUsedr.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.getUrlParam("status");this.setState({backbtnstatus:"browse"!=t?"none":""}),this.page_type=t,this.InitChangeData();this.props.MultiInit.getMultiLang({moduleId:"1012-10120funcpermpf",domainName:"uap",callback:function(t,o,a){o?e.setState({json:t,inlt:a}):console.log("未加载到多语资源")}})}},{key:"componentDidMount",value:function(){"browse"!=this.props.getUrlParam("status")&&(this.props.button.setButtonVisible(["commit","edit","del","add","callback","unapprove","lookfun"],!1),this.props.button.setButtonVisible(["save","cancel"],!0)),"add"==this.props.getUrlParam("status")&&this.getLoginData()}},{key:"getLoginData",value:function(){var e=this;(0,n.ajax)({url:"/nccloud/rbac/get/getLoginInfo.do",data:{state:"RolePermissionPF"},async:!1,success:function(t){t.success&&t.data&&(e.props.form.setAllFormValue({RolePermissionPF:t.data.RolePermissionPF.RolePermissionPF}),e.props.form.setFormItemsDisabled("RolePermissionPF",{vbillno:!t.data.isEnable}),e.props.editTable.setTableData("pfrespinfos",{rows:[]}),e.props.editTable.setTableData("pforginfos",{rows:[]}))}})}},{key:"addTablRows",value:function(e,t){var o=e.props.form.getFormItemsValue("RolePermissionPF","pk_role");if(o&&o.value&&null!=o){var a=e.props,s=e.props.editTable.getNumberOfRows(t);a.editTable.addRow(t,s,!0),(0,n.ajax)({url:"/nccloud/rbac/role/roletype.do",data:o.value,async:!1,success:function(e){if(e.success&&null!=e.data){var t=null;"0"==e.data?t="1":"1"==e.data&&(t="0");var o=a.meta.getMeta();o.pfrespinfos.items.map((function(e,a){o.pfrespinfos.items.find((function(e){return"pk_responsibility"==e.attrcode})).queryCondition=function(){return{respType:t}}})),a.meta.setMeta(o)}}})}else(0,n.toast)({content:this.state.json["0012"],color:"danger"})}},{key:"delTableRows",value:function(e,t){var o=e.props.editTable.getCheckedRows(t),a=[];if(null!=o&&o.length>0)for(var s=0;s<o.length;s++)a.push(o[s].index);null!=a&&a.length>0?e.props.editTable.deleteTableRowsByIndex(t,a):(0,n.toast)({content:this.state.json["0013"],color:"warning"})}},{key:"getcurrdate",value:function(){var e=new Date,t=e.getMonth()+1,o=e.getDate();return t>=1&&t<=9&&(t="0"+t),o>=0&&o<=9&&(o="0"+o),e.getFullYear()+"-"+t+"-"+o+" "+this.checkTime(e.getHours())+":"+this.checkTime(e.getMinutes())+":"+this.checkTime(e.getSeconds())}},{key:"checkTime",value:function(e){return e<10&&(e="0"+e),e}},{key:"setButtonStatus",value:function(e,t){switch(t.button.setButtonVisible(["unapprove","save","cancel","edit","del"],!1),e){case"-1":t.button.setButtonVisible(["commit","edit","del","add","print","callback","lookfun"],!0),t.button.setButtonVisible(["unapprove"],!1),t.button.setButtonDisabled({commit:!1,callback:!0});break;case"0":t.button.setButtonVisible(["commit","print","callback","lookfun"],!0),t.button.setButtonVisible(["edit","del","add","unapprove","save","cancel"],!1),t.button.setButtonDisabled({commit:!0,callback:!0});break;case"1":t.button.setButtonVisible(["commit","unapprove","add","print","lookfun"],!0),t.button.setButtonVisible(["callback"],!1),t.button.setButtonDisabled({commit:!0,unapprove:!1});break;case"3":t.button.setButtonVisible(["commit","add","print","callback","lookfun"],!0),t.button.setButtonVisible(["unapprove"],!1),t.button.setButtonDisabled({commit:!0,callback:!1});break;default:t.button.setButtonVisible(["commit","unapprove","add","print","lookfun"],!0),t.button.setButtonVisible(["callback"],!1),t.button.setButtonDisabled({commit:!0,unapprove:!0})}"browse"!=this.props.getUrlParam("status")&&(t.button.setButtonVisible(["commit","callback","unapprove","edit","del","add","print","lookfun"],!1),t.button.setButtonVisible(["save","cancel"],!0),this.setState({backbtnstatus:"none"}))}},{key:"handChange",value:function(e){this.setState({tabvalue:e})}},{key:"render",value:function(){var e=this,t=this.props.editTable.createEditTable,o=this.props.form.createForm,a=this.props.button,s=(a.createButton,a.createButtonApp,"1"==this.state.tabvalue?React.createElement("div",{style:{"max-width":"max-content","max-height":"max-content",position:"absolute","z-index":"1",top:"3px",right:"15px",display:""==this.state.backbtnstatus?"none":"1"==this.state.tabvalue?"":"none"}},this.props.button.createButtonApp({area:"tab",onButtonClick:r.buttonRespClick.bind(this),popContainer:document.querySelector(".header-button-area")})):React.createElement("div",{style:{"max-width":"max-content","max-height":"max-content",position:"absolute","z-index":"1",top:"3px",right:"15px",display:""==this.state.backbtnstatus?"none":"2"==this.state.tabvalue?"":"none"}},this.props.button.createButtonApp({area:"tab",onButtonClick:r.buttonOrgClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),i=n.base.NCDiv,c=this.props.BillHeadInfo.createBillHeadInfo;return React.createElement("div",{className:"nc-bill-card"},this.props.ncmodal.createModal("ncmodal"),this.state.compositedisplay?React.createElement(p,{title:this.state.json["0007"],data:this.state.compositedata,display:this.state.compositedisplay,getResult:this.getAssginUsedr,cancel:this.turnOff}):"",this.state.show?React.createElement(u,{show:this.state.show,close:this.closeApprove,billtype:"10FP",billid:this.props.form.getFormItemsValue("RolePermissionPF","pk_roleperm_pf").value}):"",React.createElement("div",{className:"nc-bill-top-area"},React.createElement(i,{areaCode:i.config.HEADER},React.createElement("div",{className:"nc-bill-header-area"},React.createElement("div",{className:"header-title-search-area"},c({title:this.state.json["0001"],backBtnClick:function(){e.props.pushTo("/list",{pagecode:"1012030401"})}})),React.createElement("div",{className:"header-button-area"},this.props.button.createButtonApp({area:"main",onButtonClick:r.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}),this.props.button.createButtonApp({area:"print",onButtonClick:r.printevent.bind(this),popContainer:document.querySelector(".header-button-area")})))),React.createElement("div",{className:"nc-bill-form-area"},o("RolePermissionPF",{}))),React.createElement("div",{className:"nc-bill-bottom-area"},React.createElement("div",{className:"nc-bill-table-area",style:{position:"relative"}},s,React.createElement(l,{navtype:"turn",contenttype:"moveleft",defaultActiveKey:"1",id:"NCTabs_role",onChange:this.handChange.bind(this)},React.createElement(d,{tab:this.state.json["0014"],key:"1"},t("pfrespinfos",{showIndex:!0,showCheck:!0,onBeforeEvent:r.beforeEvent.bind(this),onAfterEvent:r.afterEvent.bind(this)})),React.createElement(d,{tab:this.state.json["0015"],key:"2"},t("pforginfos",{showIndex:!0,showCheck:!0,onAfterEvent:r.afterEvent.bind(this)}))))))}}]),t}(s.Component);f=(0,n.createPage)({initTemplate:r.initTemplate})(f),t.default=f},363:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printevent=t.buttonOrgClick=t.buttonRespClick=t.initTemplate=t.beforeEvent=t.afterEvent=t.buttonClick=void 0;var a=u(o(364)),s=u(o(365)),n=u(o(366)),r=u(o(367)),l=u(o(368)),i=u(o(244)),c=u(o(369));function u(e){return e&&e.__esModule?e:{default:e}}t.buttonClick=a.default,t.afterEvent=n.default,t.beforeEvent=c.default,t.initTemplate=s.default,t.buttonRespClick=r.default,t.buttonOrgClick=l.default,t.printevent=i.default},364:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=this,a=this;switch(t){case"edit":a.page_type="edit",a.handChange(a.state.tabvalue),a.props.form.setFormStatus("RolePermissionPF","edit"),a.props.editTable.setStatus("pfrespinfos","edit",null),a.props.editTable.setStatus("pforginfos","edit",null),a.props.button.setButtonVisible(["commit","callback","edit","del","add","lookfun"],!1),a.props.button.setButtonVisible(["save","cancel"],!0),u(a);break;case"save":if(!a.props.form.isCheckNow("RolePermissionPF"))return;a.page_type||(a.page_type=a.props.getUrlParam("status"));var n=null,p=null,d={RolePermissionPF:a.props.form.getAllFormValue("RolePermissionPF")};if(d.RolePermissionPF.rows[0].values.pforginfos={value:null},d.RolePermissionPF.rows[0].values.pfrespinfos={value:null},"edit"==a.page_type?(d.RolePermissionPF.rows[0].status="1",n=a.props.editTable.getChangedRows("pfrespinfos",!0),p=a.props.editTable.getChangedRows("pforginfos",!0)):"add"==a.page_type&&(d.RolePermissionPF.rows[0].status="2",n=a.props.editTable.getAllRows("pfrespinfos",!0),p=a.props.editTable.getAllRows("pforginfos",!0)),(null==n||n.length<=0)&&(null==p||p.length<=0)&&"edit"!=a.page_type)return void(0,s.toast)({content:this.state.json["0016"],color:"danger"});if(!(null==n||n.length<=0||a.props.editTable.checkRequired("pfrespinfos",n)))return;if(!(null==p||p.length<=0||a.props.editTable.checkRequired("pforginfos",p)))return;var f={opr:a.page_type,formdata:d,pfrespinfos:n&&n.length>0?{pfrespinfos:{areacode:"pfrespinfos",rows:n}}:null,pforginfos:p&&p.length>0?{pforginfos:{areacode:"pforginfos",rows:p}}:null};(0,s.ajax)({url:"/nccloud/rbac/changeAuthority/save.do",data:f,success:function(e){e.success&&(e.data.status?((0,s.toast)({color:"success"}),a.page_type="browse",a.InitChangeData(e.data.id,a.page_type,o.page_type),a.props.form.setFormStatus("RolePermissionPF","browse"),a.props.editTable.setStatus("pfrespinfos","browse",null),a.props.editTable.setStatus("pforginfos","browse",null),a.props.pushTo("/card",{status:"browse",pagecode:"10120FUNCPERMPF_card",id:e.data.id}),u(a)):(0,s.toast)({content:e.data.message,color:"danger"}))},error:function(e){(0,s.toast)({content:e.message,color:"danger"})}});break;case"add":a.props.form.EmptyAllFormValue("RolePermissionPF"),a.page_type="add",a.handChange(a.state.tabvalue),a.props.button.setButtonVisible(["commit","callback","unapprove","edit","del","add","print","lookfun"],!1),a.props.button.setButtonVisible(["save","cancel"],!0),a.props.form.setFormStatus("RolePermissionPF","add"),a.props.editTable.setStatus("pfrespinfos","edit",null),a.props.editTable.setStatus("pforginfos","edit",null),setTimeout((function(){a.getLoginData()}),0),u(a);break;case"del":a.props.ncmodal.show("ncmodal",{title:this.state.json["0005"],beSureBtnClick:function(){(0,s.ajax)({url:"/nccloud/rbac/changeAuth/del.do",data:[a.props.form.getAllFormValue("RolePermissionPF").rows[0].values.pk_roleperm_pf.value],success:function(e){if(e.success)if(e.data.status){var t=a.props.getUrlParam("id"),o=r(t,c);l("pk_roleperm_pf",t,c),o&&null!=o?a.InitChangeData(o):(a.props.form.EmptyAllFormValue("RolePermissionPF"),a.props.editTable.setTableData("pfrespinfos",{rows:[]}),a.props.editTable.setTableData("pforginfos",{rows:[]}),a.props.button.setButtonsVisible(["edit","del","cancel","save","print"],!1)),a.props.pushTo("/card",{status:"browse",pagecode:"10120FUNCPERMPF_card",id:o}),(0,s.toast)({color:"success"})}else(0,s.toast)({content:e.data.message,color:"danger"})},error:function(e){(0,s.toast)({content:e.message,color:"danger"})}})}});break;case"commit":(0,s.ajax)({url:"/nccloud/rbac/changeAuthority/commit.do",data:{pks:[a.props.getUrlParam("id")],type:"form"},success:function(e){e.success&&("approveflow"==e.data.workflow?a.setState({compositedata:e.data,compositedisplay:!0}):e.data.status?(a.setButtonStatus(e.data.result.RolePermissionPF.rows[0].values.vbillstatus.value,a.props),a.props.form.setAllFormValue({RolePermissionPF:e.data.result.RolePermissionPF}),i("pk_roleperm_pf",e.data.result.RolePermissionPF.rows[0].values.pk_roleperm_pf.value,e.data.result.RolePermissionPF,"RolePermissionPF",c,e.data.result.RolePermissionPF.rows[0].values),(0,s.toast)({color:"success"})):(0,s.toast)({content:e.data.message,color:"danger"}))},error:function(e){(0,s.toast)({content:e.message,color:"danger"})}});break;case"callback":(0,s.ajax)({url:"/nccloud/rbac/changeAuthority/callback.do",data:{pks:[a.props.getUrlParam("id")],type:"form"},success:function(e){e.success&&(e.data.status?(a.setButtonStatus(e.data.result.RolePermissionPF.rows[0].values.vbillstatus.value,a.props),a.props.form.setAllFormValue({RolePermissionPF:e.data.result.RolePermissionPF}),i("pk_roleperm_pf",e.data.result.RolePermissionPF.rows[0].values.pk_roleperm_pf.value,e.data.result.RolePermissionPF,"RolePermissionPF",c,e.data.result.RolePermissionPF.rows[0].values),(0,s.toast)({color:"success"})):(0,s.toast)({content:e.data.message,color:"danger"}))},error:function(e){(0,s.toast)({content:e.message,color:"danger"})}});break;case"cancel":a.props.ncmodal.show("ncmodal",{title:this.state.json["0006"],beSureBtnClick:function(){a.InitChangeData(),a.page_type="browse",a.props.pushTo("/card",{id:a.props.getUrlParam("id"),pagecode:"10120FUNCPERMPF_card",status:"browse"}),a.props.form.setFormStatus("RolePermissionPF","browse"),a.props.editTable.setStatus("pfrespinfos","browse"),a.props.editTable.setStatus("pforginfos","browse"),u(a),a.props.getUrlParam("id")&&"add"!=o.props.getUrlParam("status")||setTimeout((function(){o.props.form.EmptyAllFormValue("RolePermissionPF"),o.props.button.setButtonsVisible({print:!1})}),0)}});break;case"unapprove":(0,s.ajax)({url:"/nccloud/rbac/changeAuthority/unapprove.do",data:{pks:[a.props.getUrlParam("id")],type:"form"},success:function(e){e.success&&(e.data.status?(a.setButtonStatus(e.data.result.RolePermissionPF.rows[0].values.vbillstatus.value,a.props),a.props.form.setAllFormValue({RolePermissionPF:e.data.result.RolePermissionPF}),(0,s.toast)({color:"success"})):(0,s.toast)({content:e.data.message,color:"danger"}))},error:function(e){(0,s.toast)({content:e.message,color:"danger"})}});break;case"lookfun":this.openApprove()}};var a,s=o(1),n=o(220);(a=n)&&a.__esModule;var r=s.cardCache.getNextId,l=s.cardCache.deleteCacheById,i=s.cardCache.updateCache,c="uap.rbac.changeAuthority.cache";function u(e){"browse"!=e.page_type?(e.setState({backbtnstatus:"none"}),e.props.button.setButtonsVisible({print:!1})):(e.setState({backbtnstatus:""}),e.props.button.setButtonsVisible({print:!0}))}},365:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.getUrlParam("status");"add"==t&&(t="edit"),e.createUIDom({pagecode:"10120FUNCPERMPF_card"},(function(o){if(o&&o.button){var a=o.button;e.button.setButtons(a)}if(o&&o.template){var s=o.template;s.RolePermissionPF.status=t,s.pfrespinfos.status=t,s.pforginfos.status=t,function(e,t){t.RolePermissionPF.items.map((function(e,o){t.RolePermissionPF.items.find((function(e){return"pk_role"==e.attrcode})).isMultiSelectedEnabled=!1,t.RolePermissionPF.items.find((function(e){return"pk_org"==e.attrcode})).queryCondition=function(){return{TreeRefActionExt:"nccloud.web.rbac.authres.sqlbuilder.AuthResOrgPermSqlBuilder"}}})),t.pforginfos.items.map((function(e,o){t.pforginfos.items.find((function(e){return"pk_org"==e.attrcode})).isMultiSelectedEnabled=!0,t.pforginfos.items.find((function(e){return"pk_org"==e.attrcode})).queryCondition=function(){return{TreeRefActionExt:"nccloud.web.rbac.authres.sqlbuilder.AuthResOrgPermSqlBuilder",onlyUserCanAssign:"Y"}}})),t.pfrespinfos.items.map((function(e,o){t.pfrespinfos.items.find((function(e){return"pk_responsibility"==e.attrcode})).isMultiSelectedEnabled=!0}))}(0,s),e.meta.setMeta(s)}}))};o(1)},366:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,a,s,n,r){if("pfrespinfos"===t)if(a.length>1)for(var l=e.editTable.getNumberOfRows(t),i=0;i<a.length;i++)0==i?(e.editTable.setValByKeyAndIndex(t,n,o,{value:a[i].refpk,display:a[i].refname}),e.editTable.setValByKeyAndIndex(t,n,"pk_responsibility.code",{value:a[i].refcode,display:a[i].refcode})):(e.editTable.addRow(t,l,!1,{pk_responsibility:{value:a[i].refpk,display:a[i].refname},"pk_responsibility.code":{value:a[i].refcode,display:a[i].refcode}}),l+=1);else r.values&&r.values.pk_responsibility.value?e.editTable.setValByKeyAndIndex(t,n,"pk_responsibility.code",{value:a[0].refcode,display:a[0].refcode}):e.editTable.setValByKeyAndIndex(t,n,"pk_responsibility.code",{value:null,display:null});else if("pforginfos"===t)if(a.length>1)for(var c=e.editTable.getNumberOfRows(t),u=0;u<a.length;u++)0==u?(e.editTable.setValByKeyAndIndex(t,n,o,{value:a[u].refpk,display:a[u].refname}),e.editTable.setValByKeyAndIndex(t,n,"pk_org.code",{value:a[u].refcode,display:a[u].refcode})):(e.editTable.addRow(t,c,!1,{pk_org:{value:a[u].refpk,display:a[u].refname},"pk_org.code":{value:a[u].refcode,display:a[u].refcode}}),c+=1);else r.values&&r.values.pk_org.value?e.editTable.setValByKeyAndIndex(t,n,"pk_org.code",{value:a[0].refcode,display:a[0].refcode}):e.editTable.setValByKeyAndIndex(t,n,"pk_org.code",{value:null,display:null});!function(e,t){var o=[],a=t.props.editTable.getAllRows(e,!0),s="pk_responsibility";"pforginfos"==e&&(s="pk_org");(function(e,t,o,a){null!=o&&o.length>0&&o.map((function(o,s){null!=e&&(e.length<=0||!e.includes(o.values[a].value))?e.push(o.values[a].value):t.push(s)}))})([],o,a,s),null!=o&&o.length>0&&t.props.editTable.deleteTableRowsByIndex(e,o)}(t,this)}},367:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){switch(t){case"addtab":this.addTablRows(this,"pfrespinfos");break;case"deltab":this.delTableRows(this,"pfrespinfos")}};o(1).base.NCMessage},368:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){switch(t){case"addtab":this.addTablRows(this,"pforginfos");break;case"deltab":this.delTableRows(this,"pforginfos")}};o(1).base.NCMessage},369:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,s,n,r){if("pk_responsibility"!=o.attrcode)return!1;var l=e.form.getFormItemsValue("RolePermissionPF","pk_role");if(!l||!l.value||null==l)return(0,a.toast)({content:this.state.json["0012"],color:"danger"}),!1;var i=e;return(0,a.ajax)({url:"/nccloud/rbac/role/roletype.do",data:l.value,async:!1,success:function(e){if(e.success&&null!=e.data){var t=null;if("0"==e.data?t="1":"1"==e.data&&(t="0"),!t||null==t)return!1;var o=i.meta.getMeta();return o.pfrespinfos.items.map((function(e,a){o.pfrespinfos.items.find((function(e){return"pk_responsibility"==e.attrcode})).queryCondition=function(){return{respType:t}}})),i.meta.setMeta(o),!0}return!1},error:function(e){return(0,a.toast)({content:e.message,color:"danger"}),!1}}),!0};var a=o(1)},370:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),s=o(2),n=i(s),r=(i(o(3)),o(1)),l=o(371);function i(e){return e&&e.__esModule?e:{default:e}}var c=r.high.ApproveDetail,u=r.high.ApprovalTrans,p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.openApprove=function(){o.setState({show:!0})},o.turnOff=function(){o.setState({compositedisplay:!1})},o.closeApprove=function(){o.setState({show:!1})},o.state={print_type:"list",show:!1,checkpk:"",compositedisplay:!1,compositedata:{},json:{},inlt:null},o.getAssginUsedr=o.getAssginUsedr.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillMount",value:function(){var e=this;this.props.button.setButtonDisabled({del:!0,commit:!0,callback:!0,lookfun:!0}),this.props.button.setButtonVisible(["unapprove"],!1);this.props.MultiInit.getMultiLang({moduleId:"1012-10120funcpermpf",domainName:"uap",callback:function(t,o,a){o?e.setState({json:t,inlt:a}):console.log("未加载到多语资源")}})}},{key:"handlePageInfoChange",value:function(e,t,o){(0,l.searchBtnClick)(e,o,!1)}},{key:"getTableDate",value:function(e){var t=this,o={pageid:"1012030401",filter:e};(0,r.ajax)({url:"/nccloud/rbac/changeAuth/list.do",data:o,success:function(e){e.success&&e.data?t.props.table.setAllTableData("RolePermissionPF",e.data.RolePermissionPF):t.props.table.setAllTableData("RolePermissionPF",{rows:[]})},error:function(e){t.props.table.setAllTableData("RolePermissionPF",{rows:[]}),(0,r.toast)({content:e.message,color:"danger"})}})}},{key:"onSelectOneEvent",value:function(e,t,o,a,s){this.onSelectedAll(e,t,!0,e.table.getCheckedRows(t).length)}},{key:"onSelectedAll",value:function(e,t,o,a){o&&a>0?this.checkDataInitButtonStatus():e.button.setButtonDisabled({del:!0,commit:!0,callback:!0,lookfun:!0})}},{key:"checkDataInitButtonStatus",value:function(){for(var e=!1,t=!1,o=!1,a=this.props.table.getCheckedRows("RolePermissionPF"),s=0;s<a.length;s++){var n=a[s];e||"-1"==n.data.values.vbillstatus.value||(e=!0),t||"-1"==n.data.values.vbillstatus.value||(t=!0),o||"-1"!=n.data.values.vbillstatus.value||(o=!0)}1==a.length?(this.props.button.setButtonDisabled({lookfun:!1}),this.setState({checkpk:a[0].data.values.pk_roleperm_pf.value})):(this.setState({checkpk:""}),this.props.button.setButtonDisabled({lookfun:!0})),this.props.button.setButtonDisabled({del:e,commit:t,callback:o})}},{key:"onRowDoubleClick",value:function(e,t,o){o.pushTo("/card",{id:e.pk_roleperm_pf.value,status:"browse"})}},{key:"getAssginUsedr",value:function(e){var t=this;this.setState({compositedisplay:!1});var o=this.props.table.getCheckedRows("RolePermissionPF");(0,r.ajax)({url:"/nccloud/rbac/changeAuthority/commit.do",data:{pks:[o[0].data.values.pk_roleperm_pf.value],type:"table",workflow:e},success:function(e){e.success&&e.data.status?((0,r.toast)({color:"success"}),t.props.table.updateDataByIndexs("RolePermissionPF",[{index:o[0].index,data:e.data.result.RolePermissionPF.rows[0]}]),t.props.table.selectAllRows("RolePermissionPF",!1),t.onSelectedAll(t.props,"RolePermissionPF",!0,0)):(0,r.toast)({content:e.data.message,color:"danger"})},error:function(e){(0,r.toast)({content:e.message,color:"danger"})}})}},{key:"render",value:function(){console.log("22222",this);var e=this.props,t=e.button,o=(e.modal,e.ncmodal,e.table),a=(e.syncTree,e.search),s=(t.createButtonApp,a.NCCreateSearch),i=o.createSimpleTable,p=r.base.NCDiv,d=this.props.BillHeadInfo.createBillHeadInfo;return n.default.createElement("div",{className:"nc-single-table"},this.props.modal.createModal("modal"),this.props.ncmodal.createModal("ncmodal"),this.state.compositedisplay?n.default.createElement(u,{title:this.state.json["0007"],data:this.state.compositedata,display:this.state.compositedisplay,getResult:this.getAssginUsedr,cancel:this.turnOff}):"",this.state.show?n.default.createElement(c,{show:this.state.show,close:this.closeApprove,billtype:"10FP",billid:this.state.checkpk}):"",n.default.createElement(p,{areaCode:p.config.HEADER},n.default.createElement("div",{className:"nc-singleTable-header-area"},n.default.createElement("div",{className:"header-title-search-area"},d({title:this.state.json["0001"],initShowBackBtn:!1})),n.default.createElement("div",{className:"header-button-area"},this.props.button.createButtonApp({area:"list",onButtonClick:l.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}),this.props.button.createButtonApp({area:"commit",onButtonClick:l.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}),this.props.button.createButtonApp({area:"print",onButtonClick:l.printevent.bind(this),popContainer:document.querySelector(".header-button-area")})))),n.default.createElement("div",{className:"nc-singleTable-search-area"},s("SearchArea",{showAdvBtn:!0,clickSearchBtn:l.searchBtnClick.bind(this)})),n.default.createElement("div",{className:"nc-singleTable-table-area"},i("RolePermissionPF",{showCheck:!0,showIndex:!0,dataSource:"uap.rbac.changeAuthority.cache",handlePageInfoChange:this.handlePageInfoChange.bind(this),onSelected:this.onSelectOneEvent.bind(this),onSelectedAll:this.onSelectedAll.bind(this),onRowDoubleClick:this.onRowDoubleClick.bind(this)})))}}]),t}(s.Component);p=(0,r.createPage)({initTemplate:l.initTemplate})(p),t.default=p},371:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printevent=t.searchBtnClick=t.initTemplate=t.buttonClick=void 0;var a=l(o(372)),s=l(o(373)),n=l(o(374)),r=l(o(244));function l(e){return e&&e.__esModule?e:{default:e}}t.buttonClick=a.default,t.initTemplate=s.default,t.searchBtnClick=n.default,t.printevent=r.default},372:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o=this;switch(t){case"add":e.pushTo("/card",{status:"add",pagecode:"10120FUNCPERMPF_card",id:""});break;case"commit":s(this,"commit");break;case"callback":s(this);break;case"del":this.props.ncmodal.show("ncmodal",{size:"sm",title:this.state.json["0005"],beSureBtnClick:function(){var t=n(o);t&&null!=t&&r(e,t.pks,"/nccloud/rbac/changeAuth/del.do",o)}});break;case"lookfun":this.openApprove()}};var a=o(1);function s(e,t){if("commit"==t)n(e)&&null!=n(e)&&r(e.props,n(e),"/nccloud/rbac/changeAuthority/commit.do",e);else{var o=function(e){for(var t=e.props.table.getCheckedRows("RolePermissionPF"),o=[],a=[],s=0;s<t.length;s++){var n=t[s];"1"==n.data.values.vbillstatus.value?a.push(n.data.values.pk_roleperm_pf.value):"-1"!=n.data.values.vbillstatus.value&&o.push(n.data.values.pk_roleperm_pf.value)}return{backpks:o,unapproves:a}}(e);if(o.backpks&&o.backpks.length>0)r(e.props,{pks:o.backpks},"/nccloud/rbac/changeAuthority/callback.do",e);else{if(!(o.unapproves&&o.unapproves.length>0))return;r(e.props,{pks:o.unapproves},"/nccloud/rbac/changeAuthority/unapprove.do",e)}}}function n(e){var t=e.props.table.getCheckedRows("RolePermissionPF"),o=[];return null==t||t.length<=0?((0,a.toast)({content:this.state.json["0010"],color:"danger"}),null):(t.map((function(e){"-1"==e.data.values.vbillstatus.value&&o.push(e.data.values.pk_roleperm_pf.value)})),{pks:o})}function r(e,t,o,s){(0,a.ajax)({url:o,data:t,success:function(t){if(t.success)if(t.data&&t.data.workflow&&"approveflow"==t.data.workflow)1==s.props.table.getCheckedRows("RolePermissionPF").length?s.setState({compositedata:t.data,compositedisplay:!0}):(0,a.toast)({content:s.state.json["0017"],color:"danger"});else if(t.success&&t.data.status){var o=e.search.getQueryInfo("SearchArea");o.pageInfo=e.table.getTablePageInfo("RolePermissionPF"),o.pageInfo.pageIndex+="",s.getTableDate(o),(0,a.toast)({color:"success"}),e.table.selectAllRows("RolePermissionPF",!1),s.onSelectedAll(s.props,"RolePermissionPF",!0,0)}else(0,a.toast)({content:t.data.message,color:"danger"})}})}},373:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.MultiInit.getMultiLang({moduleId:"rbac-roletemplet",domainName:"uap",callback:function(t,o,r){o?e.createUIDom({pagecode:n},(function(o){if(o){if(o.template){var n=o.template;n.RolePermissionPF.pagination=!0,function(e,t,o){t.RolePermissionPF.items.map((function(o,a){"vbillno"==o.attrcode&&(o.renderStatus="browse",o.render=function(t,o,a){return React.createElement("a",{style:{textDecoration:"underline",cursor:"pointer"},onClick:function(){e.pushTo("/card",{status:"browse",pagecode:"10120FUNCPERMPF_card",id:o.pk_roleperm_pf.value})}},o.vbillno.value)}),t.RolePermissionPF.items.find((function(e){return"pk_org"==e.attrcode})).queryCondition=function(){return{TreeRefActionExt:"nccloud.web.rbac.authres.sqlbuilder.AuthResOrgPermSqlBuilder"}}})),t.SearchArea.items.map((function(e,o){t.SearchArea.items.find((function(e){return"pk_org"==e.attrcode})).isMultiSelectedEnabled=!0,t.SearchArea.items.find((function(e){return"pk_org"==e.attrcode})).queryCondition=function(){return{TreeRefActionExt:"nccloud.web.rbac.authres.sqlbuilder.AuthResOrgPermSqlBuilder"}}}));var n={label:o["0001"],attrcode:"opr",itemtype:"customer",visible:!0,fixed:"right",render:function(t,n,r){return React.createElement("div",{className:"currency-opr-col"},React.createElement("a",{href:"javaScript:;",style:"-1"==n.vbillstatus.value?{display:"",margin:"0px 5px"}:{display:"none",margin:"0px 5px"},name:"btn_edit",onClick:function(t){e.pushTo("/card",{status:"edit",pagecode:"10120FUNCPERMPF_card",id:n.pk_roleperm_pf.value})}},o["0002"]),React.createElement(s,{trigger:"click",placement:"top",content:o["0004"],onClose:function(){var t=[];t.push(r);var o=[n.pk_roleperm_pf.value];(0,a.ajax)({url:"/nccloud/rbac/changeAuth/del.do",data:o,success:function(o){o.success&&(e.table.deleteCacheId("RolePermissionPF",n.pk_roleperm_pf.value),e.table.deleteTableRowsByIndex("RolePermissionPF",t),(0,a.toast)({color:"success"}))},error:function(e){(0,a.toast)({content:e.message,color:"danger"})}})}},React.createElement("a",{href:"javaScript:;",style:"-1"==n.vbillstatus.value?{display:"",margin:"0px 5px"}:{display:"none",margin:"0px 5px"}},o["0003"])))}};t.RolePermissionPF.items.push(n)}(e,n,t),e.meta.setMeta(n)}if(o.button){var r=o.button;e.button.setButtons(r)}}})):console.log("模板中未加载到多语资源")}})};var a=o(1),s=a.base.NCPopconfirm,n=(a.base.NCIcon,"1012030401")},374:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o){var s=this,n=this,r=e.search.getQueryInfo("SearchArea");r.pageInfo=e.table.getTablePageInfo("RolePermissionPF"),0!=o?r.pageInfo.pageIndex=0:r.pageInfo.pagepks=t;r.pageInfo.pageIndex+="";var l={pageid:"1012030401",filter:r};(0,a.ajax)({url:"/nccloud/rbac/changeAuth/list.do",data:l,success:function(t){t.success&&t.data?(0!=o&&(0,a.toast)({content:n.state.inlt&&n.state.inlt.get("0009",{total:t.data.RolePermissionPF.allpks.length}),color:"success"}),e.table.setAllTableData("RolePermissionPF",t.data.RolePermissionPF)):(0!=o&&(0,a.toast)({content:s.state.json["0008"],color:"warning"}),e.table.setAllTableData("RolePermissionPF",{rows:[]}))},error:function(t){e.table.setAllTableData("RolePermissionPF",{rows:[]}),(0,a.toast)({content:t.message,color:"danger"})}})};var a=o(1)},589:function(e,t,o){"use strict";var a,s,n,r=o(1),l=o(590),i=(a=l)&&a.__esModule?a:{default:a};s=i.default,n="app",(0,r.RenderRouter)(s,n)},590:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s=o(1),n=o(370),r=(a=n)&&a.__esModule?a:{default:a};var l=(0,s.asyncComponent)((function(){return Promise.resolve().then(o.t.bind(null,362,7))})),i=[{path:"/",component:r.default,exact:!0},{path:"/list",component:r.default},{path:"/card",component:l}];t.default=i}})}));
//# sourceMappingURL=index.3a8d23ea.js.map