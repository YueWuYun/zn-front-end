/*! @ncctag {"date":"2020-5-11 23:39:24"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front")):"function"==typeof define&&define.amd?define(["nc-lightapp-front"],t):"object"==typeof exports?exports["uap/rbac/roleGroup/events/index"]=t(require("nc-lightapp-front")):e["uap/rbac/roleGroup/events/index"]=t(e["nc-lightapp-front"])}(window,(function(e){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="../../../../",o(o.s=449)}({1:function(t,o){t.exports=e},449:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.beforeEvent=t.headerButtonClick=t.initTemplate=void 0;var r=o(450),n=o(453);t.initTemplate=n.initTemplate,t.headerButtonClick=r.headerButtonClick,t.beforeEvent=r.beforeEvent},450:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.beforeEvent=t.headerButtonClick=void 0;var r=a(o(451)),n=a(o(452));function a(e){return e&&e.__esModule?e:{default:e}}t.headerButtonClick=r.default,t.beforeEvent=n.default},451:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var o,n=e,a=e.syncTree.getSelectNode("tree1"),u="",s="",i=this;switch(t){case"add":this.pageType="add",o=i,(0,r.ajax)({url:"/nccloud/rbac/get/getLoginInfo.do",data:{state:"rolegroup"},async:!1,success:function(e){e.success&&e.data&&o.props.form.setAllFormValue({rolegroup:e.data.rolegroup})}}),null!=a&&(u=a.refpk,setTimeout((function(){if("adminRootPK"==u||"busiRootPK"==u||"rolegroup"==u?u="":s=a.refname,""!==s){var t=s.split(" ");s=t[1]}e.form.setFormItemsValue("rolegroup",{parent_code:{value:u,display:s},group_type:{value:a.nodeData.group_type}})}),1),e.form.setFormItemsDisabled("rolegroup",{group_type:!0})),e.button.setButtonVisible({add:!1,edit:!1,del:!1,save:!0,cancel:!0}),e.form.setFormStatus("rolegroup","edit"),e.syncTree.setNodeDisable("tree1",!0);break;case"save":if(e.form.isCheckNow("rolegroup")){var c=e.form.getAllFormValue("rolegroup"),l="/nccloud/rabc/roleGroup/save.do";"edit"===this.pageType&&(l="/nccloud/rabc/roleGroup/update.do"),(0,r.ajax)({loading:!0,url:l,data:{data:c},success:function(e){e.success&&(n.syncTree.setNodeDisable("tree1",!1),n.form.setFormStatus("rolegroup","browse"),"edit"==i.pageType?function(e,t){var o={pid:e.pid,refcode:e.refcode,refname:e.refname,refpk:e.refpk,values:e.values,nodeData:e.nodeData};t.syncTree.editNodeSuccess("tree1",o)}(e.data[0],n):"add"==i.pageType&&p(e.data[0],n),i.getFormData(e.data[0].refpk),i.props.syncTree.setNodeSelected("tree1",e.data[0].refpk),n.button.setButtonVisible({add:!0,edit:!0,del:!0,save:!1,cancel:!1}),(0,r.toast)({color:"success"}))},error:function(e){(0,r.toast)({content:e.message,color:"danger"})}})}break;case"edit":this.pageType="edit",null!=a&&("adminRootPK"==(u=a.pid)||"busiRootPK"==u?(u="",s=""):s=i.props.syncTree.getSyncTreeValue("tree1",a.pid).refname,this.props.form.setFormItemsValue("rolegroup",{parent_code:{value:u,display:s}}),e.form.setFormItemsDisabled("rolegroup",{group_type:!0}),e.button.setButtonVisible({add:!1,edit:!1,del:!1,save:!0,cancel:!0}),e.syncTree.setNodeDisable("tree1",!0),e.form.setFormStatus("rolegroup","edit"));break;case"del":var d=i.props.syncTree.getSelectNode("tree1");d&&d.refpk?n.ncmodal.show("ncmodal",{size:"sm",title:this.state.json["0002"],beSureBtnClick:function(){(0,r.ajax)({loading:!0,url:"/nccloud/rabc/roleGroup/delete.do",data:d.refpk,success:function(e){e.success&&(i.props.syncTree.delNodeSuceess("tree1",d.refpk),i.props.syncTree.cancelSelectedNode("tree1"),i.props.form.EmptyAllFormValue("rolegroup"),i.props.button.setButtonsVisible({edit:!1,del:!1}),(0,r.toast)({color:"success"}))},error:function(e){(0,r.toast)({content:e.message,color:"danger"})}})}}):(0,r.toast)({content:this.state.json["0004"],color:"danger"});break;case"cancel":n.ncmodal.show("ncmodal",{size:"sm",title:this.state.json["0003"],beSureBtnClick:function(){n.form.setFormStatus("rolegroup","browse"),n.syncTree.setNodeDisable("tree1",!1),a?"adminRootPK"==a.refpk||"busiRootPK"==a.refpk?(i.onSelectEve(null,null,!0),i.props.button.setButtonVisible({add:!0,edit:!1,del:!1,save:!1,cancel:!1})):(i.getFormData(a.refpk),n.button.setButtonVisible({add:!0,edit:!0,del:!0,save:!1,cancel:!1})):(n.form.EmptyAllFormValue("rolegroup"),n.button.setButtonVisible({add:!0,edit:!1,del:!1,save:!1,cancel:!1}))}})}var p=function(e,t){var o={pid:e.pid,refcode:e.refcode,refname:e.refname,refpk:e.refpk,values:e.values,nodeData:e.nodeData};t.syncTree.addNodeSuccess("tree1",o)}};var r=o(1)},452:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o,r,n){if("parent_code"!=o)return!0;var a=n.group_type.value,u=e.meta.getMeta();return u[t].items.map((function(e,o){u[t].items.find((function(e){return"parent_code"==e.attrcode})).isMultiSelectedEnabled=!1,u[t].items.find((function(e){return"parent_code"==e.attrcode})).queryCondition=function(){return{parent_code:n.pk_role_group.value,group_type:a}}})),e.meta.setMeta(u),!0};o(1)},453:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initTemplate=void 0;var r,n=o(454),a=(r=n)&&r.__esModule?r:{default:r};t.initTemplate=a.default},454:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.MultiInit.getMultiLang({moduleId:"rbac-roletemplet",domainName:"uap",callback:function(t,o,r){o?e.createUIDom({pagecode:n},(function(o){if(o){if(o.template){var r=o.template;!function(e,t,o){t.rolegroup.items.map((function(e,r){t.rolegroup.items.find((function(e){return"pk_org"==e.attrcode})).queryCondition=function(){return{TreeRefActionExt:"nccloud.web.rbac.authres.sqlbuilder.AuthResOrgPermSqlBuilder"}},t.rolegroup.items.find((function(e){return"parent_code"==e.attrcode})).unitProps={placeholder:o["0006"],rootNode:{refname:o["0006"],refpk:"root"},refType:"tree",refName:o["0006"],refCode:"uapbd.org.BusinessUnitAndGroupTreeRef",queryTreeUrl:"/nccloud/uapbd/ref/BusinessUnitAndGroupTreeRef.do",treeConfig:{name:[o["0007"],o["0008"]],code:["refcode","refname"]},isMultiSelectedEnabled:!1},t.rolegroup.items.find((function(e){return"parent_code"==e.attrcode})).isShowUnit=!0}))}(0,r,t),e.meta.setMeta(r)}if(o.button){var n=o.button;e.button.setButtons(n)}}})):console.log("未加载到多语资源")}})};var r=o(1),n="1012030101";r.base.NCButton,r.base.NCPopconfirm,r.base.NCIcon}})}));
//# sourceMappingURL=index.3a8d23ea.js.map