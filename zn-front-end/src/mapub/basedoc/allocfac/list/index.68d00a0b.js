/*! @ncctag {"project":"","branch":"","provider":"","date":"2020-5-12 11:46:26"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["mapub/basedoc/allocfac/list/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["mapub/basedoc/allocfac/list/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,a){return function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=416)}({1:function(t,a){t.exports=e},181:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(1),n=a(72);o.cardCache.setDefData,o.cardCache.getDefData;t.default=function(e,t,a,r,c,l,s){switch(t){case"Edit":e.pushTo("/card",{status:"edit",id:r.callocfacid.value});break;case"Delete_inner":var u=[];u.push({pk_bill:r[n.pkname].value,ts:r.ts.value,index:c,pageId:e.getSearchParam("p")}),(0,o.ajax)({url:"/nccloud/mapub/allocfac/allocfacDeleteAction.do",data:u,success:function(t){if(t){var a=t.success,u=t.data;a&&u&&(u.singlemessage?(0,o.toast)({duration:"infinity",color:u.PopupWindowStyle,content:u.singlemessage}):(e.table.deleteCacheId(l,r[n.pkname].value),e.table.deleteTableRowsByIndex(l,c),(0,o.toast)({color:"success",content:s.state.json["38100112-000004"]})))}}});break;case"Copy":e.pushTo("/card",{status:"edit",id:r.callocfacid.value,copyFlag:"copy"})}}},4:function(e,a){e.exports=t},416:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},n=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),r=a(4),c=i(r),l=(i(a(57)),a(1)),s=a(417),u=a(72);function i(e){return e&&e.__esModule?e:{default:e}}var d=l.base.NCDiv,p=(l.cardCache.setDefData,l.cardCache.getDefData,l.high.ExcelImport),f=(l.high.NCUploader,l.high.PrintOutput,function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initShow=function(){a.props.table.hasCacheData(u.dataSource)||a.onSelected()},a.onSelected=function(){a.onListButtonControl(a)},a.onListButtonControl=function(e){var t=e.props.table.getCheckedRows(e.tableId);1==t.length?e.props.button.setButtonDisabled(u.buttons,!1):t.length>1?e.props.button.setButtonDisabled(u.buttons,!1):e.props.button.setButtonDisabled(u.buttons,!0)},a.selectedChange=function(e,t){var o=a.props.table.getCheckedRows(a.tableId);o&&o.length>0?a.props.button.setDisabled(u.buttons,!1):a.props.button.setDisabled(u.buttons,!0)},a.moduleId="2002",a.searchId="search_area",a.tableId="list_area",a.pagecode=u.pagecode,a.state={querydata:"",pk_reconcilerule:"",json:{},inlt:null},a.Info={allButtonsKey:[],selectedPKS:null,vbillcode:null,pk_bill:null},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){var e=this;(0,l.getMultiLang)({moduleId:"38100112",domainName:"mapub",currentLocale:"zh-CN",callback:function(t,a,o){e.setState({json:t,inlt:o},(function(){s.initTemplate.call(e,e.props,e.initShow)}))}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.table,n=(t.button,t.search),r=t.modal,l=a.createSimpleTable,i=n.NCCreateSearch,f=r.createModal,b=this.props.BillHeadInfo.createBillHeadInfo;return c.default.createElement("div",{className:"nc-bill-list"},c.default.createElement(d,{areaCode:d.config.HEADER},c.default.createElement("div",{className:"nc-bill-header-area"},c.default.createElement("div",{className:"header-title-search-area"},b({title:this.state.json["38100112-000005"],initShowBackBtn:!1})),c.default.createElement("div",{className:"header-button-area"},this.props.button.createButtonApp({area:"head",buttonLimit:4,onButtonClick:s.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")})))),c.default.createElement("div",{className:"nc-bill-search-area"},i(this.searchId,{clickSearchBtn:s.searchBtnClick.bind(this),defaultConditionsNum:6})),c.default.createElement("div",{className:"nc-bill-table-area"},l(this.tableId,{tableModelConfirm:s.tableModelConfirm,showCheck:!0,showIndex:!0,dataSource:u.dataSource,pkname:u.pkname,selectedChange:this.selectedChange.bind(this),onRowDoubleClick:s.doubleClick.bind(this),componentInitFinished:function(){e.onSelected()}})),f("importModal",{noFooter:!0,className:"import-modal",hasBackDrop:!1}),c.default.createElement(p,o({},Object.assign(this.props),{moduleName:"mapub",billType:"allocfac",pagecode:u.importPageId,appcode:this.props.getSearchParam("c"),selectedPKS:this.Info.selectedPKS})))}}]),t}(r.Component));f=(0,l.createPage)({})(f),t.default=f},417:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableButtonClick=t.doubleClick=t.buttonClick=t.initTemplate=t.searchBtnClick=void 0;var o=s(a(418)),n=s(a(419)),r=s(a(420)),c=s(a(421)),l=s(a(181));function s(e){return e&&e.__esModule?e:{default:e}}t.searchBtnClick=o.default,t.initTemplate=n.default,t.buttonClick=r.default,t.doubleClick=c.default,t.tableButtonClick=l.default},418:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=this,c=e.search.getQueryInfo(n.searchId);if(!c)return;var l={queryInfo:c,pageCode:n.pagecode};this.state.querydata=l,r(n.searchId,n.dataSource,c),(0,o.ajax)({url:"/nccloud/mapub/allocfac/allocfacQueryAction.do",data:l,success:function(e){var t=e.success,c=e.data;t&&(c?(a.props.table.setAllTableData(n.tableId,c[n.tableId]),r(n.tableId,n.dataSource,c),(0,o.toast)({color:"success",content:a.state.inlt&&a.state.inlt.get("38100112-000015",{count:c[n.tableId].rows.length})})):(a.props.table.setAllTableData(n.tableId,{rows:[]}),(0,o.toast)({color:"warning",content:a.state.json["38100112-000016"]})))}})};var o=a(1),n=a(72),r=o.cardCache.setDefData;o.cardCache.getDefData},419:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=this,o=(0,n.excelImportconfig)(e,"mapub","allocfac",!0,"",{appcode:r.appcode,pagecode:r.importPageId});e.createUIDom({pagecode:r.pagecode,appcode:e.getSearchParam("c")},(function(t){if(t){if(t.template){var n=t.template;n=function(e,t,a){return t[r.searchId].items=t[r.searchId].items.map((function(e,t){return e.isShowDisabledData=!0,e.isHasDisabledData=!0,"pk_org"==e.attrcode&&(e.queryCondition=function(){return{AppCode:a.props.getSearchParam("c"),isDataPowerEnable:"Y",TreeRefActionExt:"nccloud.web.refer.sqlbuilder.PrimaryOrgSQLBuilder"}}),e})),t[r.tableId].items=t[r.tableId].items.map((function(t,a){return"vcode"==t.attrcode&&(t.render=function(t,a,o){return React.createElement("a",{style:{cursor:"pointer"},onClick:function(){e.pushTo("/card",{status:"browse",id:a.callocfacid.value})}},a.vcode&&a.vcode.value)}),t})),t[r.tableId].items.push({attrcode:"opr",label:a.state.json["38100112-000003"],fixed:"right",itemtype:"customer",visible:!0,className:"table-opr",width:"160px",render:function(t,o,n){return e.button.createOprationButton(["Edit","Delete_inner","Copy"],{area:"list",buttonLimit:3,onButtonClick:function(e,c){return(0,l.default)(e,c,t,o,n,r.tableId,a)}})}}),e.button.setButtonDisabled(r.buttons,!0),t}(e,n,a),e.meta.setMeta(n)}if(t.button){var c=t.button;e.button.setButtons(c),e.button.setPopContent("Delete_inner",a.state.json["38100112-000011"]),e.button.setUploadConfig("ImportData",o)}}})),t&&t()};var o,n=a(1),r=a(72),c=a(181),l=(o=c)&&o.__esModule?o:{default:o}},420:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=this;switch(t){case"Add":e.pushTo("/card",{status:"add"});break;case"Delete":!function(e){var t=e.props.table.getCheckedRows(n.tableId),a=[];if(t.forEach((function(t){a.push({pk_bill:t.data.values[n.pkname].value,ts:t.data.values.ts.value,index:t.index,pageId:e.props.getSearchParam("p")})})),0==a.length)return void(0,o.toast)({content:""+e.state.json["38100112-000021"],color:"warning"});(0,o.promptBox)({color:"warning",title:e.state.json["38100112-000013"],content:e.state.json["38100112-000022"],beSureBtnClick:function(){(0,o.ajax)({url:"/nccloud/mapub/allocfac/allocfacDeleteAction.do",data:a,success:function(t){var a=t.success,r=t.data;a&&r&&(r.message&&(0,o.toast)({duration:"infinity",color:r.PopupWindowStyle,content:r.message}),r.successIndexs&&e.props.table.deleteTableRowsByIndex(n.tableId,r.successIndexs),r.successPKs&&e.props.table.deleteCacheId(n.tableId,r.successPKs),e.props.button.setDisabled(["Delete"],!0))}})}})}(this);break;case"Refresh":var l=c(n.searchId,n.dataSource);if(l){var s={queryInfo:l,pageCode:n.pagecode};this.state.querydata=s,(0,o.ajax)({url:"/nccloud/mapub/allocfac/allocfacQueryAction.do",data:s,success:function(e){var t=e.success,c=e.data;t&&(c?(a.props.table.setAllTableData(n.tableId,c[n.tableId]),r(n.tableId,n.dataSource,c)):a.props.table.setAllTableData(n.tableId,{rows:[]})),(0,o.toast)({color:"success",content:a.state.json["38100112-000012"]})}})}else(0,o.toast)({color:"success",title:this.state.json["38100112-000012"]}),e.table.setAllTableData(n.tableId,{rows:[]});break;case"Print":var u=e.table.getCheckedRows(n.tableId),i=[];if(u.forEach((function(e,t){var a=e.data.values[n.pkname];i.push(a.value)})),0==i.length)return void(0,o.toast)({content:that.state.json["38100112-000023"]+"，"+that.state.json["38100112-000024"]+"！",color:"warning"});(0,o.print)("pdf","/nccloud/mapub/allocfac/allocfacPrintAction.do",{billtype:n.billtype,funcode:n.funcode,nodekey:n.nodekey,oids:i});break;case"OutPut":var d=e.table.getCheckedRows(n.tableId),p=[];if(d.forEach((function(e,t){var a=e.data.values[n.pkname];p.push(a.value)})),0==p.length)return void(0,o.toast)({content:that.state.json["38100112-000023"]+"，"+that.state.json["38100112-000024"]+"！",color:"warning"});(0,o.output)({url:"/nccloud/mapub/allocfac/allocfacPrintOutputAction.do",data:{outputType:"output",funcode:n.funcode,nodekey:n.nodekey,oids:p}});break;case"ImportData":break;case"ExportData":var f=e.table.getCheckedRows(n.tableId);if(0==f.length)return void(0,o.toast)({color:"warning",content:this.state.json["38100112-000025"]});var b=[];f.forEach((function(e){b.push(e.data.values[n.pkname].value)})),this.Info.selectedPKS=b,this.props.modal.show("exportFileModal")}};var o=a(1),n=a(72),r=(o.base.NCMessage,o.cardCache.setDefData),c=o.cardCache.getDefData;o.cardCache.deleteCacheById},421:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o){this.props.pushTo("/card",{status:"browse",id:e.callocfacid.value})};a(1)},57:function(e,t){e.exports=a},72:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttons=t.importPageId=t.billtype=t.nodekey=t.funcode=t.appcode=t.pagecode=t.tableId=t.searchId=t.pkname=t.dataSource=void 0;a(1),t.dataSource="mapub.basedoc.allocfac.38100112",t.pkname="callocfacid",t.searchId="search_area",t.tableId="list_area",t.pagecode="38100112_list",t.appcode="38100112",t.funcode="38100112",t.nodekey="38100112",t.billtype="38100112",t.importPageId="38100112_import",t.buttons=["Delete","Print","OutPut","ExportData"]}})}));
//# sourceMappingURL=index.68d00a0b.js.map