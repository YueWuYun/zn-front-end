/*! @ncctag {"project":"","branch":"","provider":"","date":"2020-5-11 14:48:12"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uapbd/material/batchupdaterule_grp/list/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uapbd/material/batchupdaterule_grp/list/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="../../../../",n(n.s=251)}({1:function(t,n){t.exports=e},149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conf=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return React.createElement(s,o({},i,e))};var r=n(1),a=n(3),s=r.high.Refer;a.conf.fieldid="group";var i=t.conf={multiLang:{domainName:"uapbd",currentLocale:"zh-CN",moduleId:"refer_uapbd"},refType:"tree",refName:"refer-000201",refCode:"uapbd.refer.org.BusinessUnitTreeRef",rootNode:{refname:"refer-000201",refpk:"root"},placeholder:"refer-000201",queryTreeUrl:"/nccloud/uapbd/org/BusinessUnitTreeRef.do",treeConfig:{name:["refer-000002","refer-000003"],code:["refcode","refname"]},isMultiSelectedEnabled:!1,unitProps:a.conf,isShowUnit:!1}},2:function(e,n){e.exports=t},205:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(2),i=l(s),u=(l(n(4)),n(1)),c=l(n(149));function l(e){return e&&e.__esModule?e:{default:e}}var p=u.base.NCDiv,f={},d="/nccloud/uapbd/batchupdaterule/queryBatchUpdateRuleTeamList.do",b="/nccloud/uapbd/batchupdaterule/delBatchUpdateRuleTeam.do",h="/nccloud/uapbd/batchupdaterule/executeBatchUpRuleTeam.do",g=function(e,t,n){e.createUIDom({pagecode:f.pagecode},(function(o){o.button&&e.button.setButtons(o.button),o.button&&e.button.setPopContent(["DeleteLine"],e.MutiInit.getIntl("10140BURG")&&e.MutiInit.getIntl("10140BURG").get("10140BURG-000000"));var r=o.template;r=t(r),e.meta.setMeta(r),setTimeout((function(){n()}),0)}))},m=(o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.call(n),n.config=e.config,f=n.config.pagecodeValues,n.state={BusinessUnit:{},json:{}},g(n.props,n.modifierMeta,(function(){n.getlistData(!1,!1)})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"componentWillMount",value:function(){var e=this;(0,u.getMultiLang)({moduleId:"10140BURG",domainName:"uapbd",callback:function(t){console.log(e.state.json),e.setState({json:t})}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.button,o=t.table,r=t.BillHeadInfo.createBillHeadInfo,a=o.createSimpleTable,s=n.createButtonApp;return i.default.createElement("div",{className:"nc-bill-list"},i.default.createElement(p,{className:"nc-bill-header-area",areaCode:p.config.HEADER},i.default.createElement("div",{className:"header-title-search-area"},r({title:this.state.json["10140BURG-000011"],initShowBackBtn:!1})),i.default.createElement("div",{className:"title-search-detail"},"ORG_NODE"===this.props.config.node_type&&i.default.createElement(c.default,{value:this.state.BusinessUnit,fieldid:"BusinessUnitTreeRef",onChange:this.BusinessUnitChange})),i.default.createElement("div",{className:"header-button-area"},s({area:"list_head",buttonLimit:3,onButtonClick:this.onButtonClick,popContainer:document.querySelector(".header-button-area")}))),i.default.createElement("div",{className:"nc-bill-table-area"},a("list",{dataSource:this.config.datasource,showCheck:!0,showIndex:!0,onRowDoubleClick:this.onRowDoubleClick,selectedChange:function(){e.updateButton()},onSelectedAll:function(){e.updateButton()},onSelected:function(){e.updateButton()}})))}}]),t}(s.Component),r=function(){var e=this;this.modifierMeta=function(t){var n={attrcode:"opr",key:"opr",label:e.state.json["10140BURG-000001"],visible:!0,className:"table-opr",width:200,itemtype:"customer",fixed:"right",render:function(t,n,o){return e.props.button.createOprationButton(["EditLine","DeleteLine"],{area:"list_line",buttonLimit:3,onButtonClick:function(t,r){switch(r){case"DeleteLine":if("ORG_NODE"===e.props.config.node_type&&n.pk_org.value!==e.state.BusinessUnit.refpk)return void(0,u.toast)({content:e.state.json["10140BURG-000046"],color:"danger",title:e.state.json["10140BURG-000005"]});(0,u.ajax)({url:b,data:{pk:n.pk_batchupruleteam.value,ts:n.ts.value},success:function(t){var n=t.success;n&&(e.props.table.deleteTableRowsByIndex("list",o),(0,u.toast)({title:e.state.json["10140BURG-000002"],color:"success"}))}});break;case"EditLine":if("ORG_NODE"===e.props.config.node_type&&n.pk_org.value!==e.state.BusinessUnit.refpk)return void(0,u.toast)({content:e.state.json["10140BURG-000046"],color:"danger",title:e.state.json["10140BURG-000005"]});t.pushTo("/card",{status:"edit",pagecode:e.props.config.pagecodecard,id:n.pk_batchupruleteam.value,refcode:e.state.BusinessUnit.refcode,refname:e.state.BusinessUnit.refname,refpk:e.state.BusinessUnit.refpk})}}})}};return t.list.items.push(n),t},this.getlistData=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,u.ajax)({url:d,data:{pagecode:f.pagecode,node_type:e.props.config.node_type,pk_org:e.state.BusinessUnit.refpk},success:function(o){var r=o.data,a=o.success;if(a&&r&&r.list&&(e.props.table.setAllTableData("list",r.list),n))if(t)(0,u.toast)({color:"success",title:e.state.json["10140BURG-000003"]});else{var s=r.list.rows?r.list.rows.length:0;0===s?(0,u.toast)({content:e.state.json["10140BURG-000004"],color:"warning",title:e.state.json["10140BURG-000005"]}):(0,u.toast)({content:e.state.json["10140BURG-000008"]+"，"+e.state.json["10140BURG-000009"]+s+e.state.json["10140BURG-000010"]+"。",color:"success",title:e.state.json["10140BURG-000006"]})}e.updateButton()}})},this.updateButton=function(){var t=e.props.table.getCheckedRows("list"),n=t&&t.length>0?t.length:0,o=!1;if("ORG_NODE"!==e.props.config.node_type||e.state.BusinessUnit&&e.state.BusinessUnit.refpk||(o=!0),0===n)e.props.button.setDisabled({execute:!0,ruleTeamAdd:o,ruleTeamDel:!0,listRefresh:!1});else if(1===n){var r=t[0].data.values.pk_org.value;e.props.button.setDisabled({execute:!("ORG_NODE"===e.props.config.node_type&&r===e.state.BusinessUnit.refpk||"GROUP_NODE"===e.props.config.node_type),ruleTeamAdd:o,ruleTeamDel:!("ORG_NODE"===e.props.config.node_type&&r===e.state.BusinessUnit.refpk||"GROUP_NODE"===e.props.config.node_type),listRefresh:!1})}else n>1&&e.props.button.setDisabled({execute:!0,ruleTeamAdd:o,ruleTeamDel:!0,listRefresh:!1})},this.onButtonClick=function(t,n){switch(n){case"execute":var o=e.props.table.getCheckedRows("list");if(!o||0===o.length)return;var r=o[0].data.values.pk_batchupruleteam,a=o[0].data.values.ts;(0,u.ajax)({url:h,data:{pk:r.value,ts:a.value},success:function(t){var n=t.success;n&&(0,u.toast)({title:e.state.json["10140BURG-000007"],color:"success"})}});break;case"ruleTeamAdd":e.props.pushTo("/card",{status:"add",pagecode:e.props.config.pagecodecard,refcode:e.state.BusinessUnit.refcode,refname:e.state.BusinessUnit.refname,refpk:e.state.BusinessUnit.refpk});break;case"ruleTeamDel":if(!(o=e.props.table.getCheckedRows("list"))||0===o.length)return;r=o[0].data.values.pk_batchupruleteam,a=o[0].data.values.ts;var s=o[0].data.rowId;(0,u.ajax)({url:b,data:{pk:r.value,ts:a.value},success:function(t){var n=t.success;n&&(e.props.table.deleteTableRowsByRowId("list",s),(0,u.toast)({title:e.state.json["10140BURG-000002"],color:"success"}))}});break;case"listRefresh":e.getlistData(!0)}},this.BusinessUnitChange=function(t){e.setState({BusinessUnit:t},(function(){e.updateButton(),t&&t.refpk&&e.getlistData()}))},this.onRowDoubleClick=function(t,n){e.props.pushTo("/card",{status:"browse",pagecode:e.props.config.pagecodecard,id:t.pk_batchupruleteam.value,refcode:e.state.BusinessUnit.refcode,refname:e.state.BusinessUnit.refname,refpk:e.state.BusinessUnit.refpk})}},o);m=(0,u.createPage)({initTemplate:function(){}})(m),t.default=m},251:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(2),a=i(r),s=(i(n(4)),i(n(205)));function i(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(){return a.default.createElement(s.default,{config:{title:"批改规则",node_type:"GROUP_NODE",appid:"0001Z0100000000019GO",pagecode:"10140BURG_LIST",pagecodecard:"10140BURG_CARD",appcode:"10140BURG",datasource:"uapbd.material.batchpdaterule.grp",pagecodeValues:{pagecode:"10140BURG_LIST"}}})}}]),t}(r.Component);t.default=u},3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conf=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return React.createElement(r,o({},a,e))};var r=n(1).high.Refer,a=t.conf={multiLang:{domainName:"uap",currentLocale:"zh-CN",moduleId:"uapRefer"},queryTreeUrl:"/nccloud/riart/ref/groupRefTreeAction.do",refType:"tree",placeholder:"1880000025-000061",refName:"1880000025-000061",rootNode:{refname:"1880000025-000061",refpk:"root"}}},4:function(e,t){e.exports=n}})}));
//# sourceMappingURL=index.252a21fd.js.map