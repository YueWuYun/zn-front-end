/*! @ncctag {"project":"","branch":"","provider":"","date":"2020-5-11 14:50:39"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uapbd/mmbase/wk0104/main/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uapbd/mmbase/wk0104/main/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,a){return function(e){var t={};function a(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(o,r,function(t){return e[t]}.bind(null,r));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=215)}({1:function(t,a){t.exports=e},141:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLangByResId=t.initLang=void 0;var o=a(1);t.initLang=function(e,t,a,r){e.lang=null,e.inlt=null,(0,o.getMultiLang)({moduleId:t,domainName:a,callback:function(t,a,o){a&&(e.lang=t,e.inlt=o),r&&r()},needInlt:!0})},t.getLangByResId=function(e,t,a){return function(e,t){if(!e)throw(0,o.toast)({color:"danger",content:"请检查代码中this是否能够取到！当前为undifined,位置："+t}),new Error("请检查代码中this是否能够取到！当前为undifined,位置："+t)}(e,t),a?e.inlt?e.inlt.get(t,a)||t:"":e.lang?e.lang[t]||t:""}},156:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conf=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return React.createElement(s,o({},i,e))};var r=a(1),n=a(4),s=r.high.Refer;n.conf.fieldid="group";var i=t.conf={multiLang:{domainName:"uapbd",currentLocale:"zh-CN",moduleId:"refer_uapbd"},refType:"tree",refName:"refer-000201",refCode:"uapbd.refer.org.BusinessUnitTreeRef",rootNode:{refname:"refer-000201",refpk:"root"},placeholder:"refer-000201",queryTreeUrl:"/nccloud/uapbd/org/BusinessUnitTreeRef.do",treeConfig:{name:["refer-000002","refer-000003"],code:["refcode","refname"]},isMultiSelectedEnabled:!1,unitProps:n.conf,isShowUnit:!1}},186:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),i=a(2),l=c(i),u=(c(a(3)),a(1));a(141);function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p=u.base.NCAffix,f=(u.base.NCPopconfirm,u.base.NCFormControl,u.base.NCBackBtn,u.high.PrintOutput),m=u.cardCache.addCache,h=u.cardCache.getCacheById,g=u.cardCache.updateCache,b=u.cardCache.getCurrentLastId,v=u.cardCache.getNextId,k=u.cardCache.deleteCacheById,y="mmbd.wk.wk0104.data",w="wk_card",C="10140WK_card",I="/nccloud/mmbd/pub/queryOrgVid.do",_="/nccloud/mmbd/wk/save.do",S="/nccloud/mmbd/wk/updatesave.do",E="/nccloud/mmbd/wk/print.do",B=(o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.call(a),a.formId=w,a.old_pk_org="",a.state={pk_org:null,totalcount:0,applycount:0,backVisible:!0,json:{}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"modifierMeta",value:function(e,t){var a=e.getUrlParam("status");return t[w].status=a,"add"!=a?e.form.setFormItemsDisabled(w,{pk_org:!0,vwkcode:!0}):(this.setItemDisabled(!0),e.form.setFormItemsDisabled(w,{pk_org:!1})),t[w].items.map((function(t){"pk_org"==t.attrcode&&(t.queryCondition=function(){return{GridRefActionExt:"nccloud.web.mmbd.refer.pub.AppPermissionOrgRefFilter"}}),"cwkclassid"==t.attrcode&&(t.isDataPowerEnable=!1,t.queryCondition=function(){return{pk_org:e.form.getFormItemsValue(w,"pk_org").value,enablestate:2}}),"cdeptid"==t.attrcode&&(t.isDataPowerEnable=!1,t.queryCondition=function(){return{pk_org:e.form.getFormItemsValue(w,"pk_org").value,busifuncode:"fa"}})})),t}},{key:"setItemDisabled",value:function(e){this.props.form.setFormItemsDisabled(w,{vwkcode:e,vwkname:e,cwkclassid:e,cdeptid:e,vnote:e})}},{key:"componentDidMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"10140WK",domainName:"uapbd",callback:function(t){e.setState({json:t},(function(){e.initTemplate(e.props)}))}});var t=this.props.getUrlParam("status");if("add"!=t){var a=this.props.getUrlParam("id");this.props.cardPagination.setCardPaginationId({id:this.props.getUrlParam("id"),status:0}),a&&"undefined"!=a&&this.getdata(a)}else{var o=this.props.getUrlParam("id");o&&"undefined"!=o?this.handleCopy(o):(this.setDefaultValue(),this.setItemDisabled(!0),this.props.form.setFormItemsDisabled(w,{pk_org:!1}))}"add"!=t&&"edit"!=t||this.setState({backVisible:!1})}},{key:"toggleShow",value:function(e){var t=this.props.getUrlParam("status");"add"==t&&"copy"!=e&&(this.props.form.setFormItemsDisabled(this.formId,{pk_org:!1}),this.setItemDisabled(!!e)),"edit"==t&&(this.setItemDisabled(!1),this.props.form.setFormItemsDisabled(w,{pk_org:!0,vwkcode:!0}));var a=[],o=[];"edit"==t||"add"==t?(o=["Edit","Add","back","Delete","Copy","Refresh","Enable","Disable","Print","Output"],a=["Save","Cancel"],"add"==t?a.push("SaveAdd"):o.push("SaveAdd"),this.props.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1),this.props.form.setFormItemsDisabled(w,{creator:!0,creationtime:!0,modifier:!0,modifiedtime:!0})):(o=["Save","SaveAdd","Cancel"],a=["Add","Edit","Delete","Copy","back","Refresh","Print","Output"],e||(e=this.props.form.getFormItemsValue(this.formId,"enablestate").value),2==e?(o.push("Enable"),a.push("Disable")):3==e&&(o.push("Disable"),a.push("Enable")),this.props.cardPagination.setCardPaginationVisible("cardPaginationBtn",!0)),this.props.button.setButtonVisible(o,!1),this.props.button.setButtonVisible(a,!0),this.props.form.setFormStatus(w,t),window.onbeforeunload="add"!=t&&"edit"!=t?null:function(){return""}}},{key:"changeEnableClick",value:function(){var e=this;(0,u.ajax)({url:"/nccloud/mmbd/wk/changeable.do",data:{id:this.props.getUrlParam("id")},success:function(t){e.getdata(e.props.getUrlParam("id"),(function(t){2==t?(0,u.toast)({color:"success",title:e.state.json["10140WK-000020"]}):(0,u.toast)({color:"success",title:e.state.json["10140WK-000021"]})}))}})}},{key:"changeDisableClick",value:function(){var e=this;(0,u.ajax)({url:changeDisableStatus,data:{id:this.props.getUrlParam("id")},success:function(t){e.getdata(e.props.getUrlParam("id"),(function(t){2==t?(0,u.toast)({color:"success",title:e.state.json["10140WK-000020"]}):(0,u.toast)({color:"success",title:e.state.json["10140WK-000021"]})}))}})}},{key:"enable",value:function(){2!=this.props.form.getFormItemsValue(this.formId,"enablestate").value?this.changeEnableClick():(0,u.toast)({color:"warning",content:this.state.json["10140WK-000043"]})}},{key:"disable",value:function(){3!=this.props.form.getFormItemsValue(this.formId,"enablestate").value?this.changeEnableClick():(0,u.toast)({color:"warning",content:this.state.json["10140WK-000044"]})}},{key:"output",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];t.push(this.props.getUrlParam("id")),""!=e&&(0,u.print)("pdf",E,{funcode:"10140WK",nodekey:"wkprintcard",oids:t,outputType:e})}},{key:"cancelSureEvent",value:function(){var e=this;if("add"===this.props.getUrlParam("status")){var t=this.props.getUrlParam("id");t&&"null"!=t||(b(y)?t=b(y):(this.props.form.EmptyAllFormValue(w),this.props.form.setFormItemsValue(w,{enablestate:{value:"",display:""}}),this.props.button.setButtonDisabled(["Edit","Delete","Copy","Refresh","Enable","Disable","Print","Output"],!0))),this.getDataForCache(t,(function(){e.props.pushTo("/card",{status:"browse",id:e.props.getUrlParam("id")}),e.props.form.setFormStatus(e.formId,"browse")}))}"edit"===this.props.getUrlParam("status")&&(this.props.form.cancel(this.formId),this.props.pushTo("/card",{status:"browse",id:this.props.getUrlParam("id")})),this.toggleShow(),this.setState({backVisible:!0})}},{key:"sureChangeOrg",value:function(){var e=this;this.props.form.getFormItemsValue(w,"pk_org")&&this.props.form.getFormItemsValue(w,"pk_org").value&&(0,u.ajax)({url:I,data:{pk_org:this.props.form.getFormItemsValue(w,"pk_org").value},success:function(t){e.props.form.setFormItemsValue(w,{pk_org_v:{value:t.data[e.props.form.getFormItemsValue(w,"pk_org").value]}})}}),this.props.form.setFormItemsValue(w,{vwkcode:{value:"",display:""},vwkname:{value:"",display:""},cwkclassid:{value:"",display:""},"cwkclassid.name":{value:"",display:""},cdeptid:{value:"",display:""},"cdeptid.name":{value:"",display:""},vnote:{value:"",display:""}}),this.setItemDisabled(!1)}},{key:"afterEvent",value:function(e,t,a,o,r){if("pk_org"==a&&o.value!=r.value&&"pk_org"==a){var n=e.meta.getMeta(),s=this.props.form.getFormItemsValue(this.formId,"pk_org").value;n[w].items.map((function(e){"cwkclassid"==e.attrcode&&(e.isDataPowerEnable=!1,e.queryCondition=function(){return{pk_org:s,enablestate:2}})})),r&&r.value?(this.props.modal.show("sureChangeOrg"),this.old_pk_org=r):this.sureChangeOrg(o.value)}}},{key:"render",value:function(){var e=this,t=this.props,a=t.form,o=t.button,r=t.modal,n=t.cardPagination.createCardPagination,s=this.props.BillHeadInfo.createBillHeadInfo,i=a.createForm,u=o.createButtonApp,c=r.createModal;return l.default.createElement("div",{className:"nc-bill-card"},l.default.createElement("div",{className:"nc-bill-top-area"},l.default.createElement(p,null,l.default.createElement("div",{className:"nc-bill-header-area"},l.default.createElement("div",{className:"header-title-search-area"},l.default.createElement("span",null,s({title:this.state.json["10140WK-000029"],backBtnClick:function(){e.buttonClick.call(e,e.props,"Back")}}))),l.default.createElement("div",{className:"header-button-area"},u({area:"header-action",onButtonClick:this.buttonClick.bind(this)}),n({handlePageInfoChange:this.pageInfoClick.bind(this),dataSource:y})))),l.default.createElement("div",{className:"nc-bill-form-area"},i(this.formId,{onAfterEvent:this.afterEvent.bind(this)}))),l.default.createElement(f,{ref:"printOutput",url:E,data:{funcode:"10140WK",nodekey:"wkprint",oids:this.state.pks,outputType:"output"}}),c("sureChangeOrg",{size:"sm",title:this.state.json?this.state.json["10140WK-000010"]:"10140WK-000010",content:this.state.json?this.state.json["10140WK-000011"]:"10140WK-000011",beSureBtnClick:this.sureChangeOrg.bind(this),cancelBtnClick:this.cancelChangeOrg.bind(this)}))}}]),t}(i.Component),r=function(){var e=this;this.initTemplate=function(t){t.createUIDom({pagecode:C},(function(a){if(a){var o=a.template;if(a.template&&(e.modifierMeta(t,o),t.meta.setMeta(o)),a.button){var r=a.button;t.button.setButtons(r)}a.context.pk_org?(e.props.form.setFormItemsValue(w,{pk_org:{value:a.context.pk_org,display:a.context.org_Name}}),e.toggleShow(!1),e.setState({pk_org:{value:a.context.pk_org,display:a.context.org_Name}})):e.toggleShow()}}))},this.setDefaultValue=function(){var t=window.parent.GETBUSINESSINFO();e.props.form.setFormItemsValue(e.formId,{pk_group:{value:t.groupId,display:t.groupName}}),e.props.form.getFormItemsValue(w,"pk_org")&&e.props.form.getFormItemsValue(w,"pk_org").value&&(0,u.ajax)({url:I,data:{pk_org:e.props.form.getFormItemsValue(w,"pk_org").value},success:function(t){e.props.form.setFormItemsValue(w,{pk_org_v:{value:t.data[e.props.form.getFormItemsValue(w,"pk_org").value]}})}})},this.buttonClick=function(t,a){switch(a){case"Add":var o=!0;t.form.EmptyAllFormValue(e.formId),t.pushTo("/card",{status:"add",id:t.getUrlParam("id")}),e.state.pk_org&&(o=!1,e.props.form.setFormItemsValue(w,{pk_org:n({},e.state.pk_org)})),e.setDefaultValue(),e.toggleShow(o),e.setState({backVisible:!1});break;case"Edit":t.pushTo("/card",{status:"edit",id:t.getUrlParam("id")}),e.toggleShow(),e.setState({backVisible:!1});break;case"Delete":(0,u.promptBox)({color:"warning",title:e.state.json["10140WK-000004"],content:e.state.json["10140WK-000005"],noFooter:!1,noCancelBtn:!1,beSureBtnName:e.state.json["10140WK-000006"],cancelBtnName:e.state.json["10140WK-000007"],beSureBtnClick:e.delConfirm.bind(e)});break;case"Copy":t.form.EmptyAllFormValue(e.formId),t.pushTo("/card",{status:"add",id:t.getUrlParam("id")}),e.toggleShow("copy"),e.handleCopy(t.getUrlParam("id")),e.setState({backVisible:!1});break;case"Back":t.pushTo("/list",{});break;case"Save":null==t.form.getFormItemsValue(w,"pk_org_v").value||""==t.form.getFormItemsValue(w,"pk_org_v").value?(0,u.ajax)({url:I,data:{pk_org:e.props.form.getFormItemsValue(w,"pk_org").value},success:function(t){e.props.form.setFormItemsValue(w,{pk_org_v:{value:t.data[e.props.form.getFormItemsValue(w,"pk_org").value]}}),e.saveClick()}}):e.saveClick();break;case"SaveAdd":null==t.form.getFormItemsValue(w,"pk_org_v").value||""==t.form.getFormItemsValue(w,"pk_org_v").value?(0,u.ajax)({url:I,data:{pk_org:e.props.form.getFormItemsValue(w,"pk_org").value},success:function(t){e.props.form.setFormItemsValue(w,{pk_org_v:{value:t.data[e.props.form.getFormItemsValue(w,"pk_org").value]}}),e.saveClick(!0)}}):e.saveClick(!0);break;case"Cancel":(0,u.promptBox)({color:"warning",title:e.state.json["10140WK-000007"],content:e.state.json["10140WK-000009"],noFooter:!1,noCancelBtn:!1,beSureBtnName:e.state.json["10140WK-000006"],cancelBtnName:e.state.json["10140WK-000007"],beSureBtnClick:e.cancelSureEvent.bind(e)});break;case"Refresh":e.getdata(e.props.getUrlParam("id"),(function(){(0,u.toast)({title:e.state.json["10140WK-000043"],color:"success"})}));break;case"Enable":e.enable();break;case"Disable":e.disable();break;case"Print":e.output("print");break;case"Output":var r=[];r.push(e.props.getUrlParam("id")),e.setState({pks:r},(function(){e.refs.printOutput.open()}))}},this.handleCopy=function(t){var a={pk:t};(0,u.ajax)({url:"/nccloud/mmbd/wk/cardquery.do",data:a,success:function(t){if(t.data.head){var a=t.data.head[w].rows[0].values;e.props.form.setFormItemsValue(w,{pk_org:n({},a.pk_org),pk_org_v:n({},a.pk_org_v),pk_group:n({},a.pk_group),vwkcode:{value:"",display:""},vwkname:{value:"",display:""},cwkclassid:n({},a.cwkclassid),"cwkclassid.name":n({},a["cwkclassid.name"]),cdeptid:n({},a.cdeptid),cdeptvid:n({},a.cdeptvid),"cdeptid.name":n({},a["cdeptid.name"]),enablestate:{value:"2",display:e.state.json["10140WK-000002"]},vnote:n({},a.vnote)}),e.props.form.setFormItemsDisabled(e.formId,{pk_org:!0}),e.setItemDisabled(!1)}}})},this.pageInfoClick=function(t,a){e.getDataForCache(a)},this.cancelChangeOrg=function(){var t=e.old_pk_org,a=t.display,o=t.value;e.props.form.setFormItemsValue(w,{pk_org:{display:a,value:o}}),e.setItemDisabled(!1)},this.getdata=function(t,a){var o={pk:t};(0,u.ajax)({url:"/nccloud/mmbd/wk/cardquery.do",data:o,success:function(t){if(t.data.head){var o=t.data.head[e.formId].rows[0].values.enablestate.value;e.props.form.setAllFormValue(d({},e.formId,t.data.head[e.formId])),e.toggleShow(t.data.head[e.formId].rows[0].values.enablestate.value),g("cwkid",t.data.head[w].rows[0].values.cwkid.value,t.data,w,y),a&&"function"==typeof a&&a&&a(o)}t.formulamsg&&t.formulamsg instanceof Array&&t.formulamsg.length>0&&e.props.dealFormulamsg(t.formulamsg,d({},w,"form"))}})},this.saveClick=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.props.createMasterChildData(C,e.formId),o=_;"edit"===e.props.getUrlParam("status")&&(o=S),e.props.validateToSave(a,(function(){(0,u.ajax)({url:o,data:a,success:function(a){var r=null;a.success&&(a.data&&!t?a.data.head&&a.data.head[e.formId]&&(e.props.form.setAllFormValue(d({},e.formId,a.data.head[e.formId])),r=a.data.head[e.formId].rows[0].values.cwkid.value):r=a.data.head[e.formId].rows[0].values.cwkid.value,t?(e.props.form.EmptyAllFormValue(e.formId),e.setDefaultValue(),e.props.form.setFormItemsValue(w,{pk_org:n({},a.data.head[e.formId].rows[0].values.pk_org)}),e.props.form.setFormItemsDisabled(e.formId,{pk_org:!1})):(e.props.pushTo("/card",{status:"browse",id:r}),e.getdata(r),e.setState({backVisible:!0})),o==_?m(r,a.data,e.formId,y):g("cwkid",a.data.head[w].rows[0].values.cwkid.value,a.data,w,y),(0,u.toast)({content:e.state.json["10140WK-000018"],color:"success"}))}})}),{head:w})},this.getDataForCache=function(t,a){if(t&&"null"!=t){var o=h(t,y);o?e.props.form.setAllFormValue(d({},w,o.head[w])):e.getdata(t),e.props.setUrlParam(t),a&&"function"==typeof a&&a.call(e),o&&e.toggleShow(o.head[w].rows[0].values.enablestate.value)}else e.props.pushTo("/list",{})},this.delConfirm=function(){(0,u.ajax)({url:"/nccloud/mmbd/wk/delete.do",data:{param:[{id:e.props.getUrlParam("id"),ts:e.props.form.getFormItemsValue(e.formId,"ts").value}]},success:function(t){if(1==t.data.sucessNum){var a=e.props.getUrlParam("id"),o=v(a,y);k("cwkid",a,y),null!=o?e.getDataForCache(o,(function(){(0,u.toast)({color:"success",title:e.state.json["10140WK-000019"]})})):e.props.pushTo("/list",{})}}})}},o);B=(0,u.createPage)({billinfo:{billtype:"card",pagecode:C,headcode:w},initTemplate:[]})(B),t.default=B},187:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r,n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),i=a(2),l=p(i),u=(p(a(3)),a(1)),c=a(7),d=a(156);function p(e){return e&&e.__esModule?e:{default:e}}u.base.NCPopconfirm,u.base.NCCheckbox,u.base.NCIcon,u.base.NCTabs.NCTabPane;var f=u.high.PrintOutput,m="mmbd.wk.wk0104.data",h="10140WK_list",g="wkquery",b="wklist",v="/nccloud/mmbd/wk/delete.do",k="/nccloud/mmbd/wk/print.do",y=u.cardCache.getDefData,w=u.cardCache.setDefData,C=(o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.call(a),a.searchId=g,a.tableId=b,a.state={isShowOff:!1,pk_org:null,index:-1,pks:[]},a.searchVal=null,a.changeEnableInfo={title:"",content:""},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"modifierMeta",value:function(e,t){var a=this;return t[b].pagination=!0,t[g].items=t[g].items.map((function(e,t){return e.col="3",e})),t[b].items=t[b].items.map((function(t,a){return"vwkcode"==t.attrcode&&(t.render=function(t,a,o){return l.default.createElement("a",{style:{textDecoration:"underline",cursor:"pointer"},onClick:function(t){var o=e.search.getAllSearchData(g);u.cacheTools.set("searchParams",o),t.stopPropagation(),e.table.selectAllRows(b,!1),e.pushTo("/card",{status:"browse",id:a.cwkid.value})}},a&&a.vwkcode&&a.vwkcode.value)},"vwkcode"==t.attrcode&&(t.isSort=!0)),t})),t[b].items.push({itemtype:"customer",attrcode:"opr",label:this.state.json?this.state.json["10140WK-000000"]:"10140WK-000000",width:200,fixed:"right",className:"table-opr",visible:!0,render:function(t,o,r){return e.button.createOprationButton(["Edit","Del","Copy"],{area:"list-inner",buttonLimit:4,onButtonClick:function(e,n){a.onTableButtonClick.bind(a)(e,n,t,o,r)}})}}),t[g].items.forEach((function(e){"cwkclassid"==e.attrcode&&(e.queryCondition=function(){return{pk_org:a.props.search.getSearchValByField(g,"pk_org").value.firstvalue}}),"cdeptid"==e.attrcode&&(e.queryCondition=function(){return{pk_org:a.props.search.getSearchValByField(g,"pk_org").value.firstvalue,busifuncode:"fa"}}),"pk_org"==e.attrcode&&(e.queryCondition=function(){return{GridRefActionExt:"nccloud.web.mmbd.refer.pub.AppPermissionOrgRefFilter"}})})),t}},{key:"componentDidMount",value:function(){var e=this,t=function(t,a,o){a&&e.setState({pubjson:n({},t)})};this.props.MultiInit.getMultiLang({moduleId:"10140WK",domainName:"uapbd",callback:function(t,a,o){a&&e.setState({json:t,inlt:o},(function(){e.initTemplate(e.props)}))}}),this.props.MultiInit.getMultiLang({moduleId:"10140MMPUBMSG",domainName:"uapbd",callback:t}),this.props.MultiInit.getMultiLang({moduleId:"10140mmpubmsg",domainName:"uapbd",callback:t})}},{key:"output",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.props.table.getCheckedRows(b);if(0!=t.length){var a=[],o=!0,r=!1,n=void 0;try{for(var s,i=t[Symbol.iterator]();!(o=(s=i.next()).done);o=!0){var l=s.value;a.push(l.data.values.cwkid.value)}}catch(e){r=!0,n=e}finally{try{!o&&i.return&&i.return()}finally{if(r)throw n}}""!=e&&(0,u.print)("pdf",k,{funcode:"10140WK",nodekey:"wkprint",oids:a,outputType:e})}else(0,u.toast)({color:"warning",content:this.state.json["10140WK-000012"]})}},{key:"clickSearchBtn",value:function(e,t){var a=this;this.searchVal=t,w("searchParams",m,t),this.getData(t,(function(e){e&&e>0?(0,u.toast)({color:"success",content:a.state.inlt&&a.state.inlt.get("10140WK-000042",{count:e})}):(0,u.toast)({color:"warning",content:a.state.json["10140WK-000036"]})}))}},{key:"enable",value:function(){this.changeEnableClick()}},{key:"disable",value:function(){this.changeDisableClick()}},{key:"changeEnableClick",value:function(){var e=this,t=this.props.table.getCheckedRows(b),a=[];t.forEach((function(e){a.push({id:e.data.values.cwkid.value,ts:e.data.values.ts.value})}));var o=this.props.table.getAllTableData(b),r=[];o.rows.forEach((function(e){return r.push(e.values.cwkid.value)})),(0,u.ajax)({url:"/nccloud/mmbd/wk/enable.do",data:{param:a,enablestate:"enable",allids:r},success:function(t){(0,c.showBatchOprMessage)(null,t.data,e.state.pubjson["10140PUBMESSAGE-000031"]),e.props.button.setButtonDisabled(["Delete","Enable","Disable","Print","Output"],!0),e.props.table.setAllTableData(b,t.data.data[b])}})}},{key:"changeDisableClick",value:function(){var e=this,t=this.props.table.getCheckedRows(b),a=[];t.forEach((function(e){a.push({id:e.data.values.cwkid.value,ts:e.data.values.ts.value})}));var o=this.props.table.getAllTableData(b),r=[];o.rows.forEach((function(e){return r.push(e.values.cwkid.value)})),(0,u.ajax)({url:"/nccloud/mmbd/wk/enable.do",data:{param:a,enablestate:"disable",allids:r},success:function(t){(0,c.showBatchOprMessage)(null,t.data,e.state.pubjson["10140PUBMESSAGE-000032"]),e.props.button.setButtonDisabled(["Delete","Enable","Disable","Print","Output"],!0),e.props.table.setAllTableData(b,t.data.data[b])}})}},{key:"buttonClick",value:function(e,t){var a=this;switch(t){case"Add":var o=e.search.getAllSearchData(g);u.cacheTools.set("searchParams",o),e.table.selectAllRows(b,!1),e.pushTo("/card",{status:"add"});break;case"Delete":if(0==this.props.table.getCheckedRows(b).length)return void(0,u.toast)({content:this.state.json["10140WK-000045"],color:"warning"});(0,u.promptBox)({color:"warning",title:this.state.pubjson["10140PUBMESSAGE-000009"],content:this.state.pubjson["10140PUBMESSAGE-000010"],noFooter:!1,noCancelBtn:!1,beSureBtnName:this.state.pubjson["10140PUBMESSAGE-000029"],cancelBtnName:this.state.pubjson["10140PUBMESSAGE-000007"],beSureBtnClick:this.deleteAction.bind(this)});break;case"Refresh":this.refreshAction(e,!0);break;case"Print":this.output("print");break;case"Enable":this.enable();break;case"Disable":this.disable();break;case"Output":var r=[],n=this.props.table.getCheckedRows(b),s=!0,i=!1,l=void 0;try{for(var c,d=n[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var p=c.value;r.push(p.data.values.cwkid.value)}}catch(e){i=!0,l=e}finally{try{!s&&d.return&&d.return()}finally{if(i)throw l}}this.setState({pks:r},(function(){a.refs.printOutput.open()}))}}},{key:"render",value:function(){var e=this.props,t=e.table,a=e.button,o=e.search,r=(e.base,e.modal),n=this.props.button.getButtons();n=n.sort((function(e,t){return t.btnorder-e.btnorder}));var s=t.createSimpleTable,i=o.NCCreateSearch,u=(r.createModal,a.createButtonApp);a.getButtons;return l.default.createElement("div",{className:"nc-bill-list"},l.default.createElement("div",{className:"nc-bill-header-area"},l.default.createElement("div",{className:"header-title-search-area"},l.default.createElement("h2",{className:"title-search-detail"},this.state.json?this.state.json["10140WK-000029"]:"10140WK-000029")),l.default.createElement("div",{className:"header-button-area"},u({area:"header-action",buttonLimit:3,onButtonClick:this.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),l.default.createElement("div",{className:"nc-bill-search-area"},i(this.searchId,{clickSearchBtn:this.clickSearchBtn.bind(this),onAfterEvent:this.onAfterEvent.bind(this)})),l.default.createElement("div",{className:"nc-bill-table-area"},s(this.tableId,{dataSource:m,pkname:"cwkid",tableModelConfirm:this.tableModelConfirm,showCheck:!0,showIndex:!0,onRowDoubleClick:this.doubleClick.bind(this),onSelected:this.onSelected.bind(this),onSelectedAll:this.onSelected.bind(this),handlePageInfoChange:this.pageInfoClick.bind(this),showPagination:!0})),l.default.createElement(f,{ref:"printOutput",url:k,data:{funcode:"10140WK",nodekey:"wkprint",oids:this.state.pks,outputType:"output"}}))}}]),t}(i.Component),r=function(){var e=this;this.initTemplate=function(t){t.createUIDom({pagecode:h},(function(a){if(a){if(a.template){var o=a.template;o=e.modifierMeta(t,o),t.meta.setMeta(o),!y("searchParam",m)||e.props.search.setSearchValue(g,y("searchParam",m))}if(a.button){var r=a.button;t.button.setButtons(r),e.props.button.setButtonDisabled(["Delete","Enable","Disable","Print","Output"],!0)}}}))},this.onTableButtonClick=function(t,a,o,r,n){if("Edit"===a&&(t.table.selectAllRows(b,!1),t.pushTo("/card",{status:"edit",id:r.cwkid.value})),"Del"===a){r.cwkid.value;(0,u.promptBox)({color:"warning",content:e.state.json["10140WK-000031"],beSureBtnClick:function(){(0,u.ajax)({url:v,data:{param:[{id:r.cwkid.value,ts:r.ts.value}]},success:function(a){if(a.success)if(null!=a.data&&a.data.errorMessages.length<=0)(0,u.toast)({color:"success",content:e.state.json["10140WK-000032"]}),e.refreshAction(t);else if(a.data.errorMessages.length>0){var o=a.data.errorMessages[0];(0,u.toast)({color:"warning",content:"删除失败："+o})}}})}})}if("Copy"===a){var s=t.search.getAllSearchData(g);u.cacheTools.set("searchParams",s),t.table.selectAllRows(b,!1),t.pushTo("/card",{status:"add",id:r.cwkid.value})}},this.doubleClick=function(t,a,o,r){e.props.table.selectAllRows(b,!1),e.props.pushTo("/card",{status:"browse",id:t.cwkid.value})},this.onSelected=function(t,a,o,r){var n=e.props.table.getCheckedRows(b);n.length>0?(e.props.button.setButtonDisabled(["Enable","Disable","Delete","Print","Output"],!1),1==n.length?2==n[0].data.values.enablestate.value?(e.props.button.setButtonDisabled("Enable",!0),e.props.button.setButtonDisabled("Disable",!1)):3==n[0].data.values.enablestate.value&&(e.props.button.setButtonDisabled("Enable",!1),e.props.button.setButtonDisabled("Disable",!0)):e.props.button.setButtonDisabled(["Enable","Disable"],!1)):e.props.button.setButtonDisabled(["Delete","Enable","Disable","Print","Output"],!0)},this.refreshAction=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e.props.search.getAllSearchData(g);o&&e.getData(o,(function(t){a&&(e.props.button.setButtonDisabled(["Delete","Enable","Disable","Print","Output"],!0),(0,u.toast)({color:"success",content:e.state.inlt&&e.state.inlt.get("10140WK-000013",{count:t})}))}))},this.onAfterEvent=function(t,a,o,r,n){if("pk_org"===t){var s=e.props.meta.getMeta()[g].items;if(a.length>1||0==a.length){var i=!0,l=!1,u=void 0;try{for(var c,p=s[Symbol.iterator]();!(i=(c=p.next()).done);i=!0){var f=c.value;"cdeptid"==f.attrcode&&(f.isShowUnit=!0,f.unitProps=d.conf)}}catch(e){l=!0,u=e}finally{try{!i&&p.return&&p.return()}finally{if(l)throw u}}}else{var m=!0,h=!1,b=void 0;try{for(var v,k=s[Symbol.iterator]();!(m=(v=k.next()).done);m=!0){var y=v.value;"cdeptid"==y.attrcode&&(y.isShowUnit=!1)}}catch(e){h=!0,b=e}finally{try{!m&&k.return&&k.return()}finally{if(h)throw b}}}e.props.search.setSearchValByField(g,"cdeptid",{value:"",display:""}),e.props.search.setSearchValByField(g,"cwkclassid",{value:"",display:""})}},this.getData=function(t,a){var o=e.props.search.getQueryInfo(g),r=o.oid;console.log(o,"queryInfo");var s=n({},o,{pageInfo:{pageIndex:0,pageSize:10,total:0,totalPage:0},pagecode:h,queryAreaCode:g,oid:r,queryType:"simple"}),i="",l=!0,c=!1,d=void 0;try{for(var p,f=t.conditions[Symbol.iterator]();!(l=(p=f.next()).done);l=!0){var m=p.value;"pk_org"===m.field&&(i=m.field)}}catch(e){c=!0,d=e}finally{try{!l&&f.return&&f.return()}finally{if(c)throw d}}i?(0,u.ajax)({url:"/nccloud/mmbd/wk/query.do",data:s,success:function(t){var o=t.success,r=t.data;if(o){var n=0;if(r){if(r.warning)return void(0,u.toast)({color:"warning",content:r.warning});var s=[];r[b].allpks.forEach((function(e){s.push(e)})),e.props.table.setAllTableData(b,r[b]),u.cacheTools.set("allpks",s),n=s.length}else e.props.button.setButtonDisabled(["Delete","Print","Output","Enable","Disable"],!0),e.props.table.setAllTableData(e.tableId,{rows:[]});a&&a(n)}}}):(0,u.toast)({color:"warning",content:e.state.json["10140WK-000008"]})},this.deleteAction=function(t){var a=e.props.table.getCheckedRows(b),o=[];a.forEach((function(e){o.push({id:e.data.values.cwkid.value,ts:e.data.values.ts.value})})),(0,u.ajax)({url:v,data:{param:o},success:function(a){if(null!=a.data&&a.data.errorMessages.length<=0)(0,u.toast)({color:"success",content:e.state.json["10140WK-000032"]}),e.refreshAction(t);else if(a.data.errorMessages.length>0){var o="";a.data.errorMessages.forEach((function(e){o=o+e+";"})),(0,u.toast)({color:"warning",content:"删除失败："+o})}}})},this.pageInfoClick=function(t,a,o){var r=t.editTable.getTablePageInfo(e.tableId),s=t.search.getAllSearchData(g),i=e.props.search.getQueryInfo(g),l=e.props.meta.getMeta()[g].oid,c=n({},i,{showDisableDataFlag:e.state.checkValue,querycondition:s,pageCode:h,queryAreaCode:g,oid:l,querytype:"simple",pageInfo:r,pagepks:o});(0,u.ajax)({url:"/nccloud/mmbd/wk/queryPage.do",data:c,success:function(e){var a=e.success,o=e.data;a&&(o?t.table.setAllTableData(b,o[b]):t.table.setAllTableData(b,{rows:[]}))}})}},o);C=(0,u.createPage)({initTemplate:[],mutiLangCode:"10140WK"})(C),t.default=C},2:function(e,a){e.exports=t},215:function(e,t,a){"use strict";var o,r,n,s=a(1),i=a(216),l=(o=i)&&o.__esModule?o:{default:o};r=l.default,n="app",(0,s.RenderRouter)(r,n)},216:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,r=a(1),n=a(187),s=(o=n)&&o.__esModule?o:{default:o};var i=(0,r.asyncComponent)((function(){return Promise.resolve().then(a.t.bind(null,186,7))})),l=[{path:"/",component:s.default,exact:!0},{path:"/list",component:s.default},{path:"/card",component:i}];t.default=l},3:function(e,t){e.exports=a},4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.conf=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return React.createElement(r,o({},n,e))};var r=a(1).high.Refer,n=t.conf={multiLang:{domainName:"uap",currentLocale:"zh-CN",moduleId:"uapRefer"},queryTreeUrl:"/nccloud/riart/ref/groupRefTreeAction.do",refType:"tree",placeholder:"1880000025-000061",refName:"1880000025-000061",rootNode:{refname:"1880000025-000061",refpk:"root"}}},7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showWarningDialog=t.showBatchOprMessage=void 0;var o=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),r=a(1);var n=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lang=null,this.inlt=null,console.log("LangContainer初始化"),(0,r.getMultiLang)({moduleId:"10140MMPUBMSG",domainName:"uapbd",callback:this.init.bind(this),needInlt:!0})}return o(e,[{key:"init",value:function(e,t,a){t&&(this.lang=e,this.inlt=a)}},{key:"getLangByResId",value:function(e,t){return t?this.inlt.get(e,t)||e:this.lang&&this.lang[e]||e}}]),e}());function s(e,t,a,o,n,s,i,l,u){(0,r.toast)({duration:a,color:o,title:e,content:t,groupOperation:n,TextArr:s,groupOperationMsg:i,onExpand:l,onClose:u})}function i(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments[3];(0,r.promptBox)({color:o,title:e,content:t,noFooter:a.noFooter,noCancelBtn:a.noCancelBtn,beSureBtnName:a.beSureBtnName,cancelBtnName:a.cancelBtnName,beSureBtnClick:a.beSureBtnClick,cancelBtnClick:a.cancelBtnClick,closeBtnClick:a.closeBtnClick,closeByClickBackDrop:a.closeByClickBackDrop})}t.showBatchOprMessage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.getLangByResId("10140PUBMESSAGE-000003"),t=arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=t.failedNum?t.failedNum:0,l=t.sucessNum;if(0==i)!function(e,t,a){s(e,t,a)}(n.getLangByResId("10140PUBMESSAGE-000018",{0:o}),n.getLangByResId("10140PUBMESSAGE-000022",{0:t.sucessNum}));else if(0==l){e=n.getLangByResId("10140PUBMESSAGE-000019",{0:o});var u=n.getLangByResId("10140PUBMESSAGE-000020",{0:t.failedNum,1:t.failedNum});(0,r.toast)({duration:"infinity",color:"danger",title:e,content:u,groupOperation:!0,TextArr:[n.getLangByResId("10140PUBMESSAGE-000000"),n.getLangByResId("10140PUBMESSAGE-000001"),n.getLangByResId("10140PUBMESSAGE-000002")],groupOperationMsg:t.errorMessages,onExpand:a.onExpand,onClose:a.onClose})}else{e=n.getLangByResId("10140PUBMESSAGE-000019",{0:o});var c=n.getLangByResId("10140PUBMESSAGE-000021",{0:Number(t.sucessNum)+Number(t.failedNum),1:t.sucessNum,2:t.failedNum});(0,r.toast)({duration:"infinity",color:"danger",title:e,content:c,groupOperation:!0,TextArr:[n.getLangByResId("10140PUBMESSAGE-000000"),n.getLangByResId("10140PUBMESSAGE-000001"),n.getLangByResId("10140PUBMESSAGE-000002")],groupOperationMsg:t.errorMessages,onExpand:a.onExpand,onClose:a.onClose})}},t.showWarningDialog=function(e,t){i(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},"warning")}}})}));
//# sourceMappingURL=index.ce6dfbc2.js.map