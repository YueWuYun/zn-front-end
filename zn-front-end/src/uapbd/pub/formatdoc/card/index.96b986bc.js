/*! @ncctag {"project":"","branch":"","provider":"","date":"2020-5-11 15:02:31"} */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],e):"object"==typeof exports?exports["uapbd/pub/formatdoc/card/index"]=e(require("nc-lightapp-front"),require("react"),require("react-dom")):t["uapbd/pub/formatdoc/card/index"]=e(t["nc-lightapp-front"],t.React,t.ReactDOM)}(window,(function(t,e,r){return function(t){var e={};function r(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(o,a,function(e){return t[e]}.bind(null,a));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="../../../../",r(r.s=149)}({1:function(e,r){e.exports=t},133:function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,o=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var a,n=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(n)?t:(a=0===n.indexOf("//")?n:0===n.indexOf("/")?r+n:o+n.replace(/^\.\//,""),"url("+JSON.stringify(a)+")")}))}},149:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,r,o){return r&&t(e.prototype,r),o&&t(e,o),e}}(),a=r(2),n=c(a),s=(c(r(3)),r(1)),i=r(150);function c(t){return t&&t.__esModule?t:{default:t}}r(154);var d=s.base.NCBackBtn,l=(s.cardCache.getCacheById,s.cardCache.updateCache,function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.getData=function(){if(null==r.props.getUrlParam("pk"))return r.props.button.setButtonsVisible({add:!0,editor:!1,del:!1,save:!1,cancel:!0}),void r.props.button.setDisabled({add:!1,editor:!0,del:!0});var t=r,e={pk:r.props.getUrlParam("pk"),pageid:r.props.getUrlParam("pageid")};(0,s.ajax)({url:"/nccloud/uapbd/formatdoc/cardquery.do",data:e,success:function(e){e.success;var r=e.data;"add"==t.status&&addCache("pk_formatdoc",e.data,"formatdocdata",dataSource),e.success&&(t.setButtonStatus(),t.props.form.setAllFormValue({formatdocform:r.formatdocform.formatdocform}),"add"==t.status?(t.props.form.setFormStatus("formatdocform","add"),t.props.editTable.setStatus("formatdoccard","edit")):"browse"==t.status?(t.props.form.setFormStatus("formatdocform","browse"),t.props.editTable.setStatus("formatdoccard","browse")):"edit"==t.status&&(t.props.form.setFormStatus("formatdocform","edit"),t.props.editTable.setStatus("formatdoccard","edit")))}})},r.getData2=function(t,e){var o=r,a={pk:t};(0,s.ajax)({url:"/nccloud/uapbd/formatdoc/cardquery.do",data:a,success:function(t){t.success;var r=t.data;t.success&&(o.setButtonStatus(e),o.props.form.setAllFormValue({formatdocform:r.formatdocform.formatdocform}),o.props.editTable.setTableData("formatdoccard",r&&r.formatdoccard?r.formatdoccard.formatdoccard:{rows:[]}),o.props.form.setFormStatus("formatdocform","browse"),o.props.editTable.setStatus("formatdoccard","browse"))}})},r.setButtonStatus=function(t){r.status=null!=t?t:r.props.getUrlParam("status"),"add"==r.status||"edit"==r.status?r.props.button.setButtonsVisible({add:!1,editor:!1,del:!1,save:!0,cancel:!0,print:!1}):"browse"==r.status&&r.props.button.setButtonsVisible({add:!0,editor:!0,del:!0,save:!1,cancel:!1,print:!0})},r.formId="formatdocform",r.tableId="formatdoccard",r.status=t.getUrlParam("status"),r.setButtonStatus(),r.id=t.getUrlParam("pk"),"add"!=r.status?r.getData():(r.setButtonStatus(),r.props.form.setFormStatus("formatdocform","add"),r.props.editTable.setStatus("formatdoccard","edit")),r.state={backbtnstatus:"browse"!=r.props.getUrlParam("status")?"none":"",json:{},inlt:null},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"componentDidMount",value:function(){}},{key:"componentWillMount",value:function(){var t=this;this.props.MultiInit.getMultiLang({moduleId:"xi-exsystem-card",domainName:"uap",callback:function(e,r,o){r?t.setState({json:e,inlt:o}):console.log("未加载到多语资源")}})}},{key:"render",value:function(){var t=this,e=this.props,r=e.editTable,o=e.form.createForm,a=r.createEditTable;return n.default.createElement("div",{className:"nc-bill-card"},n.default.createElement("div",{className:"nc-bill-header-area"},n.default.createElement(d,{style:{display:this.state.backbtnstatus},onClick:function(){t.props.pushTo("/list")}}),n.default.createElement("div",{className:"header-title-search-area"},(0,s.createPageIcon)(),n.default.createElement("h2",{className:"title-search-detail"},"数据格式")),n.default.createElement("div",{className:"header-button-area"},this.props.button.createButtonApp({area:"header-button-area",buttonLimit:8,onButtonClick:i.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),n.default.createElement("div",{className:"nc-bill-form-area"},o(this.formId,{})),n.default.createElement("div",{className:"nc-bill-table-area"},n.default.createElement("div",{className:"shoulder-definition-area",style:{marginRight:"15px"}},n.default.createElement("div",{className:"definition-icons"},this.props.button.createButtonApp({area:"page_body",buttonLimit:2,onButtonClick:i.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),a(this.tableId,{onAfterEvent:i.afterEvent.bind(this)})))}}]),e}(a.Component));l=(0,s.createPage)({initTemplate:i.initTemplate})(l),e.default=l},150:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.afterEvent=e.initTemplate=e.buttonClick=void 0;var o=s(r(151)),a=s(r(152)),n=s(r(153));function s(t){return t&&t.__esModule?t:{default:t}}e.buttonClick=o.default,e.initTemplate=a.default,e.afterEvent=n.default},151:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var r=this,c="formatdocform",d=this,l=t.form.getAllFormValue(c).rows[0].values.pk_formatdoc.value,u=t.getUrlParam("pk"),f="uapbd.pub.formatdocdata.cache";switch(e){case"add":this.page_type="add",d.props.form.EmptyAllFormValue(c),d.props.editTable.setTableData("formatdoccard",{rows:[]}),d.props.form.setFormStatus(c,"add"),d.setState({backbtnstatus:"none"}),d.props.button.setButtonsVisible({add:!1,editor:!1,del:!1,save:!0,cancel:!0,print:!1});break;case"editor":if(!l)return void(0,o.toast)({content:this.state.json["xi-exsystem-000005"],color:"warning"});this.page_type="edit",t.form.setFormStatus(c,"edit"),t.editTable.setStatus("formatdocform","edit"),d.setState({backbtnstatus:"none"}),d.props.button.setButtonsVisible({add:!1,editor:!1,del:!1,save:!0,cancel:!0,print:!1});break;case"del":if(!l)return void(0,o.toast)({content:this.state.json["xi-exsystem-000006"],color:"warning"});var p={pk_formatdoc:l};(0,o.promptBox)({color:"warning",title:this.state.json["xi-exsystem-000007"],content:this.state.json["xi-exsystem-000008"],beSureBtnClick:function(){(0,o.ajax)({url:"/nccloud/uapbd/formatdoc/formatdocDelete.do",data:p,success:function(t){var e=t.success;t.data;if(e){var r=s(l,f);i("pk_formatdoc",l,f),r&&null!=r?d.getData2(r):(setTimeout((function(){d.props.form.EmptyAllFormValue("formatdocform")}),0),d.props.button.setButtonsVisible({add:!0,editor:!0,del:!0,print:!0,save:!1,cancel:!1})),(0,o.toast)({color:"success"})}},error:function(t){(0,o.toast)({content:r.state.json["xi-exsystem-000009"]+t.message,color:"danger"})}})}});break;case"save":if(this.page_type||(this.page_type=t.getUrlParam("status")),!t.form.isCheckNow("formatdocform"))return;var m=this.props.editTable.getAllData("formatdoccard"),b=t.form.getAllFormValue(c),h=(this.props.editTable.getChangedRows("formatdoccard",!1),{data:{form_data:b},list:{table_data:m}});null!=h.data.form_data.rows[0].values.fm&&(h.data.form_data.rows[0].values.fm.value="");(0,o.ajax)({url:"/nccloud/uapbd/pub/formatdoc.do",data:h,success:function(t){var e=t.success,r=t.data;e&&r&&(d.props.form.setFormStatus("formatdocform","browse"),d.setState({backbtnstatus:""}),d.props.button.setButtonsVisible({add:!0,edit:!0,del:!0,save:!1,cancel:!1,print:!0}),d.props.form.setAllFormValue({formatdocform:r.formatdocform.formatdocform}),"add"==d.page_type?n(r.formatdocform.formatdocform.rows[0].values.pk_formatdoc.value,r.formatdocform.formatdocform,"formatdoccard",f,r.formatdocform.formatdocform.rows[0].values):a("pk_formatdoc",r.formatdocform.formatdocform.rows[0].values.formatdocform.value,r.formatdocform.formatdoccard,"formatdoccard",f,r.formatdocform.formatdocform.rows[0].values),d.page_type="browse",(0,o.toast)({color:"success"}))},error:function(t){(0,o.toast)({content:r.state.json["xi-exsystem-000010"]+t.message,color:"danger"})}});break;case"cancel":this.page_type="browse";t.getUrlParam("status");(0,o.promptBox)({color:"warning",title:this.state.json["xi-exsystem-000011"],content:this.state.json["xi-exsystem-000012"],beSureBtnClick:function(){var t=r;t.props.form.setFormStatus("formatdocform","browse"),t.props.button.setButtonVisible({}),t.setState({backbtnstatus:""}),null==l&&null==u?t.props.form.EmptyAllFormValue("formatdocform"):null!=l&&null==u?t.getData2(l,"browse"):null==l&&null!=u?t.getData2(u,"browse"):null!=l&&null!=u&&t.getData2(l,"browse"),t.props.button.setButtonsVisible({add:!0,editor:!0,del:!1,save:!1,cancel:!1,print:!0})}});break;case"print_o":if(null!=l&&""!=l){var v={funcode:"10140LFOR",appcode:"10140LFOR",nodekey:"formatdoc_card",oids:[l],outputType:"output"};(0,o.output)({url:"/nccloud/uapbd/formatdoc/print.do",data:v})}else(0,o.toast)({content:this.state.json["1880000025-000001"],color:"warning"});break;case"print_p":null!=l&&""!=l?(0,o.print)("pdf","/nccloud/uapbd/formatdoc/print.do",{funcode:"10140LFOR",appcode:"10140LFOR",nodekey:"formatdoc_card",oids:[l]},!1):(0,o.toast)({content:this.state.json["1880000025-000001"],color:"warning"})}};var o=r(1),a=(o.cardCache.getCacheById,o.cardCache.updateCache),n=o.cardCache.addCache,s=o.cardCache.getNextId,i=o.cardCache.deleteCacheById;o.cardCache.getCurrentLastId},152:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){t.createUIDom({pagecode:"10140LFOR_CARD",appcode:"10140LFOR"},(function(e){if(e){if(e.button){var r=e.button;t.button.setButtons(r)}if(e.template){var o=e.template;t.meta.setMeta(o)}}}))};r(1).base.NCPopconfirm},153:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r,a,n){if("formatdoccform"==e&&"basicdatatypecode"===r){var s=t.editTable.getAllRows(this.tableId,!0),i=!0;if(s.map((function(t){n[0].rowid!=t.rowid&&null!=a.refpk&&t.values.basicdatatypecode.value===a.refpk&&(i=!1)})),!i)return(0,o.toast)({content:this.state.json["xi-exsystem-000003"]+a.refname+this.state.json["xi-exsystem-000004"],color:"warning"}),void t.editTable.setValByKeyAndRowId(this.tableId,n[0].rowid,r,{value:null,display:null});t.editTable.setValByKeyAndRowId(this.tableId,n[0].rowid,"basicdatatypecode.displayname",{value:a.refname,display:a.refname})}};var o=r(1);o.base.NCMessage},154:function(t,e,r){var o=r(155);"string"==typeof o&&(o=[[t.i,o,""]]);var a={transform:void 0};r(5)(o,a);o.locals&&(t.exports=o.locals)},155:function(t,e,r){(t.exports=r(4)(!1)).push([t.i,"#nc-bill-card {\n  min-width: 1200px;\n  padding: 0 20px 20px 20px;\n}\n#nc-bill-card .nc-bill-search-area {\n  padding: 20px;\n}\n#nc-bill-card .nc-bill-header-area {\n  background: #fff;\n  height: 64px;\n  padding: 17px 10px 10px 10px;\n  border-bottom: 2px solid #edecec;\n}\n#nc-bill-card .nc-bill-header-area .header-title-search-area {\n  float: left;\n  color: #474d54;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n#nc-bill-card .nc-bill-header-area .header-title-search-area h2.title-search-detail {\n  font-size: 16px;\n  font-family: PingFangHK-Medium;\n  height: 32px;\n  line-height: 32px;\n}\n#nc-bill-card .nc-bill-header-area .header-title-search-area .title-search-detail {\n  margin-right: 20px;\n  font-family: PingFangSC-Regular;\n  font-size: 13px;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n#nc-bill-card .nc-bill-header-area .header-button-area {\n  float: right;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n  padding-right: 10px;\n}\n#nc-bill-card .table-button-area {\n  float: right;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n  padding-right: 10px;\n}\n#nc-bill-card .nc-bill-form-area {\n  background: #fff;\n}\n",""])},2:function(t,r){t.exports=e},3:function(t,e){t.exports=r},4:function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",o=t[3];if(!o)return r;if(e&&"function"==typeof btoa){var a=(s=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),n=o.sources.map((function(t){return"/*# sourceURL="+o.sourceRoot+t+" */"}));return[r].concat(n).concat([a]).join("\n")}var s;return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r})).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},a=0;a<this.length;a++){var n=this[a][0];"number"==typeof n&&(o[n]=!0)}for(a=0;a<t.length;a++){var s=t[a];"number"==typeof s[0]&&o[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),e.push(s))}},e}},5:function(t,e,r){var o,a,n={},s=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===a&&(a=o.apply(this,arguments)),a}),i=function(t){var e={};return function(r){return void 0===e[r]&&(e[r]=t.call(this,r)),e[r]}}((function(t){return document.querySelector(t)})),c=null,d=0,l=[],u=r(133);function f(t,e){for(var r=0;r<t.length;r++){var o=t[r],a=n[o.id];if(a){a.refs++;for(var s=0;s<a.parts.length;s++)a.parts[s](o.parts[s]);for(;s<o.parts.length;s++)a.parts.push(y(o.parts[s],e))}else{var i=[];for(s=0;s<o.parts.length;s++)i.push(y(o.parts[s],e));n[o.id]={id:o.id,refs:1,parts:i}}}}function p(t,e){for(var r=[],o={},a=0;a<t.length;a++){var n=t[a],s=e.base?n[0]+e.base:n[0],i={css:n[1],media:n[2],sourceMap:n[3]};o[s]?o[s].parts.push(i):r.push(o[s]={id:s,parts:[i]})}return r}function m(t,e){var r=i(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=l[l.length-1];if("top"===t.insertAt)o?o.nextSibling?r.insertBefore(e,o.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),l.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(e)}}function b(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=l.indexOf(t);e>=0&&l.splice(e,1)}function h(t){var e=document.createElement("style");return t.attrs.type="text/css",v(e,t.attrs),m(t,e),e}function v(t,e){Object.keys(e).forEach((function(r){t.setAttribute(r,e[r])}))}function y(t,e){var r,o,a,n;if(e.transform&&t.css){if(!(n=e.transform(t.css)))return function(){};t.css=n}if(e.singleton){var s=d++;r=c||(c=h(e)),o=w.bind(null,r,s,!1),a=w.bind(null,r,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",v(e,t.attrs),m(t,e),e}(e),o=j.bind(null,r,e),a=function(){b(r),r.href&&URL.revokeObjectURL(r.href)}):(r=h(e),o=k.bind(null,r),a=function(){b(r)});return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else a()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=p(t,e);return f(r,e),function(t){for(var o=[],a=0;a<r.length;a++){var s=r[a];(i=n[s.id]).refs--,o.push(i)}t&&f(p(t,e),e);for(a=0;a<o.length;a++){var i;if(0===(i=o[a]).refs){for(var c=0;c<i.parts.length;c++)i.parts[c]();delete n[i.id]}}}};var g,x=(g=[],function(t,e){return g[t]=e,g.filter(Boolean).join("\n")});function w(t,e,r,o){var a=r?"":o.css;if(t.styleSheet)t.styleSheet.cssText=x(e,a);else{var n=document.createTextNode(a),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(n,s[e]):t.appendChild(n)}}function k(t,e){var r=e.css,o=e.media;if(o&&t.setAttribute("media",o),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}function j(t,e,r){var o=r.css,a=r.sourceMap,n=void 0===e.convertToAbsoluteUrls&&a;(e.convertToAbsoluteUrls||n)&&(o=u(o)),a&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");var s=new Blob([o],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(s),i&&URL.revokeObjectURL(i)}}})}));
//# sourceMappingURL=index.96b986bc.js.map