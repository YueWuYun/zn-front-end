/*! @ncctag {"project":"","branch":"","provider":"","date":"2020-5-11 15:01:24"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uapbd/prodcostinfo/bdactivity_grp/list/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uapbd/prodcostinfo/bdactivity_grp/list/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,a){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=7)}([function(t,a){t.exports=e},function(e,a){e.exports=t},function(e,t){e.exports=a},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tableId="list",t.pageId="10140ACTG_list",t.appcode="10140ACTG",t.multiLangCode="10140ACTG";t.module="uapbd";t.nodeType="GROUP_NODE",t.billtype="10140ACTG",t.funcode="10140ACTG",t.nodekey="10140ACTG"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o,s){var i=this;switch(t){case"Delete_inner":if("edit"==this.props.editTable.getStatus(this.tableId))this.props.editTable.deleteTableRowsByIndex(this.tableId,s),this.toggleShow();else{var r={model:{rows:[{status:"3",rowid:o.rowid,values:o.values}]},pageid:this.pageId};(0,n.ajax)({url:"/nccloud/uapbd/bdactivity/save.do",data:{grid:r},success:function(e){e.success&&((0,n.toast)({color:"success",content:i.state.json["10140ACTG-000013"]}),i.props.editTable.setStatus(i.tableId,"browse"),i.getTableData())}})}break;case"Enable_inner":this.enableFun("single",o.values.cactivityid.value,s);break;case"Disable_inner":this.disableFun("single",o.values.cactivityid.value,s)}};var n=a(0)},,,function(e,t,a){"use strict";var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),o=a(1),s=c(o),i=c(a(2)),r=a(0),l=a(8),d=a(3);function c(e){return e&&e.__esModule?e:{default:e}}var u=r.base.NCCheckbox,p=r.base.NCDiv,b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.getTableData=function(e){(0,r.ajax)({url:"/nccloud/uapbd/bdactivity/querytabledata.do",data:{appcode:a.props.getSearchParam("c"),isLegal:a.state.checked,nodeType:a.nodeType},success:function(t){"Refresh"==e&&(0,r.toast)({color:"success",content:a.state.json["10140ACTG-000003"]}),t.data?a.props.editTable.setTableData(a.tableId,t.data[a.tableId]):a.props.editTable.setTableData(a.tableId,{rows:[]}),a.toggleShow()}})},a.save=function(){var e=a.props.editTable.getStatus(a.tableId),t=[];if("browse"==e){var n=a.props.editTable.getCheckedRows(a.tableId),o=JSON.parse(JSON.stringify(n)),s=[];o.forEach((function(e){s.push(e.index)}));var i=a.props.editTable.getAllRows(a.tableId);JSON.parse(JSON.stringify(i)).forEach((function(e,a){-1!=s.indexOf(a)&&(e.status="3"),t.push(e)}))}else{if(a.props.editTable.getAllRows(a.tableId).forEach((function(e){(e.values.vactivitycode.value||"2"!=e.status)&&t.push(e)})),!a.props.editTable.checkRequired(a.tableId,t))return}var l={model:{rows:t},pageid:a.pageId};a.props.validateToSave(l,(function(){(0,r.ajax)({url:"/nccloud/uapbd/bdactivity/save.do",data:{grid:l},success:function(t){t.success&&("browse"==e?(0,r.toast)({color:"success",content:a.state.json["10140ACTG-000013"]}):(0,r.toast)({color:"success",content:a.state.json["10140ACTG-000014"]}),a.props.editTable.setStatus(a.tableId,"browse"),a.getTableData())}})}),{table1:"editTable"},"grid")},a.enableFun=function(e,t,n){var o=[],s=a;if("batch"==e){var i=s.props.editTable.getCheckedRows(s.tableId);if(!i||0==i.length)return void(0,r.toast)({content:""+s.state.json["10140ACTG-000017"],color:"warning"});i.forEach((function(e){o.push({pk_bill:e.data.values.cactivityid.value,ts:e.data.values.ts.value,index:e.index,pageId:s.props.getSearchParam("p")})})),(0,r.promptBox)({color:"warning",title:s.state.json["10140ACTG-000020"],content:s.state.json["10140ACTG-000019"],beSureBtnClick:function(){(0,r.ajax)({url:"/nccloud/uapbd/bdactivity/enablestate.do",data:o,success:function(e){e.success;var t=e.data;if(t.message&&(0,r.toast)({duration:"infinity",color:t.PopupWindowStyle,content:t.message}),t&&t.grid){var a=t.grid,n=[];for(var o in a)n.push({index:o,data:{values:a[o].values}});s.props.editTable.updateDataByIndexs(s.tableId,n)}}})}})}else"single"==e&&(o.push({pk_bill:t,index:n,pageId:s.props.getSearchParam("p")}),(0,r.ajax)({url:"/nccloud/uapbd/bdactivity/enablestate.do",data:o,success:function(e){e.success;var t=e.data;if(t&&t.grid){var a=t.grid,n=[];for(var o in a)n.push({index:o,data:{values:a[o].values}});s.props.editTable.updateDataByIndexs(s.tableId,n),(0,r.toast)({title:s.state.json["10140ACTG-000022"],color:"success"})}}}))},a.disableFun=function(e,t,n){var o=[],s=a;if("batch"==e){var i=s.props.editTable.getCheckedRows(s.tableId);if(!i||0==i.length)return void(0,r.toast)({content:""+s.state.json["10140ACTG-000027"],color:"warning"});i.forEach((function(e){o.push({pk_bill:e.data.values.cactivityid.value,ts:e.data.values.ts.value,index:e.index,pageId:s.props.getSearchParam("p")})})),(0,r.promptBox)({color:"warning",title:s.state.json["10140ACTG-000020"],content:s.state.json["10140ACTG-000018"],beSureBtnClick:function(){(0,r.ajax)({url:"/nccloud/uapbd/bdactivity/disablestate.do",data:o,success:function(e){e.success;var t=e.data;if(t.message&&(0,r.toast)({duration:"infinity",color:t.PopupWindowStyle,content:t.message}),t&&t.grid){var a=t.grid,n=[];for(var o in a)n.push({index:o,data:{values:a[o].values}});s.props.editTable.updateDataByIndexs(s.tableId,n)}}})}})}else"single"==e&&(o.push({pk_bill:t,index:n,pageId:s.props.getSearchParam("p")}),(0,r.ajax)({url:"/nccloud/uapbd/bdactivity/disablestate.do",data:o,success:function(e){e.success;var t=e.data;if(t&&t.grid){var a=t.grid,n=[];for(var o in a)n.push({index:o,data:{values:a[o].values}});s.props.editTable.updateDataByIndexs(s.tableId,n),(0,r.toast)({title:s.state.json["10140ACTG-000023"],color:"success"})}}}))},a.onPrint=function(){var e=a,t=e.props.editTable.getCheckedRows(e.tableId),n=[];t.forEach((function(e,t){var a=e.data.values.cactivityid;n.push(a.value)})),0!=n.length?(0,r.print)("pdf","/nccloud/uapbd/bdactivity/print.do",{billtype:d.billtype,funcode:d.funcode,nodekey:d.nodekey,oids:n}):(0,r.toast)({content:e.state.json["10140ACTG-000024"]+"，"+e.state.json["10140ACTG-000025"]+"！",color:"warning"})},a.onOutput=function(){var e=a,t=e.props.editTable.getCheckedRows(e.tableId),n=[];t.forEach((function(e,t){var a=e.data.values.cactivityid;n.push(a.value)})),0!=n.length?(0,r.output)({url:"/nccloud/uapbd/bdactivity/printoutput.do",data:{outputType:"output",funcode:d.funcode,nodekey:d.nodekey,oids:n}}):(0,r.toast)({content:e.state.json["10140ACTG-000024"]+"，"+e.state.json["10140ACTG-000026"]+"！",color:"warning"})},a.addLine=function(e){for(var t=!0,n=a.props.editTable.getAllRows(a.tableId),o=0;o<n.length;o++)if("3"!=n[o].status){t=!1;break}(0,r.ajax)({url:"/nccloud/uapbd/bdactivity/addline.do",data:{flag:t,pageId:a.pageId},success:function(e){e.data&&a.props.editTable.addRow(a.tableId)}})},a.toggleShow=function(){var e=a.props.editTable.getStatus(a.tableId);e||(e="browse");for(var t=[],n=[],o=0;o<a.Info.allButtonsKey.length;o++){l.buttonVisible.call(a,a.props,e,a.Info.allButtonsKey[o])?t.push(a.Info.allButtonsKey[o]):n.push(a.Info.allButtonsKey[o])}var s=[],i=[];0==a.props.editTable.getCheckedRows(a.tableId).length?s.push("Delete"):i.push("Delete");var r=a.props.editTable.getAllRows(a.tableId);r&&0!=r.length?i.push("Edit"):s.push("Edit"),"browse"==e?a.props.button.setPopContent("Delete_inner",a.state.json["10140ACTG-000006"]):a.props.button.setPopContent("Delete_inner",null),a.props.button.setButtonVisible(t,!0),a.props.button.setButtonVisible(n,!1),a.props.button.setButtonDisabled(s,!0),a.props.button.setButtonDisabled(i,!1),"browse"==e?(a.props.button.setMainButton("Add",!0),0!=a.state.disabled&&a.setState({disabled:!1})):(a.props.button.setMainButton("Add",!1),1!=a.state.disabled&&a.setState({disabled:!0}))},a.onRowClick=function(e,t,n,o,s){a.toggleShow()},a.changeCheck=function(){a.state.checked=!a.state.checked,a.getTableData()},a.tableId=d.tableId,a.nodeType=d.nodeType,a.pageId=e.getSearchParam("p"),a.Info={allButtonsKey:[],targetKeys:"",dataSource:[],index:null},a.state={transfershowModal:!1,checked:!1,disabled:!1,json:{}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentDidMount",value:function(){var e=this;(0,r.getMultiLang)({moduleId:[d.multiLangCode],domainName:d.module,currentLocale:"simpchn",callback:function(t){e.setState({json:t},(function(){l.initTemplate.call(e,e.props,e.getTableData)}))}})}},{key:"render",value:function(){var e=this.props,t=(e.table,e.button),a=(e.search,e.cardTable,this.props.BillHeadInfo.createBillHeadInfo),n=this.props.editTable.createEditTable,o=t.createButtonApp;return s.default.createElement("div",{className:"nc-bill-list"},s.default.createElement(p,{areaCode:p.config.HEADER},s.default.createElement("div",{className:"nc-bill-header-area"},s.default.createElement("div",{className:"header-title-search-area"},a({title:this.state.json["10140ACTG-000000"],initShowBackBtn:!1}),this.state.disabled?null:s.default.createElement("div",{className:"title-search-detail",style:{lineHeight:"30px"}},s.default.createElement(u,{checked:this.state.checked,onChange:this.changeCheck},this.state.json["10140ACTG-000004"]))),s.default.createElement("div",{className:"header-button-area"},o({area:"list_head_area",buttonLimit:3,onButtonClick:l.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")})))),s.default.createElement("div",{className:"nc-bill-table-area"},n(d.tableId,{onSelected:this.onRowClick.bind(this),onSelectedAll:this.onRowClick.bind(this),onBeforeEvent:l.bodyBeforeEvent.bind(this),onAfterEvent:l.bodyAfterEvent.bind(this),showCheck:!0,showIndex:!0,adaptionHeight:!0})))}}]),t}(o.Component);b=(0,r.createPage)({billinfo:{billtype:"grid",pagecode:d.pageId,bodycode:d.tableId}})(b),i.default.render(s.default.createElement(b,null),document.querySelector("#app"))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tableButtonClick=t.bodyAfterEvent=t.bodyBeforeEvent=t.buttonVisible=t.initTemplate=t.buttonClick=void 0;var n=d(a(9)),o=d(a(10)),s=d(a(11)),i=d(a(12)),r=d(a(13)),l=d(a(4));function d(e){return e&&e.__esModule?e:{default:e}}t.buttonClick=n.default,t.initTemplate=o.default,t.buttonVisible=s.default,t.bodyBeforeEvent=i.default,t.bodyAfterEvent=r.default,t.tableButtonClick=l.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=this;switch(t){case"Add":"edit"!=e.editTable.getStatus(this.tableId)&&e.editTable.setStatus(this.tableId,"edit"),this.addLine(!0),this.toggleShow();break;case"Delete":if("edit"==e.editTable.getStatus(this.tableId)){var o=e.editTable.getCheckedRows(this.tableId);0==o.length&&(0,n.toast)({color:"warning",content:this.state.json["10140ACTG-000002"]});var s=[];o.forEach((function(e){s.push(e.index)})),s.length>0&&e.editTable.deleteTableRowsByIndex(this.tableId,s)}else(0,n.promptBox)({color:"warning",title:this.state.json["10140ACTG-000009"],content:this.state.json["10140ACTG-000011"],noFooter:!1,noCancelBtn:!1,beSureBtnName:this.state.json["10140ACTG-000007"],cancelBtnName:this.state.json["10140ACTG-000008"],beSureBtnClick:function(){a.save()}});break;case"Edit":e.editTable.setStatus(this.tableId,"edit"),this.toggleShow();break;case"Print":this.onPrint();break;case"Output":this.onOutput();break;case"Enable":this.enableFun("batch");break;case"Disable":this.disableFun("batch");break;case"Refresh":this.getTableData(t);break;case"Save":this.save();break;case"Cancel":(0,n.promptBox)({color:"warning",title:this.state.json["10140ACTG-000007"],content:this.state.json["10140ACTG-000010"],noFooter:!1,noCancelBtn:!1,beSureBtnName:this.state.json["10140ACTG-000007"],cancelBtnName:this.state.json["10140ACTG-000008"],beSureBtnClick:function(){e.editTable.cancelEdit(a.tableId),a.toggleShow()}})}};var n=a(0);n.base.Message},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=this;e.createUIDom({pagecode:a.pageId,appcode:e.getSearchParam("c")},(function(n){if(n){if(n.template){var o=n.template;!function(e,t,a){a[e.tableId].items.push({label:e.state.json["10140ACTG-000005"],itemtype:"customer",attrcode:"opr",width:"100px",visible:!0,fixed:"right",render:function(a,n,o){var i=n.values.enablestate.value,r=[],l=e.props.editTable.getStatus(e.tableId);return r="2"==i?"edit"==l?["Delete_inner"]:["Delete_inner","Disable_inner"]:"edit"==l?["Delete_inner"]:["Delete_inner","Enable_inner"],t.button.createOprationButton(r,{area:"list_inner_area",buttonLimit:3,onButtonClick:function(t,i){return s.default.call(e,t,i,a,n,o)}})}})}(a,e,o),e.meta.setMeta(o)}if(n.button){var r=n.button;i(r,a.Info.allButtonsKey),e.button.setButtons(r)}t&&t()}}))};a(0),a(3);var n,o=a(4),s=(n=o)&&n.__esModule?n:{default:n};var i=function e(t,a){for(var n=0;n<t.length;n++)0==t[n].children.length?a.push(t[n].key):(a.push(t[n].key),e(t[n].children,a));return a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){var n=!0;switch(a){case"Add":case"Delete":break;case"Edit":case"Refresh":"browse"!=t&&(n=!1);break;case"Save":case"Cancel":"browse"==t&&(n=!1);break;case"Refresh":case"Enable":case"Enable_inner":case"Disable_inner":case"Print":"browse"!=t&&(n=!1)}return n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o,s,i){if(-1==n.indexOf(a.attrcode))return!0;var r=e.meta.getMeta();return r[t].items.map((function(e){e.attrcode;a.attrcode})),e.meta.setMeta(r),!0};a(0);var n=["pk_factorchart","pk_materialdocview","vmaterialpricesource"]},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,o,s,i,r){if(-1!=n.indexOf(a))return;if(s[0].newvalue.value==s[0].oldvalue.value)return;this.tableId};a(0);var n=["bscrapfactor","bshrinkfactor"]}])}));
//# sourceMappingURL=index.f85036de.js.map