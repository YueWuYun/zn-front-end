/*! @ncctag {"project":"","branch":"","provider":"","date":"2020-5-11 14:51:29"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("nc-lightapp-front")):"function"==typeof define&&define.amd?define(["react","nc-lightapp-front"],t):"object"==typeof exports?exports["uapbd/org/dept/list/index"]=t(require("react"),require("nc-lightapp-front")):e["uapbd/org/dept/list/index"]=t(e.React,e["nc-lightapp-front"])}(window,(function(e,t){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="../../../../",n(n.s=569)}({1:function(t,n){t.exports=e},3:function(e,n){e.exports=t},569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(1),i=(a=r)&&a.__esModule?a:{default:a},s=n(3);s.base.NCForm,s.base.NCInput,s.base.NCTable,s.base.NCBackBtn;var c=s.base.NCDiv,l=s.high.PrintOutput,u="deptquery",p="/nccloud/baseapp/dept/print.do",d="/nccloud/baseapp/dept/queryarea.do",f="/nccloud/baseapp/dept/querypage.do",h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clickSearchBtn=function(e,t){(t=n.props.search.getQueryInfo(u)).custcondition={conditions:[],logic:"and"},n.setState({queryparam:t}),n.loadData(t)},n.config={oid:""},n.state={allpks:[],json:n.props.config.json,queryparam:{pageInfo:{},ids:[],querycondition:{},queryAreaCode:u,oid:"1010Z010000000005HKC",querytype:"tree",custcondition:{conditions:[],logic:"and"}},curOrg:{pk:"",name:""}},n.loadMeta((function(){n.loadData({querycondition:n.props.search.getAllSearchData(u),queryAreaCode:u,oid:n.props.search.getQueryInfo(u).oid,querytype:"tree",custcondition:{conditions:[],logic:"and"}},"init")})),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"loadMeta",value:function(e){var t=this,n=this.props;n.createUIDom({pagecode:"10100DEPT_deptlist"},(function(a){if(a&&(a.context&&a.context.pk_org&&a.context.org_Name&&t.setState({curOrg:{pk:a.context.pk_org,name:a.context.org_Name}}),a.template)){var o=a.template;t.config.oid=o[u].oid;var r=o.deptquery.items.find((function(e){return"pk_fatherorg"===e.attrcode})),i=o.deptquery.items.find((function(e){return"deptlevel"===e.attrcode}));if(r.isShowUnit=!0,i.queryCondition=function(){return{pk_defdoclist:"1010ZZ10000000003PHX"}},o.deptquery.items.find((function(e){return"principal"===e.attrcode})).isShowDisabledData=!0,a.button){var s=a.button;n.button.setButtons(s)}n.meta.setMeta(o,(function(){e&&e()}))}}))}},{key:"onButtonClick",value:function(e,t){var n=this;switch(t){case"refresh":this.loadData(this.state.queryparam,(function(){(0,s.toast)({title:n.props.config.json["10100DEPT-000025"],color:"success"})}));break;case"print":var a={funcode:"10100DEPT",nodekey:"deptListPrint"};this.pintFunction(a);break;case"export":var o=this.state.allpks;this.setState({ids:o},this.refs.printOutput.open());break;case"return":this.props.config("N",{json:this.props.config.json,cacheOrg:this.props.cacheOrg,cacheRefPk:this.props.cacheRefPk});break;case"export_card":this.setState(this.state,(function(){n.props.modal.show("exportFileModal")}))}}},{key:"pintFunction",value:function(e){var t=this.state.allpks;e.oids=t,(0,s.print)("pdf",p,e)}},{key:"loadData",value:function(e,t){var n=this;(0,s.ajax)({url:d,data:e,success:function(e){n.setState({allpks:e.data.dept.allpks}),e.success&&e.data?(e.formulamsg&&e.formulamsg instanceof Array&&e.formulamsg.length>0&&n.props.dealFormulamsg(e.formulamsg,{tableid:"simpleTable"}),e.data.dept.rows.forEach((function(e){e.values.displayorder.value="999999"==e.values.displayorder.value?null:e.values.displayorder.value})),n.props.table.setAllTableData("dept",e.data.dept),t&&t instanceof Function?t():"init"==t||(0,s.toast)({content:n.props.config.json["10100DEPT-000068"]+e.data.dept.allpks.length+n.props.config.json["10100DEPT-000069"],color:"success"}),n.props.button.setDisabled({print:!1,export:!1})):(n.props.table.setAllTableData("dept",{rows:[]}),t&&t instanceof Function?t():"init"==t||(0,s.toast)({content:n.props.config.json["10100DEPT-000070"],color:"warning"}),n.props.button.setDisabled({print:!0,export:!0}))},error:function(e){console.log(e.message)}})}},{key:"onPageModalClick",value:function(e,t,n){var a=this;e.table.getTablePageInfo("dept");(0,s.ajax)({url:f,data:{pk_depts:n},success:function(e){e.success&&e.data?(e.formulamsg&&e.formulamsg instanceof Array&&e.formulamsg.length>0&&a.props.dealFormulamsg(e.formulamsg,{tableid:"simpleTable"}),e.data.dept.rows.forEach((function(e){e.values.displayorder.value="999999"==e.values.displayorder.value?null:e.values.displayorder.value})),a.props.table.setAllTableData("dept",e.data.dept)):(a.props.table.setAllTableData("dept",{rows:[]}),(0,s.toast)({content:a.props.config.json["10100DEPT-000070"],color:"warning"}))},error:function(e){console.log(e.message)}})}},{key:"renderCompleteEvent",value:function(){this.props.search.setSearchValByField(u,"pk_org",{value:this.state.curOrg.pk,display:this.state.curOrg.name})}},{key:"render",value:function(){if(!this.state.json)return"";var e=this.props,t=e.table,n=e.search,a=e.button,o=e.BillHeadInfo.createBillHeadInfo,r=t.createSimpleTable,s=n.NCCreateSearch,d=(a.createButton,a.createButtonApp);return i.default.createElement("div",{className:"nc-single-table"},i.default.createElement(c,{areaCode:c.config.HEADER,className:"nc-singleTable-header-area"},i.default.createElement("div",{className:"header-title-search-area"},o({title:this.state.json["10100DEPT-000000"],backBtnClick:this.onButtonClick.bind(this,null,"return"),showBackBtn:!0,initShowBackBtn:!0})),i.default.createElement("div",{className:"header-button-area"},d({area:"deptlist_btn",buttonLimit:3,onButtonClick:this.onButtonClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),i.default.createElement("div",{className:"nc-singleTable-search-area"},s(u,{clickSearchBtn:this.clickSearchBtn.bind(this),oid:this.config.oid,renderCompleteEvent:this.renderCompleteEvent.bind(this)})),i.default.createElement("div",{className:"nc-singleTable-table-area"},r("dept",{handlePageInfoChange:this.onPageModalClick.bind(this),showIndex:!0,showCheck:!1})),i.default.createElement(l,{ref:"printOutput",url:p,data:{funcode:"10100DEPT",nodekey:"deptListPrint",oids:this.state.allpks,outputType:"output"}}))}}]),t}(r.Component);h=(0,s.createPage)({initTemplate:function(){}})(h),t.default=h}})}));
//# sourceMappingURL=index.52518d9d.js.map