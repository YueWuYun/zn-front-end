/*! @ncctag {"project":"","branch":"","provider":"","date":"2020-5-11 14:43:34"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react"],t):"object"==typeof exports?exports["uapbd/cobase/cbs/tree/index"]=t(require("nc-lightapp-front"),require("react")):e["uapbd/cobase/cbs/tree/index"]=t(e["nc-lightapp-front"],e.React)}(window,(function(e,t){return function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="../../../../",r(r.s=5)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showToast=t.setDefaultVal=t.judgeProtypeDistriCBS=t.loginContext=t.getContext=t.setContext=t.printTemp=t.changeButtonByScene=t.sortTree=t.transformToTree=t.cancelCBSAssign=t.importFunc=t.doCBSAssign=t.queryModalCBSOrg=t.queryFinanceOrg=t.commonParams=t.judgeGroupDistriCBS=t.setDefaultUnit=t.newTreeNode=t.rootNodeHandle=t.browseStatusHandle=t.editStatusHandle=t.buttonClicks=t.activateButton=t.clickDelIconEve=t.clickEditIconEve=t.onSelectEve=t.clickAddIconEve=t.onMouseEnterEve=t.queryAndTransformToTree=t.queryCard=t.del=t.edit=t.insert=t.queryTree=t.pageInfo=t.initTemplate=void 0;var a,n=r(6),o=(a=n)&&a.__esModule?a:{default:a},s=r(4),c=r(7),l=r(8),i=r(9),d=r(10),p=r(11),u=r(12);t.initTemplate=o.default,t.pageInfo=n.pageInfo,t.queryTree=s.queryTree,t.insert=s.insert,t.edit=s.edit,t.del=s.del,t.queryCard=s.queryCard,t.queryAndTransformToTree=l.queryAndTransformToTree,t.onMouseEnterEve=l.onMouseEnterEve,t.clickAddIconEve=l.clickAddIconEve,t.onSelectEve=l.onSelectEve,t.clickEditIconEve=l.clickEditIconEve,t.clickDelIconEve=l.clickDelIconEve,t.activateButton=i.activateButton,t.buttonClicks=i.buttonClicks,t.editStatusHandle=c.editStatusHandle,t.browseStatusHandle=c.browseStatusHandle,t.rootNodeHandle=c.rootNodeHandle,t.newTreeNode=c.newTreeNode,t.setDefaultUnit=s.setDefaultUnit,t.judgeGroupDistriCBS=s.judgeGroupDistriCBS,t.commonParams=c.commonParams,t.queryFinanceOrg=s.queryFinanceOrg,t.queryModalCBSOrg=s.queryModalCBSOrg,t.doCBSAssign=s.doCBSAssign,t.importFunc=s.importFunc,t.cancelCBSAssign=s.cancelCBSAssign,t.transformToTree=d.transformToTree,t.sortTree=d.sortTree,t.changeButtonByScene=c.changeButtonByScene,t.printTemp=p.printTemp,t.setContext=u.setContext,t.getContext=u.getContext,t.loginContext=u.loginContext,t.judgeProtypeDistriCBS=s.judgeProtypeDistriCBS,t.setDefaultVal=c.setDefaultVal,t.showToast=s.showToast},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.constant={pageCode:"",searchId:"searchArea",pageId:"",pageName:"",formId:"formArea",treeId:"contractTree",nodeType:"",refTreeRootName:"",modalId:"modalId",appCode:"",btnArea:"page_header",transferModalId:"transferModalId",dataSource:"co.cobase.cbs.tree",refOrgTreeRootName:"组织",orgTreeId:"treeId",modalCBSId:"modalCBSId"},t.modalConfig={cancelConfig:{title:"取消编辑？",content:"是否取消编辑数据?",rightBtnName:"取消",leftBtnName:"确定"},deleteConfig:{title:"删除",content:"您确定要删除所选数据及其子孙节点吗？",rightBtnName:"取消",leftBtnName:"删除"},deleteNoChilConfig:{title:"删除",content:"您确定要删除所选数据吗？",rightBtnName:"取消",leftBtnName:"删除"}},t.toastConfig={delSucess:{title:"",content:"删除成功！"},addSucess:{title:"",content:"新增成功！"},editSucess:{title:"",content:"修改成功！"},querySucess:{title:"",content:"查询成功！"},refreshSuccess:{title:"",content:"刷新成功！"},assignSuccess:{title:"",content:"分配成功！"},cancelAssignSuccess:{title:"",content:"取消分配成功！"},addCBSWarning:{title:"",content:"当前节点是默认cbs且是末级，不允许新增下级节点",color:"warning"},editCBSWarning:{title:"",content:"当前节点是默认cbs，不允许修改下级节点",color:"warning"},deleteCBSWarning:{title:"",content:"当前节点是默认cbs，不允许删除下级节点",color:"warning"},importSuccess:{title:"",content:"引入成功！"},warning:{title:"",content:"您有必输项未填写，请填写",color:"warning"},financeOrgWaring:{title:"",content:"指定的财务组织为空",color:"warning"},cbsWaring:{title:"",content:"待分配的CBS为空",color:"warning"}},t.attrcodeObj={pkOrg:"pk_org",orgName:"org_Name",pkPrimery:"pk_cbsnode",pkProjecttype:"pk_projecttype",isLeafNode:"isleafnode",isDefalut:"isdefault",pkFinanceOrg:"pk_financeorg",pkCorp:"pk_corp",pkGroup:"pk_group",pkProject:"pk_project",nodetype:"node_type",pkFather:"pk_father",code:"code",name:"name",pkFinancePrimery:"pk_financeorg",pkVid:"pk_vid",isleaf:"isleaf",assetclassDef:"assetclass_def"},t.ajaxUrl={queryTreeUrl:"/nccloud/co/cbs/queryTree.do",queryCardUrl:"/nccloud/co/cbs/queryCard.do",editUrl:"/nccloud/co/cbs/CBSUpdate.do",insertUrl:"/nccloud/co/cbs/insert.do",deleteUrl:"/nccloud/co/cbs/delete.do",importUrl:"/nccloud/co/cbs/CBSImport.do",doCBSAssignUrl:"/nccloud/co/cbs/CBSAssign.do",setDefaultUnit:"/nccloud/co/cbs/CBSSetDefault.do",queryFinanceOrg:"/nccloud/co/cbs/FinanceOrgQuery4Group.do",cancelCBSAssignUrl:"/nccloud/co/cbs/CBSCancelAssign.do",doCBSValidatorUrl:"/nccloud/co/cbs/CBSValidator.do",doCBSProValidatorUrl:"/nccloud/co/cbs/CBSProValidator.do",printUrl:"/nccloud/pmbd/pmpub/print.do"},t.TreeIconAddShow={addIcon:!0,delIcon:!1,editIcon:!1}},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.judgeProtypeDistriCBS=t.showToast=t.cancelCBSAssign=t.importFunc=t.doCBSAssign=t.queryModalCBSOrg=t.queryFinanceOrg=t.setDefaultUnit=t.judgeGroupDistriCBS=t.queryCard=t.del=t.edit=t.insert=t.queryTree=void 0;var a=r(2),n=r(1),o=r(0),s=a.cardCache.addCache,c=a.cardCache.getCacheById,l=a.cardCache.updateCache,i=a.cardCache.getCurrentLastId,d=n.constant.formId,p=n.constant.treeId,u=n.constant.dataSource,f=n.constant.refOrgTreeRootName,h=n.constant.orgTreeId,m=n.attrcodeObj.pkFather,g=n.attrcodeObj.code,v=n.attrcodeObj.name,y=n.attrcodeObj.pkFinancePrimery,b=n.attrcodeObj.pkPrimery,S=n.attrcodeObj.isDefalut;function k(e){if(this.props.form.setAllFormValue({formArea:e}),e.rows[0].values[S].value){var t=o.changeButtonByScene.call(this,[],["SetDefault"],!1);this.props.button.setButtonDisabled(t)}else{var r=o.changeButtonByScene.call(this,[],["SetDefault"],!0);this.props.button.setButtonDisabled(r)}var a=e.rows[0]&&e.rows[0].values[b]&&e.rows[0].values[b].value||"",n=a||i(u),p=c(n,u),f=this.props.form.getFormStatus(d);p||"edit"===f?a&&l(b,n,e,d,u):a&&s(n,e,d,u)}function T(e,t){var r=e[t].color,n=e[t].title,o=e[t].content;(0,a.toast)({color:r,title:n,content:o})}t.queryTree=function(e,t,r,o,s){var c=this,l=[];(0,a.ajax)({url:n.ajaxUrl.queryTreeUrl,data:t,success:function(t){t&&t.data&&(l=t.data,o||T(n.toastConfig,"querySucess"),r.call(c,l,e,o,s))}})},t.insert=function(e){var t=this;(0,a.ajax)({url:n.ajaxUrl.insertUrl,data:e,success:function(e){var r=e.data[d];o.newTreeNode.call(t,r,"add"),k.call(t,r),T(n.toastConfig,"addSucess")}})},t.edit=function(e){var t=this;(0,a.ajax)({url:n.ajaxUrl.editUrl,data:e,success:function(e){var r=e.data[d];o.newTreeNode.call(t,r,"edit"),k.call(t,r),T(n.toastConfig,"editSucess")}})},t.del=function(e,t){var r=this;(0,a.ajax)({url:n.ajaxUrl.deleteUrl,data:e,success:function(e){r.props.syncTree.delNodeSuceess(p,t),r.props.form.EmptyAllFormValue(d),o.rootNodeHandle.call(r,"root"),T(n.toastConfig,"delSucess")}})},t.queryCard=function(e,t,r){var o=this;this.state.pkOrgValueRef&&(e.pk_org=this.state.pkOrgValueRef.refpk),(0,a.ajax)({url:n.ajaxUrl.queryCardUrl,data:e,success:function(e){if(e&&e.data){var t=e.data[d];k.call(o,t),r&&r()}}})},t.judgeGroupDistriCBS=function(e,t,r){var o=!1;return(0,a.ajax)({url:n.ajaxUrl.doCBSValidatorUrl,data:e,async:!1,success:function(e){if(e.data)switch(e.data){case"0":case"3":o="delete"===r,t&&t()}}}),o},t.setDefaultUnit=function(e){var t=this;(0,a.ajax)({url:n.ajaxUrl.setDefaultUnit,data:e,success:function(e){var r=e.data[d];k.call(t,r)}})},t.queryFinanceOrg=function(){var e=this,t=[];return(0,a.ajax)({url:n.ajaxUrl.queryFinanceOrg,async:!1,success:function(r){t=r;var a={pid:m,refcode:g,refname:v,refpk:y,id:y,values:{}},n=r.data,s=o.transformToTree.call(e,a,f,n,e.props);(0,o.sortTree)(s),e.props.syncTree.setSyncTreeData(h,s)}}),t},t.queryModalCBSOrg=function(){var e=this,t=o.commonParams.call(this).params;"import"===this.state.type&&(t.node_type="ORG_NODE",t.pk_projecttype=null);var r=this.props.getSearchParam("p"),s=[];return(0,a.ajax)({url:n.ajaxUrl.queryTreeUrl,data:t,async:!1,success:function(t){var a={pid:m,refcode:g,refname:v,refpk:b,id:b,values:{},fpid:m},n=t.data,c="10140CBSG-group"===r?"CBS-集团":"10140CBSC-org"===r?"CBS-财务组织":"项目CBS";s=o.transformToTree.call(e,a,c,n,e.props),(0,o.sortTree)(s),e.props.syncTree.setSyncTreeData("leftTree",s)}}),s},t.doCBSAssign=function(e){var t=this;(0,a.ajax)({url:n.ajaxUrl.doCBSAssignUrl,data:e,success:function(e){t.setState({assignModal:!1,importModal:!1,type:""}),T.call(t,n.toastConfig,"assignSuccess")}})},t.importFunc=function(e){var t=this;(0,a.ajax)({url:n.ajaxUrl.importUrl,data:e,success:function(e){t.setState({importModal:!1,type:""});var r=o.commonParams.call(t).params;o.queryAndTransformToTree.call(t,t.props,r,!0,(function(){o.rootNodeHandle.call(t,"root")})),T.call(t,n.toastConfig,"importSuccess")}})},t.cancelCBSAssign=function(e){var t=this;(0,a.ajax)({url:n.ajaxUrl.cancelCBSAssignUrl,data:e,success:function(e){t.setState({importModal:!1,assignModal:!1,type:""}),T.call(t,n.toastConfig,"cancelAssignSuccess")}})},t.showToast=T,t.judgeProtypeDistriCBS=function(e,t){(0,a.ajax)({url:n.ajaxUrl.doCBSProValidatorUrl,data:e,async:!1,success:function(e){if(e.data)switch(e.data){case"3":t&&t()}}})}},function(e,t,r){"use strict";var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),n=r(3),o=p(n),s=r(2),c=r(0),l=r(1),i=p(r(13)),d=p(r(14));function p(e){return e&&e.__esModule?e:{default:e}}var u=s.high.Refer,f=(l.attrcodeObj.pkOrg,l.attrcodeObj.pkProject,l.attrcodeObj.pkProjecttype,l.constant.treeId),h=l.constant.formId,m=l.constant.pageName,g=l.constant.pageCode,v=l.constant.modalId,y=l.constant.btnArea,b=(l.constant.appCode,function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.setProps=function(e,t,a){if(t&&0===t.length)return(0,c.showToast)(l.toastConfig,"financeOrgWaring"),!1;var n=r.state.pkOrgValueRef,o=a&&a();a&&!o||("next"===e?r.setState({importModal:!0,tableArr:t}):"cancel"===e?r.setState({assignModal:!1,tableArr:[{key:n.refpk}],treeModalData:[],type:""}):"importCacel"===e?r.setState({importModal:!1,tableArr:[{key:n.refpk}],type:""}):"import"===e&&r.setState({importModal:!1,tableArr:[{key:n.refpk}],treeModalData:[],type:"",assignModal:!1}))},r.getMustInputValue=function(){c.setDefaultVal.call(r);var e=c.commonParams.call(r),t=e.haveValueFlag,a=e.params;if(t){var n=c.changeButtonByScene.call(r,[],["ImportCBS"],!0);r.props.button.setButtonDisabled(n),c.queryAndTransformToTree.call(r,r.props,a,!1,(function(){c.rootNodeHandle.call(r,"root")}))}},r.state={showModal:!1,importModal:!1,assignModal:!1,tableArr:[],treeModalData:[],type:"",pkOrgValueRef:"",pkProjectValueRef:"",pkProjectTypeValueRef:""},g=e.getSearchParam("p"),m="10140CBSG-group"===g?"CBS-集团":"10140CBSC-org"===g?"CBS-财务组织":"项目CBS",c.initTemplate.call(r,e),r.activateButton=c.activateButton.bind(r),r.onMouseEnterEve=c.onMouseEnterEve.bind(r),r.clickAddIconEve=c.clickAddIconEve.bind(r),r.onSelectEve=c.onSelectEve.bind(r),r.clickEditIconEve=c.clickEditIconEve.bind(r),r.clickDelIconEve=c.clickDelIconEve.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"render",value:function(){var e=this,t=this.props,r=t.ncmodal,a=t.button,n=t.DragWidthCom,p=t.syncTree,b=t.form,S=r.createModal,k=a.createButtonApp,T=b.createForm,C=p.createSyncTree,B=o.default.createElement("div",{className:"tree-area"},C({treeId:f,onMouseEnterEve:this.onMouseEnterEve,showModal:!1,clickAddIconEve:this.clickAddIconEve,onSelectEve:this.onSelectEve,clickEditIconEve:this.clickEditIconEve,clickDelIconEve:this.clickDelIconEve})),x=o.default.createElement("div",{className:"card-area"},T(h,{cancelPSwitch:!0,datasource:l.constant.datasource})),N=this.state,j=N.pkOrgValueRef,O=N.pkProjectValueRef,w=N.pkProjectTypeValueRef;return o.default.createElement("div",{className:"nc-single-table"},o.default.createElement("div",{className:"nc-singleTable-header-area"},o.default.createElement("div",{className:"header-title-search-area"},(0,s.createPageIcon)(),o.default.createElement("h2",{className:"title-search-detail"},m)),"10140CBSG-group"!==g?o.default.createElement("div",{className:"refer"},o.default.createElement("span",{className:"mustFillIn_search"},"*"),o.default.createElement(u,{value:j,onChange:function(t){e.setState({pkOrgValueRef:t,tableArr:[{key:t.refpk}]},(function(){e.getMustInputValue.call(e)}))},refName:"财务组织",placeholder:"财务组织",refType:"tree",rootNode:{refname:"财务组织",refpk:"root"},queryTreeUrl:"/nccloud/uapbd/org/FinanceOrgAllDataTreeRef.do"})):null,"10140CBSPRO-pro"===g?o.default.createElement("div",{className:"refer"},o.default.createElement("span",{className:"mustFillIn_search"},"*"),o.default.createElement(u,{value:O,onChange:function(t){e.setState({pkProjectValueRef:t},(function(){e.getMustInputValue.call(e)}))},refName:"项目",placeholder:"项目",refType:"gridTree",rootNode:{refname:"项目基本分类",refpk:"root"},queryCondition:function(){return{pk_org:j.refpk}},queryTreeUrl:"/nccloud/uapbd/ref/ProjectDefaultTreeRef.do",queryGridUrl:"/nccloud/uapbd/ref/ProjectDefaultGridRef.do"})):null,"10140CBSPRO-pro"!==g?o.default.createElement("div",{className:"refer"},o.default.createElement("span",{className:"mustFillIn_search"},"*"),o.default.createElement(u,{value:w,onChange:function(t){e.setState({pkProjectTypeValueRef:t},(function(){e.getMustInputValue.call(e)}))},rootNode:{refname:"项目基本分类",refpk:"root"},refName:"项目基本分类",placeholder:"项目基本分类",refType:"tree",queryTreeUrl:"/nccloud/uapbd/pm/EpsTreeRef.do"})):null,o.default.createElement("div",{className:"header-button-area"},k({area:y,onButtonClick:this.activateButton}))),o.default.createElement("div",{className:"tree-card"},o.default.createElement(n,{leftDom:B,rightDom:x,leftMinWid:"350px"})),o.default.createElement(i.default,{showModalT:this.state.assignModal,setProps:this.setProps}),o.default.createElement(d.default,{showModalT:this.state.importModal,that:this,type:this.state.type,pkProjectValueRef:O.refpk,setProps:this.setProps,tableArr:this.state.tableArr,queryTree:c.queryModalCBSOrg.bind(this)}),S(v,{}))}}]),t}(n.Component));b=(0,s.createPage)({initTemplate:""})(b),ReactDOM.render(o.default.createElement(b,null),document.querySelector("#app"))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=this,r=e.getSearchParam("p");e.createUIDom({pagecode:r},(function(a){if(a&&(a.context&&n.loginContext.call(t,a.context),a.button&&e.button.setButtons(a.button,(function(){var r=n.changeButtonByScene.call(t,["Save","Cancel","Refresh","CardPrint","Output","SetDefault","AssignCBS","CancelCBS","ImportCBS"],["Save","Cancel"],!0);e.button.setButtonsVisible(r);var a=n.changeButtonByScene.call(t,["Save","Cancel","Refresh","CardPrint","Output","SetDefault","AssignCBS","CancelCBS","ImportCBS"],["Refresh"],!0);e.button.setButtonDisabled(a)})),a.template)){var s=a.template;s=l.call(t,s);var c="10140CBSG-group"===r?"CBS-集团":"10140CBSC-org"===r?"CBS-财务组织":"项目CBS";e.meta.setMeta(s,(function(){var r=n.transformToTree.call(t,null,c,[],e);(0,n.sortTree)(r),e.syncTree.setSyncTreeData(o,r)}))}}))};var a=r(1),n=r(0),o=a.constant.treeId,s=a.constant.formId,c=(a.attrcodeObj.pkProjecttype,a.attrcodeObj.pkOrg,a.attrcodeObj.pkProject,a.attrcodeObj.assetclassDef);function l(e){var t=this;return e[s]&&e[s].items&&e[s].items.map((function(e,r){switch(e.attrcode){case c:Object.assign(e,{queryCondition:function(){return{pk_org:t.state.pkOrgValueRef.refpk||""}}})}})),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setDefaultVal=t.changeButtonByScene=t.commonParams=t.newTreeNode=t.rootNodeHandle=t.browseStatusHandle=t.editStatusHandle=void 0;var a=r(2),n=r(1),o=r(0),s=r(4);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=a.cardCache.getCurrentLastId,i=a.cardCache.getCacheById,d=n.constant.formId,p=n.constant.treeId,u=n.constant.dataSource,f=n.attrcodeObj.pkProjecttype,h=n.attrcodeObj.pkFather,m=n.attrcodeObj.pkOrg,g=n.attrcodeObj.pkProject,v=n.attrcodeObj.code,y=n.attrcodeObj.pkPrimery,b=n.attrcodeObj.nodetype;function S(e){if("cancel"===e){this.props.form.cancel(d),this.props.form.EmptyAllFormValue(d);var t=l(u),r=i(t,u);if(r){this.props.form.setAllFormValue(c({},d,r));var a=r.rows[0].values;if("root"!==a[v].value||null!==a[v].value){this.props.syncTree.openNodeByPk(p,a[y].value),this.props.syncTree.setNodeSelected(p,a[y].value);var n=T.call(this,["Save","Cancel","Refresh","CardPrint","Output","SetDefault","AssignCBS","CancelCBS","ImportCBS"],["Save","Cancel"],!1);this.props.button.setButtonDisabled(n)}else k.call(this,"root")}else{var o=T.call(this,["Save","Cancel","Refresh","CardPrint","Output","SetDefault"],["Refresh"],!0);this.props.button.setButtonDisabled(o)}}else this.props.form.setFormStatus(d,"browse"),k.call(this,"noRoot");var s=T.call(this,["Save","Cancel","Refresh","CardPrint","Output","SetDefault","AssignCBS","CancelCBS","ImportCBS"],["Save","Cancel"],!0);this.props.button.setButtonsVisible(s),this.props.syncTree.setNodeDisable(p,!1)}function k(e){var t=T.call(this,["Save","Cancel","Refresh","CardPrint","Output","SetDefault"],["Refresh","AssignCBS","CancelCBS","ImportCBS"],!0);if(this.props.button.setButtonDisabled(t),"root"===e||null===e){this.props.form.EmptyAllFormValue(d);var r=T.call(this,["Save","Cancel","Refresh","CardPrint","Output","SetDefault"],["Refresh"],!0);this.props.button.setButtonDisabled(r)}else{var a=T.call(this,[],["Refresh","CardPrint","Output","AssignCBS","CancelCBS","ImportCBS"],!0);this.props.button.setButtonDisabled(a)}}function T(e,t,r){var a={};return 0===e.length?t.map((function(e,t){a[e]=!r})):e.map((function(e,n){a[e]=r,t.map((function(t,n){e===t&&(a[t]=!r)}))})),a}function C(){var e,t=this.state,r=t.pkOrgValueRef,a=t.pkProjectValueRef,n=t.pkProjectTypeValueRef,o={value:a.refpk,display:a.refname},s={value:n.refpk,display:n.refname},l={value:r.refpk,display:r.refname},i=(c(e={},f,s),c(e,g,o),c(e,m,l),e);this.props.form.setFormItemsValue(d,i)}t.editStatusHandle=function(e,t){var r=this,a=this.state,n=(a.pkOrgValueRef,a.pkProjectValueRef,a.pkProjectTypeValueRef,function(){if("add"===t){r.props.form.EmptyAllFormValue(d),C.call(r);var a=e.refpk,n=c({},h,{value:"root"===a?null:a,display:e.refname.split(" ")[1]});r.props.form.setFormItemsValue(d,n),r.props.syncTree.setNodeSelected(p,e.refpk)}r.props.form.setFormStatus(d,t);var o=T.call(r,["Save","Cancel","Refresh","CardPrint","Output","AssignCBS","SetDefault","CancelCBS","ImportCBS"],["Save","Cancel"],!1);r.props.button.setButtonsVisible(o);var s=T.call(r,["Save","Cancel","Refresh","CardPrint","Output","AssignCBS","SetDefault","CancelCBS","ImportCBS"],["Save","Cancel"],!0);r.props.button.setButtonDisabled(s),r.props.syncTree.setNodeDisable(p,!0)}),s={pk:e.refpk,pagecode:this.props.getSearchParam("p")};"root"!==e.refpk?o.queryCard.call(this,s,this.props,n):n()},t.browseStatusHandle=S,t.rootNodeHandle=k,t.newTreeNode=function(e,t){S.call(this);var r=e.rows[0].values,a=r.pk_father,n=r.code,o=r.name,s=r.pk_cbsnode,c={isleaf:r.isleafnode.value,pid:a.value?a.value:"root",refcode:n.value,refname:n.value+" "+o.value,refpk:s.value,values:void 0!==e.rows&&e.rows[0].values?e.rows[0].values:e};this.props.form.setAllFormValue({formArea:e}),"add"==t?(this.props.syncTree.addNodeSuccess(p,c),this.props.syncTree.openNodeByPk(p,c.refpk),this.props.syncTree.setNodeSelected(p,c.refpk)):"edit"==t&&this.props.syncTree.editNodeSuccess(p,c)},t.commonParams=function(){var e=this.state,t=e.pkOrgValueRef,r=e.pkProjectValueRef,a=e.pkProjectTypeValueRef,o={},l=!1,i=this.props.getSearchParam("p");switch(i){case"10140CBSG-group":Object.assign(o,{pk_projecttype:a.refpk}),a.refpk&&(l=!0);break;case"10140CBSC-org":Object.assign(o,{pk_org:t.refpk,pk_projecttype:a.refpk}),t.refpk&&a.refpk&&(l=!0);break;case"10140CBSPRO-pro":Object.assign(o,{pk_org:t.refpk,pk_project:r.refpk}),t.refpk&&r.refpk&&(l=!0)}var d="10140CBSG-group"===i?"GROUP_NODE":"10140CBSC-org"===i?"ORG_NODE":"PROJECT_NODE";return Object.assign(o,c({},b,d)),l||s.showToast.call(this,n.toastConfig,"warning"),{params:o,haveValueFlag:l}},t.changeButtonByScene=T,t.setDefaultVal=C},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clickDelIconEve=t.clickEditIconEve=t.onSelectEve=t.clickAddIconEve=t.onMouseEnterEve=t.queryAndTransformToTree=void 0;var a=r(0),n=r(1);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=n.constant.formId,c=n.constant.treeId,l=(n.constant.dataSource,n.constant.modalId),i=n.attrcodeObj.pkPrimery,d=n.attrcodeObj.isLeafNode,p=n.attrcodeObj.pkOrg,u=n.attrcodeObj.isleaf,f=n.attrcodeObj.isDefalut,h=n.attrcodeObj.pkFather,m=n.attrcodeObj.code,g=n.attrcodeObj.name,v=n.attrcodeObj.pkProject;function y(e,t,r,n){var o={pid:h,refcode:m,refname:g,refpk:i,id:i,values:{}},s=this.props.getSearchParam("p"),l="10140CBSG-group"===s?"CBS-集团":"10140CBSC-org"===s?"CBS-财务组织":"项目CBS",d=a.transformToTree.call(this,o,l,e,t);if((0,a.sortTree)(d),t.syncTree.setSyncTreeData(c,d),n&&n(),r){var p=d[0].children[0].refpk;t.syncTree.setNodeSelected(c,p);var u={pk:p,pagecode:this.props.getSearchParam("p")};a.queryCard.call(this,u)}}function b(e){a.del.call(this,e.params,e.refpk)}t.queryAndTransformToTree=function(e,t,r,n){a.queryTree.call(this,this.props,t,y,r,n)},t.onMouseEnterEve=function(e,t){if("root"===e){var r=n.TreeIconAddShow;this.props.syncTree.hideIcon(c,e,r)}},t.clickAddIconEve=function(e){var t=this,r=a.commonParams.call(this),n=r.params,s=r.haveValueFlag;if(s){var c=this.props.getSearchParam("p");if("10140CBSC-org"===c&&e[d]||"10140CBSC-org"===c&&e[u]){if(s){var l,f;if("root"===e.id)o(l={},i,""),o(l,p,n[p]),n=l;else o(f={},i,[e.refpk]),o(f,p,n[p]),o(f,"operType","add"),n=f;a.judgeGroupDistriCBS.call(this,n,(function(){a.editStatusHandle.call(t,e,"add")}))}}else if("10140CBSPRO-pro"===c&&"root"===e.id){var h;if(s)o(h={},v,n[v]),o(h,p,n[p]),n=h,a.judgeProtypeDistriCBS.call(this,n,(function(){a.editStatusHandle.call(t,e,"add")}))}else a.editStatusHandle.call(this,e,"add")}},t.onSelectEve=function(e,t){a.rootNodeHandle.call(this,e);var r=this.props.form.getFormItemsValue(s,d).value,n=this.props.form.getFormItemsValue(s,f).value;if(r&&!n&&"root"!==e){var o=a.changeButtonByScene.call(this,[],["SetDefault"],!0);this.props.button.setButtonDisabled(o)}else{var c=a.changeButtonByScene.call(this,[],["SetDefault"],!1);this.props.button.setButtonDisabled(c)}var l={pk:t.refpk,pagecode:this.props.getSearchParam("p")};if("root"===e)return this.props.form.EmptyAllFormValue(s),void a.setDefaultVal.call(this);a.queryCard.call(this,l)},t.clickEditIconEve=function(e){var t=this;if("10140CBSC-org"===this.props.getSearchParam("p")){var r,n=(o(r={},i,[e.refpk]),o(r,p,[e.values[p].value]),o(r,"operType","edit"),r);a.judgeGroupDistriCBS.call(this,n,(function(){a.editStatusHandle.call(t,e,"edit")}))}else a.editStatusHandle.call(this,e,"edit")},t.clickDelIconEve=function(e){var t=this,r=this.props.getSearchParam("p"),d={pk:e.refpk,pagecode:r};if("10140CBSC-org"===r){var u,f=(o(u={},i,[e.refpk]),o(u,p,[e.values[p].value]),o(u,"operType","del"),u);if(!a.judgeGroupDistriCBS.call(this,f,null,"delete"))return}a.queryCard.call(this,d,this.props,(function(){a.rootNodeHandle.call(t,e.refpk),t.props.syncTree.openNodeByPk(c,e.refpk),t.props.syncTree.setNodeSelected(c,e.refpk);var i=t.props.form.getFormItemsValue(s,"ts").value,d={params:{paramInfoMap:o({},e.refpk,i),pagecode:r},refpk:e.refpk},p={};(p=null!==e.children&&void 0!==e.children&&e.children.length>0?n.modalConfig.deleteConfig:n.modalConfig.deleteNoChilConfig).beSureBtnClick=function(){return b.call(t,d)},t.props.modal.show(l,p)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttonClicks=t.activateButton=void 0;var a=r(1),n=r(0);var o=a.constant.formId,s=a.constant.treeId,c=(a.constant.modalId,a.attrcodeObj.pkFather),l=(a.attrcodeObj.code,a.attrcodeObj.name,a.attrcodeObj.pkFinancePrimery,a.attrcodeObj.pkPrimery),i=(a.attrcodeObj.isDefalut,{Save:function(e){var t=this;if(!e.form.isCheckNow(o))return;var r=u.call(this),a=this.props.form.getFormStatus(o),s=(l={},i=o,d="form",i in l?Object.defineProperty(l,i,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[i]=d,l),c=function(e){"add"===a?n.insert.call(t,e):n.edit.call(t,e)};var l,i,d;r.pageid=this.props.getSearchParam("p"),this.props.validateToSave(r,(function(e){r.pageid=t.props.meta.getMeta().pageid,c.call(t,r)}),s,"form")},Cancel:function(e,t){d.call(this)},Refresh:function(){var e=this,t=n.commonParams.call(this),r=t.params;if(!t.haveValueFlag)return;n.queryAndTransformToTree.call(this,this.props,r,!1,(function(){n.rootNodeHandle.call(e,"root")}))},CardPrint:p,Output:p,AssignCBS:function(e,t){this.setState({assignModal:!0,type:"assign"})},SetDefault:function(e,t){var r=u.call(this);this.state.pkOrgValueRef&&(r.model.pk_org=this.state.pkOrgValueRef.refpk);n.setDefaultUnit.call(this,r)},CancelCBS:function(e,t){this.setState({assignModal:!0,type:"cancelAssign"})},ImportCBS:function(e,t){this.setState({importModal:!0,type:"import"})}});function d(){n.browseStatusHandle.call(this,"cancel")}function p(e,t){var r=this.props.form.getFormItemsValue(o,l).value,s=(0,n.getContext)("scaleClazz"),c=e.getSearchParam("c");(0,n.printTemp)("CardPrint"===t?"print":"output","pdf",a.ajaxUrl.printUrl,"Card",[r],c,"Card","pcm",s)}function u(){var e=this.props.form.getAllFormValue(o).rows;"root"===e[0].values[c].value&&(e[0].values[c].value=null);var t="",r=this.props.syncTree.getSelectNode(s);return null!==r&&"root"!==r.refpk&&(t=r.refpk),{pageid:this.props.meta.getMeta().pageid,model:{areacode:"formArea",areaType:"form",allpks:[t],rows:[e[0]]}}}t.activateButton=function(e,t){i[t].call(this,e,t)},t.buttonClicks=i},function(e,t,r){"use strict";function a(e,t){return e.refcode>t.refcode?1:e.refcode<t.refcode?-1:0}Object.defineProperty(t,"__esModule",{value:!0}),t.transformToTree=function(e,t,r,a,n){var o=[],s=!1;if(r.length>0){var c="";o=r.map((function(t){return"root"===t[e.refpk]?(c=null,s=!0):c=t[e.pid]?t[e.pid]:"root",{pid:c,refcode:t[e.refcode],refname:n?t[e.refname]:t[e.refcode]+" "+t[e.refname],refpk:t[e.refpk],id:t[e.id],values:t,key:t[e.refpk],title:n?t[e.refname]:t[e.refcode]+" "+t[e.refname],children:[],fpid:t[e.fpid]?t[e.fpid]:"root"}}))}if(!s){var l={pid:null,refcode:"root",refname:t||"树根",refpk:"root",id:"root",key:"root",title:t||"树根",fpid:"null"};o.push(l)}return a.syncTree.createTreeData(o)},t.sortTree=function e(t){t.sort(a),t.map((function(t){t.children?e(t.children):t.children=[]}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printTemp=function(e,t,r,n,o,s,c,l,i){if(!o||0===o.length)return!1;var d=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"print",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Card",o=arguments[5],s=arguments[6];return{nodekey:e,oids:t,funcode:a,outputType:r,userjson:JSON.stringify({printType:n,module:o,scaleClazz:s})}}(n,o,e,s,c,l,i);if(!d)return void(0,a.toast)({color:"danger",content:"当前数据不存在"});"print"===e?(0,a.print)(t,r,d):(0,a.output)({url:r,data:d})};var a=r(2)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loginContextKeys=void 0,t.loginContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if(!e)return;var r={},a=e[l];for(var o in i)r[i[o]]=e[i[o]],s&&s[i[o]]&&(r[i[o]]=s[i[o]]);if(a)for(var d in a)r[d]=a[d];n(t,t,r)},t.getContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c;if(s=(0,a.getBusinessInfo)(),e==i.businessDate&&s)return s[i.businessDate];var r=o(t,t);return r?e==i.languageIndex&&"1"==r[e]?"":r[e]:null},t.setContext=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c,a=o(r,r);a?a[e]=t:a=function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}({},e,t);n(r,r,a)};var a=r(2);var n=a.cardCache.setDefData,o=a.cardCache.getDefData,s=(0,a.getBusinessInfo)(),c="default",l="paramMap",i=t.loginContextKeys={mdid:"mdid",org_Name:"org_Name",org_v_Name:"org_v_Name",pk_org:"pk_org",pk_org_v:"pk_org_v",transtype:"transtype",pk_transtype:"pk_transtype",groupId:"groupId",groupName:"groupName",userId:"userId",userName:"userName",userCode:"userCode",businessDate:"businessDate",dataSourceCode:"dataSource",languageIndex:"currentLangSeq",scaleClazz:"scaleClazz",pk_project:"pk_project",project_name:"project_name",project_code:"project_code"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,n=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),o=r(3),s=(a=o)&&a.__esModule?a:{default:a},c=r(2),l=r(0),i=r(1);function d(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var p=c.base.NCTable,u=c.base.NCButton,f=c.base.NCModal,h=i.constant.orgTreeId,m=i.attrcodeObj.pkFinancePrimery,g=i.attrcodeObj.code,v=i.attrcodeObj.name,y=[],b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.deleteRow=function(e,t,a){r.state.tableDatas.splice(a,1);var n=r.state.tableDatas.map((function(e,t){return e.refpk}));r.props.syncTree.setNodeChecked(h,n),r.setState({tableDatas:[].concat(d(r.state.tableDatas)),checkedKey:n,nodes:[]})},r.onCheckEve=function(e,t,a){var n=a.checked,o=a.checkedNodes,s=a.node;a.event;if(!n)if("root"===s.props.refpk)r.setState({checkedKey:[],nodes:[]});else{var c=r.state.checkedKey.indexOf(s.props.refpk);r.state.checkedKey.splice(c,1),r.state.nodes.splice(c,1),r.props.syncTree.cancelSelectedNode(h),r.setState({checkedKey:r.state.checkedKey,nodes:r.state.nodes})}var l=[];if(t.indexOf("root")===t.length-1&&n||y.data.length===t.length&&-1===t.indexOf("root")&&n){var i=y.data.map((function(e,t){return e[m]}));i.push("root"),r.props.syncTree.setNodeChecked(h,i);var p=[];l=y.data.map((function(e,t){if("root"!==e[m]){var r={code:e[g],name:e[v],key:e[m],refcode:e[g],refname:e[v],refpk:e[m],props:e};return p.push({props:r}),r}})),r.setState({checkedKey:i,nodes:p})}else if(y.data.length!==t.length||-1!==t.indexOf("root")||n){var u=t.indexOf("root");-1!==u&&(t.splice(u,1),o.splice(u,1)),r.props.syncTree.setNodeChecked(h,t),l=o.map((function(e,t){return{code:e.props.refcode,name:e.props.refname,key:e.props.refpk,refcode:e.props.refcode,refname:e.props.refname,refpk:e.props.refpk,props:e.props,children:""}})),r.setState({checkedKey:t,nodes:o})}else r.props.syncTree.setNodeChecked(h,[]),l=[];r.setState({tableDatas:[].concat(d(l))})};var a=r;return r.state={showModalT:r.props.showModalT,table:{main:r,rowKey:"id",scroll:{y:390,x:!1},columns:[{title:"组织编码",dataIndex:"code",width:"40%"},{title:"组织名称",dataIndex:"name",width:"40%"},{title:"操作",dataIndex:"opr",key:"opr",width:100,fixed:"right",itemtype:"customer",className:"table-opr",render:function(e,t,r){return s.default.createElement("div",{className:"operation-btn"},s.default.createElement(u,{onClick:function(){return a.deleteRow(e,t,r)}},"删除"))}}]},tableDatas:[],checkedKey:[],nodes:[]},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.showModalT&&e.showModalT!==this.props.showModalT&&(y=l.queryFinanceOrg.call(this),this.setState({tableDatas:[]},(function(){var e;e=t.state.tableDatas.map((function(e,t){return e.refpk})),t.props.syncTree.setNodeChecked(h,e)})))}},{key:"render",value:function(){var e=this;return s.default.createElement("div",null,s.default.createElement(f,{show:this.props.showModalT,onHide:function(){return e.props.setProps("cancel")},size:"xlg"},s.default.createElement(f.Header,{closeButton:!0},s.default.createElement(f.Title,null,"选择分配目标")),s.default.createElement(f.Body,null,s.default.createElement("div",{className:"transfer_tree_container",type:"ncdiv",style:{marginTop:10,display:"flex",justifyContent:"space-between"}},s.default.createElement("div",{className:"left-area area-common"},s.default.createElement("div",{fieldname:"财务组织",className:"left-area-nei"},s.default.createElement("div",{className:"tree-area"},this.props.syncTree.createSyncTree({treeId:h,showModal:!1,checkable:!0,onCheckEve:this.onCheckEve,needEdit:!1,checkedKeys:!1,needSearch:!1,onSelectEve:function(t,r,a,n){-1===e.state.checkedKey.indexOf(t)&&(e.state.checkedKey.push(t),e.state.nodes.push(n.selectedNodes[0]),e.setState({checkedKey:e.state.checkedKey,nodes:e.state.nodes},(function(){e.onCheckEve(e.props,[].concat(d(e.state.checkedKey)),{checked:n.selected,checkedNodes:e.state.nodes,node:n.node})})))}})))),s.default.createElement("div",{className:"right-area  area-common"},s.default.createElement(p,{table:this.state.table,columns:this.state.table.columns,data:this.state.tableDatas})))),s.default.createElement(f.Footer,null,s.default.createElement(u,{onClick:function(){return e.props.setProps("next",e.state.tableDatas)},colors:"primary"},"下一步"),s.default.createElement(u,{onClick:function(){return e.props.setProps("cancel")},style:{marginRight:50}},"取消"))))}}]),t}(o.Component);t.default=b,t.default=b=(0,c.createPage)({initTemplate:""})(b),ReactDOM.render(s.default.createElement(b,null),document.querySelector("#app"))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,n,o,s=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),c=r(3),l=(o=c)&&o.__esModule?o:{default:o},i=r(2),d=r(0);r(15);var p=r(1);function u(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var f=i.base.NCButton,h=i.base.NCModal,m=[],g=(a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.call(r),r.state={targetKeys:[],showModalT:r.props.showModalT,modalSize:"",datasource:[].concat(m),selectNodes:[],selectNodesRightTree:[],disabledMoveAllTR:!0},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.showModalT&&e.showModalT!==this.props.showModalT&&this.setState({selectNodes:[],datasource:[],selectNodesRightTree:[],targetKeys:[]},(function(){var e=[].concat(u(t.state.datasource));e=t.props.queryTree.call(t);var r={pid:null,refcode:"root",refname:"CBS",refpk:"root",id:"root",key:"root",title:"CBS"};t.props.that.props.syncTree.setNodeChecked("leftTree",[r]),t.props.syncTree.setSyncTreeData("rightTree",[r]);var a=!0;e[0].children&&0!==e[0].children.length||(e=[],a=!1),t.setState({datasource:JSON.parse(JSON.stringify(e)),disabledMoveAllTR:a})}))}},{key:"render",value:function(){var e=this,t=this.props.syncTree.getSyncTreeValue("rightTree");return l.default.createElement("div",{className:"modal-content-resizeWrap-parent"},l.default.createElement(h,{show:this.props.showModalT,onHide:function(){return e.props.setProps("importCacel")},size:"xlg"},l.default.createElement(h.Header,{closeButton:!0},l.default.createElement(h.Title,null,"数据选择")),l.default.createElement(h.Body,null,l.default.createElement("div",{className:"transfer_tree_container",type:"ncdiv",style:{marginTop:10,display:"flex",justifyContent:"space-between"}},l.default.createElement("div",{fieldname:"cbs-集团",className:"left-area-nei",style:{width:"45%"}},l.default.createElement("div",{className:"tree-area"},this.props.that&&this.props.that.props.syncTree.createSyncTree({treeId:"leftTree",showModal:!1,checkable:!0,onCheckEve:this.selectNode.bind(this.props.that),needEdit:!1,checkedKeys:!1,needSearch:!1,defaultExpandAll:!0}))),l.default.createElement("div",{style:{width:"5%",marginLeft:"2.5%",flexDirection:"column",alignSelf:"center"}},this.state.selectNodes.length>0?l.default.createElement("div",{className:"cus-btn checkedStyle",onClick:this.moveToRight.bind(this.props.that)},">"):l.default.createElement("div",{className:"cus-btn nocheckedStyle"},">"),this.state.disabledMoveAllTR?l.default.createElement("div",{className:"cus-btn checkedStyle",onClick:this.moveAllToRight.bind(this.props.that)},">>"):l.default.createElement("div",{className:"cus-btn nocheckedStyle"},">>"),this.state.selectNodesRightTree.length>0?l.default.createElement("div",{className:"cus-btn checkedStyle",onClick:this.moveToLeft.bind(this.props.that)},"<"):l.default.createElement("div",{className:"cus-btn nocheckedStyle"},"<"),t&&t[0]&&t[0].children&&t[0].children.length>0?l.default.createElement("div",{className:"cus-btn checkedStyle",onClick:this.moveAllToLeft.bind(this.props.that)},"<<"):l.default.createElement("div",{className:"cus-btn nocheckedStyle"},"<<")),l.default.createElement("div",{fieldname:"cbs-集团",className:"left-area-nei",style:{width:"45%"}},l.default.createElement("div",{className:"tree-area"},this.props.syncTree.createSyncTree({treeId:"rightTree",showModal:!1,checkable:!0,onCheckEve:this.selectNodeRightTree.bind(this.props.that),needEdit:!1,checkedKeys:!1,needSearch:!1,defaultExpandAll:!0}))))),l.default.createElement(h.Footer,null,l.default.createElement(f,{onClick:function(){return e.props.setProps("import",e.props.tableArr,e.beSureClick)},colors:"primary"},"确定"),l.default.createElement(f,{onClick:function(){return e.props.setProps("importCacel")},style:{marginRight:50}},"取消"))))}}]),t}(c.Component),n=function(){var e=this;this.findRepeatedNode=function(e,t){var r=!1;return e.map((function(e,a){e.refpk===t&&(r=!0)})),r},this.mapTreeData=function(t,r,a,n,o,s,c){return t.map((function(t,l){if(a)if(n){if(-1!==r.indexOf(t.props?t.props[o]:t[o]))return;r.push(t.props?t.props[o]:t[o])}else r.push(t.props?t.props[o]:t[o]);else{var i="";if(s.length>0)s&&(i=t.props&&t.props.fpid?t.props.fpid:t.fpid,-1!==s.indexOf(i)&&t.pid!==i?t.pid=i:-1===s.indexOf(i)&&(t.pid="root")),e.findRepeatedNode(r,t.props?t.props.refpk:t.refpk)||r.push(t);else r.push(t)}c&&t.children&&t.children.length>0&&e.mapTreeData(t.children,r,a,n,o,s,c)})),r},this.moveToRight=function(){var t=e.props.syncTree.getSyncTreeValue("rightTree")[0].children,r=e.props.that.props.syncTree.getSyncTreeValue("leftTree")[0].children,a=[],n=[],o=[],s=[];t?(s=e.mapTreeData(t,a,!1,!1,"",[],!0),n=e.state.selectNodes.concat(s)):n=e.state.selectNodes,o=e.mapTreeData(n,[],!0,!1,"refpk"),a=e.mapTreeData(n,[],!1,!1,"",o,!1);var c=d.transformToTree.call(e,{pid:"pid",refcode:"refcode",refname:"refname",refpk:"refpk",id:"id",values:{},fpid:"fpid"},"CBS-集团",a,e.props,!0);(0,d.sortTree)(c),e.props.syncTree.setSyncTreeData("rightTree",c),o=e.mapTreeData(n,[],!0,!0,"refpk",[],!1),e.state.selectNodes.map((function(t,r){e.props.that.props.syncTree.setNodeDisable("leftTree",!0,t.refpk)})),e.mapTreeData(r,[],!1,!1,"",[],!0).length>a.length-1?e.setState({disabledMoveAllTR:!0}):e.setState({disabledMoveAllTR:!1}),e.props.syncTree.setNodeChecked("rightTree",[]),e.props.that.props.syncTree.setNodeChecked("leftTree",[]),e.props.syncTree.cancelSelectedNode("rightTree"),e.props.that.props.syncTree.cancelSelectedNode("leftTree"),e.setState({selectNodes:[],targetKeys:o})},this.handleMovedData=function(t){var r=JSON.parse(JSON.stringify(e.state.datasource));e.mapTreeData([].concat(u(r)),[],!1,!1,"",[],!0).map((function(r,a){e.props.that.props.syncTree.setNodeDisable("leftTree",t,r.refpk)})),e.props.syncTree.setNodeChecked("rightTree",[]),e.props.that.props.syncTree.setNodeChecked("leftTree",[]),e.props.syncTree.cancelSelectedNode("rightTree"),e.props.that.props.syncTree.cancelSelectedNode("leftTree"),e.setState({selectNodes:[],selectNodesRightTree:[]})},this.moveAllToRight=function(){var t,r,a=JSON.parse(JSON.stringify(e.state.datasource));e.props.syncTree.setSyncTreeData("rightTree",a),e.handleMovedData(!0),t=e.mapTreeData(a[0].children,[],!1,!1,"",[],!0),r=e.mapTreeData(t,[],!0,!0,"refpk",[],!1),e.setState({disabledMoveAllTR:!1,targetKeys:r})},this.moveAllToLeft=function(){var t=JSON.parse(JSON.stringify(e.state.datasource));e.props.that.props.syncTree.setSyncTreeData("leftTree",t),e.handleMovedData(!1),e.props.syncTree.setSyncTreeData("rightTree",[{pid:null,refcode:"root",refname:"CBS",refpk:"root",id:"root",key:"root",title:"CBS"}]),e.setState({disabledMoveAllTR:!0})},this.moveToLeft=function(){var t=[],r=[],a=e.props.syncTree.getSyncTreeValue("rightTree")[0].children,n=e.props.that.props.syncTree.getSyncTreeValue("leftTree")[0].children;t=e.mapTreeData(a,[],!0,!1,"refpk",[],!0),r=e.mapTreeData(a,[],!1,!1,"",[],!0),e.state.selectNodesRightTree.map((function(a,n){var o=t.indexOf(a.refpk);e.props.that.props.syncTree.setNodeDisable("leftTree",!1,a.refpk),e.props.syncTree.delNodeSuceess("rightTree",a.refpk),-1!==o&&(t.splice(o,1),r.splice(o,1))})),r=e.mapTreeData(r,[],!1,!1,"",t);var o=d.transformToTree.call(e,{pid:"pid",refcode:"refcode",refname:"refname",refpk:"refpk",id:"id",values:{},fpid:"fpid"},"CBS-集团",r,e.props,!0);(0,d.sortTree)(o),e.props.syncTree.setSyncTreeData("rightTree",o),0===a.length&&e.props.syncTree.setSyncTreeData("rightTree",[{pid:null,refcode:"root",refname:"CBS",refpk:"root",id:"root",key:"root",title:"CBS"}]),e.props.syncTree.setNodeChecked("rightTree",[]),e.props.that.props.syncTree.setNodeChecked("leftTree",[]),e.props.syncTree.cancelSelectedNode("rightTree"),e.props.that.props.syncTree.cancelSelectedNode("leftTree"),e.mapTreeData(n,[],!1,!1,"",t,!0).length>r.length-1?e.setState({disabledMoveAllTR:!0}):e.setState({disabledMoveAllTR:!1}),e.setState({selectNodesRightTree:[]})},this.beSureClick=function(){if(0===e.state.targetKeys.length)return(0,d.showToast)(p.toastConfig,"cbsWaring"),!1;var t=e.props.tableArr.map((function(e,t){return e.key})),r={pk_financeorg:[].concat(u(t)),pk_cbs:[].concat(u(e.state.targetKeys)),pk_project:e.props.pkProjectValueRef};return"cancelAssign"===e.props.type?d.cancelCBSAssign.call(e,r):"assign"===e.props.type?d.doCBSAssign.call(e,r):"import"===e.props.type&&d.importFunc.call(e.props.that,r),!0},this.selectNode=function(t,r,a){var n=a.checked,o=a.checkedNodes,s=a.node,c=a.event;if(!n){var l=[].concat(u(e.state.selectNodes));return e.state.selectNodes.map((function(e,t){e.refpk===s.props.refpk&&l.splice(t,1)})),void e.setState({selectNodes:l})}var i=e.state.selectNodes;i.push(s.props),e.setState({selectNodes:i},(function(){s.props.children&&s.props.children.map((function(a,l){e.props.that.props.syncTree.setNodeSelected("leftTree",a.key),r.push(a.key),o.push(a),s=a,e.selectNode.call(e,t,r,{checked:n,checkedNodes:o,node:s,event:c})}))}))},this.selectNodeRightTree=function(t,r,a){var n=a.checked,o=a.checkedNodes,s=a.node,c=a.event;if(!n){var l=[].concat(u(e.state.selectNodesRightTree));return e.state.selectNodesRightTree.map((function(e,t){e.refpk===s.props.refpk&&l.splice(t,1)})),void e.setState({selectNodesRightTree:l})}var i=e.state.selectNodesRightTree;i.push(s.props),e.setState({selectNodesRightTree:i},(function(){s.props.children&&s.props.children.map((function(a,l){e.props.syncTree.setNodeSelected("rightTree",a.key),r.push(a.key),o.push(a),s=a,e.selectNodeRightTree.call(e,t,r,{checked:n,checkedNodes:o,node:s,event:c})}))}))}},a);t.default=g,t.default=g=(0,i.createPage)({initTemplate:""})(g),ReactDOM.render(l.default.createElement(g,null),document.querySelector("#app"))},function(e,t,r){var a=r(16);"string"==typeof a&&(a=[[e.i,a,""]]);var n={transform:void 0};r(18)(a,n);a.locals&&(e.exports=a.locals)},function(e,t,r){(e.exports=r(17)(!1)).push([e.i,".u-modal-open .nc-modal.u-modal .u-modal-dialog .modal-content-resizeWrap-parent {\n  height: 100%;\n  width: auto;\n  overflow: visible;\n}\n.transfer-wrap .u-transfer {\n  height: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.transfer-wrap .u-transfer .u-transfer-list {\n  -webkit-box-flex: 3;\n  -ms-flex: 3;\n  flex: 3;\n  height: 100%;\n  -webkit-box-shadow: 0 0 0 10px rgba(0, 0, 0, 0.001);\n  box-shadow: 0 0 0 10px rgba(0, 0, 0, 0.001);\n  border: 1px solid rgba(0, 0, 0, 0.001);\n  border-radius: 0;\n}\n.transfer-wrap .u-transfer .u-transfer-operation {\n  border: none;\n  border-radius: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.transfer-wrap .u-transfer .u-transfer-operation button {\n  top: 10px;\n}\n.transfer-wrap .u-transfer .u-transfer-operation button:nth-child(1) {\n  margin-top: 0px;\n}\n.mustFillIn_search {\n  position: relative;\n  left: 8px;\n  z-index: 2;\n  color: #ff0000;\n}\n.refer {\n  width: 200px;\n  float: left;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.u-table-content {\n  position: relative;\n  background-color: rgba(0, 0, 0, 0.001);\n  border-right: none;\n  border-left: none;\n  height: 330px;\n  overflow: auto;\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.area-common {\n  padding: 10px;\n  background: rgba(0, 0, 0, 0.001);\n  margin: 10px ;\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.u-table {\n  width: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\ndiv .nc-button-wrapper,\ndiv .u-button {\n  height: 29px;\n}\n.transfer-wrap .u-transfer .u-transfer-list .u-transfer-list-body .u-transfer-list-body-search-wrapper {\n  height: 40px;\n  padding: 5px 14px;\n}\n.transfer-main {\n  clear: both;\n  height: 410px;\n  width: 100%;\n  overflow: auto;\n  min-height: 300px;\n  border: none!important;\n  padding: 10px 5px;\n}\n.transfer-wrap .u-transfer .u-transfer-list .u-transfer-list-body .u-transfer-list-content {\n  overflow: auto;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: self-end;\n      -ms-flex-align: self-end;\n          align-items: self-end;\n}\n.tree-area {\n  position: relative;\n  background-color: transparent;\n  border-right: none;\n  border-left: none;\n  height: 330px;\n  overflow: auto;\n  -webkit-box-flex: 1;\n  -ms-flex: 1;\n  flex: 1;\n}\n.left-area-nei {\n  background: rgba(0, 0, 0, 0.001);\n  -webkit-box-flex: 1;\n  -ms-flex: 1;\n  flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n}\n.cus-btn {\n  height: 25px;\n  width: 25px;\n  border-radius: 3px;\n  text-align: center;\n  font-size: 15px;\n  margin-bottom: 5px;\n  font-weight: 400;\n}\n.checkedStyle {\n  background: #fff ;\n  color: #4A4A4A;\n  border: 1px solid #9B9B9B ;\n}\n.nocheckedStyle {\n  background: #D8D8D8 ;\n  color: #9B9B9B;\n  border: 1px solid #9B9B9B;\n}\n",""])},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",a=e[3];if(!a)return r;if(t&&"function"==typeof btoa){var n=(s=a,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),o=a.sources.map((function(e){return"/*# sourceURL="+a.sourceRoot+e+" */"}));return[r].concat(o).concat([n]).join("\n")}var s;return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r})).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var a={},n=0;n<this.length;n++){var o=this[n][0];"number"==typeof o&&(a[o]=!0)}for(n=0;n<e.length;n++){var s=e[n];"number"==typeof s[0]&&a[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),t.push(s))}},t}},function(e,t,r){var a,n,o={},s=(a=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=a.apply(this,arguments)),n}),c=function(e){var t={};return function(r){return void 0===t[r]&&(t[r]=e.call(this,r)),t[r]}}((function(e){return document.querySelector(e)})),l=null,i=0,d=[],p=r(19);function u(e,t){for(var r=0;r<e.length;r++){var a=e[r],n=o[a.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](a.parts[s]);for(;s<a.parts.length;s++)n.parts.push(y(a.parts[s],t))}else{var c=[];for(s=0;s<a.parts.length;s++)c.push(y(a.parts[s],t));o[a.id]={id:a.id,refs:1,parts:c}}}}function f(e,t){for(var r=[],a={},n=0;n<e.length;n++){var o=e[n],s=t.base?o[0]+t.base:o[0],c={css:o[1],media:o[2],sourceMap:o[3]};a[s]?a[s].parts.push(c):r.push(a[s]={id:s,parts:[c]})}return r}function h(e,t){var r=c(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var a=d[d.length-1];if("top"===e.insertAt)a?a.nextSibling?r.insertBefore(t,a.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),d.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(t)}}function m(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=d.indexOf(e);t>=0&&d.splice(t,1)}function g(e){var t=document.createElement("style");return e.attrs.type="text/css",v(t,e.attrs),h(e,t),t}function v(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}function y(e,t){var r,a,n,o;if(t.transform&&e.css){if(!(o=t.transform(e.css)))return function(){};e.css=o}if(t.singleton){var s=i++;r=l||(l=g(t)),a=k.bind(null,r,s,!1),n=k.bind(null,r,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",v(t,e.attrs),h(e,t),t}(t),a=C.bind(null,r,t),n=function(){m(r),r.href&&URL.revokeObjectURL(r.href)}):(r=g(t),a=T.bind(null,r),n=function(){m(r)});return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=f(e,t);return u(r,t),function(e){for(var a=[],n=0;n<r.length;n++){var s=r[n];(c=o[s.id]).refs--,a.push(c)}e&&u(f(e,t),t);for(n=0;n<a.length;n++){var c;if(0===(c=a[n]).refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete o[c.id]}}}};var b,S=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function k(e,t,r,a){var n=r?"":a.css;if(e.styleSheet)e.styleSheet.cssText=S(t,n);else{var o=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function T(e,t){var r=t.css,a=t.media;if(a&&e.setAttribute("media",a),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function C(e,t,r){var a=r.css,n=r.sourceMap,o=void 0===t.convertToAbsoluteUrls&&n;(t.convertToAbsoluteUrls||o)&&(a=p(a)),n&&(a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var s=new Blob([a],{type:"text/css"}),c=e.href;e.href=URL.createObjectURL(s),c&&URL.revokeObjectURL(c)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,a=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var n,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o)?e:(n=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:a+o.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")}))}}])}));
//# sourceMappingURL=index.1aec6fa5.js.map