/*! @ncctag {"project":"","branch":"","provider":"","date":"2020-5-11 15:10:29"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uapbd/taxinfo/taxregion/main/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uapbd/taxinfo/taxregion/main/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,a){return function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=176)}({1:function(t,a){t.exports=e},169:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n,s=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),r=a(2),i=c(r),l=(c(a(3)),a(1));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var d=l.base.NCAffix,p=(l.base.NCPopconfirm,l.base.NCFormControl,l.base.NCBackBtn,l.high.PrintOutput),f=l.cardCache.addCache,b=l.cardCache.getCacheById,h=l.cardCache.updateCache,m=l.cardCache.getCurrentLastId,g=l.cardCache.getNextId,v=l.cardCache.deleteCacheById,T=l.base.NCDiv,E="upabd.taxinfo.taxregion.data",A="taxregion",k="taxregionb",y="10140TAXRE_card",R="search",j="/nccloud/uapbd/taxregion/saveTaxregion.do",C="/nccloud/uapbd/taxregion/updateTaxregion.do",X="pk_taxregion",w="/nccloud/uapbd/taxregion/printTaxregion.do",S=null,B=(o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.call(a),a.formId=A,a.searchId=R,a.tableId=k,a.state={pk_org:"",title_code:"",totalcount:0,applycount:0,backVisible:!0,json:{}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"modifierMeta",value:function(e,t){var a=this,o=e.getUrlParam("status");t[A].status=o,t[k].status=o,console.log(this),t[k].items.map((function(e){"pk_region"==e.attrcode&&(e.queryCondition=function(){return{pk_country:S.value}})})),t.taxregionb_childform1&&(t.taxregionb_childform1.items.find((function(e){return"pk_region"==e.attrcode})).queryCondition=function(){return{pk_country:S.value}}),t.taxregionb_childform2&&(t.taxregionb_childform2.items.find((function(e){return"pk_region"==e.attrcode})).queryCondition=function(){return{pk_country:S.value}});var n={itemtype:"customer",attrcode:"opr",label:this.state.json?this.state.json["10140TAXRE-000000"]:"10140TAXRE-000000",visible:!0,className:"table-opr",width:200,fixed:"right",render:function(t,o,n){return"browse"===e.cardTable.getStatus(k)?i.default.createElement("span",{onClick:function(){e.cardTable.toggleRowView(k,o)}}," ",a.state.json?a.state.json["10140TAXRE-000023"]:"10140TAXRE-000023"):i.default.createElement("div",{className:"currency-opr-col"},i.default.createElement("span",{className:"currency-opr-del",onClick:function(t){e.cardTable.openModel(k,"edit",o,n),t.stopPropagation()}},a.state.json?a.state.json["10140TAXRE-000024"]:"10140TAXRE-000024"),"  ",i.default.createElement("span",{className:"currency-opr-del",onClick:function(t){e.cardTable.delRowsByIndex(k,n),t.stopPropagation()}},a.state.json?a.state.json["10140TAXRE-000025"]:"10140TAXRE-000025"))}};return t[k].items.push(n),t}},{key:"componentDidMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"10140TAXRE",domainName:"uapbd",callback:function(t){e.setState({json:t},(function(){e.initTemplate(e.props)}))}}),this.toggleShow(),this.updateCardTableBtnStatus();var t=this.props.getUrlParam("status");if("add"!=t){var a=this.props.getUrlParam("id");a&&"undefined"!=a&&this.getdata(a)}else this.setDefaultValue();"add"!=t&&"edit"!=t||this.setState({backVisible:!1})}},{key:"componentWillUnmount",value:function(){S=null}},{key:"toggleShow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=this.props.getUrlParam("status"),a=this.props.getUrlParam("id"),o=[],n=[];"browse"==t&&"null"==a?(o=["Add"],n=["SaveAdd","Edit","back","Delete","Refresh","Enable","Disable","Print","Output","Save","Cancel","AddLine","DelLine"]):"edit"==t||"add"==t?(n=["Edit","Add","back","Delete","Refresh","Enable","Disable","Print","Output"],o=["Save","Cancel","AddLine","DelLine"],"add"==t?o.push("SaveAdd"):n.push("SaveAdd"),this.props.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1)):(n=["Save","Cancel","AddLine","DelLine","SaveAdd"],o=["Add","Edit","Delete","back","Refresh","Print","Output"],2==e?(o.push("Disable"),n.push("Enable")):(o.push("Enable"),n.push("Disable")),this.props.cardPagination.setCardPaginationVisible("cardPaginationBtn",!0)),this.props.form.setFormStatus(A,t),this.props.cardTable.setStatus(k,"edit"==t||"add"==t?"edit":"browse"),this.props.button.setButtonVisible(n,!1),this.props.button.setButtonVisible(o,!0),this.updateCardTableBtnStatus(),window.onbeforeunload="add"!=t&&"edit"!=t?null:function(){return""}}},{key:"output",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];t.push(this.props.getUrlParam("id")),""!=e&&(0,l.print)("pdf",w,{funcode:"10140TAXRE",nodekey:"card",oids:t,outputType:e})}},{key:"cancelSureEvent",value:function(){var e=this;if("add"===this.props.getUrlParam("status")){var t=m(E);this.getDataForCache(t,(function(){e.props.pushTo("/card",{status:"browse",pagecode:"10140TAXRE_card",id:e.props.getUrlParam("id")}),e.props.form.setFormStatus(e.formId,"browse"),e.props.cardTable.setStatus(e.tableId,"browse")}))}if("edit"===this.props.getUrlParam("status")){this.props.form.cancel(this.formId),this.props.cardTable.resetTableData(this.tableId),this.props.pushTo("/card",{status:"browse",pagecode:"10140TAXRE_card",id:this.props.getUrlParam("id")});var a=this.props.form.getFormItemsValue(this.formId,"enablestate");this.toggleShow(a.value)}this.setState({backVisible:!0})}},{key:"afterEvent",value:function(e,t,a,o,n){if("pk_country"==a&&o.value!=n.value){var s=e.meta.getMeta();s[k].items.map((function(e){"pk_region"==e.attrcode&&(e.queryCondition=function(){return{pk_country:o.value}})})),s.taxregionb_childform1.items.find((function(e){return"pk_region"==e.attrcode})).queryCondition=function(){return{pk_country:o.value}},s.taxregionb_childform2.items.find((function(e){return"pk_region"==e.attrcode})).queryCondition=function(){return{pk_country:o.value}}}}},{key:"onCardTableAfterEvent",value:function(e,t,a,o,n,s,r){if(console.log(n),console.log(r),n[0].newvalue.value!=n[0].oldvalue.value){var i={};i.value=r.values.pk_region.value,i.display=o.refname,e.cardTable.setValByKeyAndIndex(this.tableId,s,"pk_region.name",i),r.values.pk_region.display=o.refcode}}},{key:"getDataForCache",value:function(e,t){if(!e)return this.props.setUrlParam({id:"null",status:"browse"}),void this.toggleShow();var a=b(e,E);if(a?(this.props.form.setAllFormValue(u({},A,a.head[A])),a.body&&a.body[k]?this.props.cardTable.setTableData(k,a.body[k]):this.props.cardTable.setTableData(k,{rows:[]}),this.props.setUrlParam(e)):(this.getdata(e),this.props.setUrlParam(e)),t&&"function"==typeof t&&t.call(this),a){var o=a.head[A].rows[0].values.enablestate.value;this.toggleShow(o)}}},{key:"updateCardTableBtnStatus",value:function(){var e=this.props.cardTable.getCheckedRows(this.tableId),t=this.props.getUrlParam("status");t="add"==t||"edit"==t?"edit":"browse",e.length>0&&"edit"==t?this.props.button.setButtonDisabled(["DelLine"],!1):this.props.button.setButtonDisabled(["DelLine"],!0)}},{key:"changeEnableClick",value:function(){var e=this;(0,l.ajax)({url:"/nccloud/uapbd/taxregion/changeEnableTaxregion.do",data:{id:this.props.getUrlParam("id")},success:function(t){e.getdata(e.props.getUrlParam("id"),(function(){e.enableClick?(0,l.toast)({color:"success",title:e.state.json["10140TAXRE-000020"]}):(0,l.toast)({color:"success",title:e.state.json["10140TAXRE-000021"]})}))}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.cardTable,o=t.form,n=t.button,s=t.modal,r=t.cardPagination,l=t.BillHeadInfo.createBillHeadInfo,c=r.createCardPagination,u=o.createForm,f=a.createCardTable,b=n.createButtonApp,h=s.createModal,m=this.props.getUrlParam("status");return i.default.createElement("div",{className:"nc-bill-card"},i.default.createElement("div",{className:"nc-bill-top-area"},i.default.createElement(d,null,i.default.createElement(T,{areaCode:T.config.HEADER,className:"nc-bill-header-area"},i.default.createElement("div",{className:"header-title-search-area"},l({title:this.state.json?this.state.json["10140TAXRE-000029"]:"10140TAXRE-000029"+m=="browse"?"："+this.state.title_code:"",backBtnClick:function(){e.props.pushTo("/list",{pagecode:"10140TAXRE_list"})}})),i.default.createElement("div",{className:"header-button-area"},b({area:"header-action",onButtonClick:this.buttonClick.bind(this)}),c({handlePageInfoChange:this.pageInfoClick.bind(this),dataSource:E})))),i.default.createElement("div",{className:"nc-bill-form-area"},u(this.formId,{onAfterEvent:this.afterEvent.bind(this)}))),i.default.createElement("div",{className:"nc-bill-bottom-area"},i.default.createElement("div",{className:"nc-bill-table-area"},f(this.tableId,{tableHead:this.getTableHead.bind(this),modelSave:this.modelSave.bind(this),onAfterEvent:this.onCardTableAfterEvent.bind(this),showIndex:!0,showCheck:!0,onSelected:this.updateCardTableBtnStatus.bind(this),onSelectedAll:this.updateCardTableBtnStatus.bind(this)}))),h("delete",{title:this.state.json?this.state.json["10140TAXRE-000004"]:"10140TAXRE-000004",content:this.state.json?this.state.json["10140TAXRE-000005"]:"10140TAXRE-000005",beSureBtnClick:this.delConfirm.bind(this)}),h("cancel",{title:this.state.json?this.state.json["10140TAXRE-000008"]:"10140TAXRE-000008",content:this.state.json?this.state.json["10140TAXRE-000009"]:"10140TAXRE-000009",beSureBtnClick:this.cancelSureEvent.bind(this)}),h("enable",{title:this.state.json?this.state.json["10140TAXRE-000014"]:"10140TAXRE-000014",content:this.state.json?this.state.json["10140TAXRE-000015"]:"10140TAXRE-000015",beSureBtnClick:this.changeEnableClick.bind(this)}),h("disable",{title:this.state.json?this.state.json["10140TAXRE-000016"]:"10140TAXRE-000016",content:this.state.json?this.state.json["10140TAXRE-000017"]:"10140TAXRE-000017",beSureBtnClick:this.changeEnableClick.bind(this)}),i.default.createElement(p,{ref:"printOutput",url:w,data:{funcode:"10140TAXRE",nodekey:"card",oids:this.state.pks,outputType:"output"}}))}}]),t}(r.Component),n=function(){var e=this;this.initTemplate=function(t){t.createUIDom({pagecode:y},(function(a){if(a){if(a.template){var o=a.template;e.modifierMeta(t,o),t.meta.setMeta(o)}if(a.button){var n=a.button;t.button.setButtons(n),e.toggleShow()}}}))},this.setDefaultValue=function(){e.props.form.setFormItemsValue(e.formId,{bill_status:{value:"0",display:e.state.json["10140TAXRE-000001"]}}),e.props.form.setFormItemsValue(e.formId,{enablestate:{value:"2",display:e.state.json["10140TAXRE-000002"]}}),e.props.form.setFormItemsValue(e.formId,{dataoriginflag:{value:"0",display:e.state.json["10140TAXRE-000003"]}})},this.buttonClick=function(t,a){switch(a){case"Add":t.form.EmptyAllFormValue(e.formId),t.form.setFormStatus(e.formId,"add"),e.setState({backVisible:!1},(function(){t.cardTable.setTableData(e.tableId,{rows:[]}),t.pushTo("/card",{pagecode:"10140TAXRE_card",status:"add"}),e.setDefaultValue(),e.toggleShow()}));break;case"Edit":t.pushTo("/card",{status:"edit",pagecode:"10140TAXRE_card",id:t.getUrlParam("id")}),e.toggleShow();var o=e.props.form.getFormItemsValue(e.formId,"pk_country");o=o||S;var n=t.meta.getMeta();n[k].items.map((function(e){"pk_region"==e.attrcode&&(e.queryCondition=function(){return{pk_country:o.value}})})),n.taxregionb_childform1.items.find((function(e){return"pk_region"==e.attrcode})).queryCondition=function(){return{pk_country:o.value}},n.taxregionb_childform2.items.find((function(e){return"pk_region"==e.attrcode})).queryCondition=function(){return{pk_country:o.value}},e.setState({backVisible:!1});break;case"Delete":(0,l.promptBox)({color:"warning",title:e.state.json["10140TAXRE-000004"],content:e.state.json["10140TAXRE-000005"],noFooter:!1,noCancelBtn:!1,beSureBtnName:e.state.json["10140TAXRE-000006"],cancelBtnName:e.state.json["10140TAXRE-000007"],beSureBtnClick:e.delConfirm.bind(e)});break;case"Back":t.pushTo("/list",{pagecode:"10140TAXRE_list"});break;case"Save":e.saveClick();break;case"Cancel":(0,l.promptBox)({color:"warning",title:e.state.json["10140TAXRE-000008"],content:e.state.json["10140TAXRE-000009"],noFooter:!1,noCancelBtn:!1,beSureBtnName:e.state.json["10140TAXRE-000006"],cancelBtnName:e.state.json["10140TAXRE-000007"],beSureBtnClick:e.cancelSureEvent.bind(e)});break;case"AddLine":var s=[e.state.json["10140TAXRE-000010"],e.state.json["10140TAXRE-000011"],e.state.json["10140TAXRE-000012"]],r=e.props.form.getFormItemsValue(e.formId,["pk_country","code","name"]),i=!0;r.forEach((function(e,t){null!=e.value&&""!=e.value||(i&&(0,l.toast)({color:"warning",content:s[t]}),i=!1)})),i&&(t.cardTable.addRow(e.tableId),e.toggleShow());break;case"DelLine":var c=t.cardTable.getCheckedRows(e.tableId),u=[];c.forEach((function(e){u.push(e.index)})),t.cardTable.delRowsByIndex(e.tableId,u),e.updateCardTableBtnStatus();break;case"Refresh":e.getdata(e.props.getUrlParam("id"),(function(){(0,l.toast)({title:e.state.json["10140TAXRE-000013"],color:"success"})}));break;case"Print":e.output("print");break;case"Output":var d=[];d.push(e.props.getUrlParam("id")),e.setState({pks:d},(function(){e.refs.printOutput.open()}));break;case"Enable":e.enableClick=!0,(0,l.promptBox)({color:"warning",title:e.state.json["10140TAXRE-000014"],content:e.state.json["10140TAXRE-000015"],noFooter:!1,noCancelBtn:!1,beSureBtnName:e.state.json["10140TAXRE-000006"],cancelBtnName:e.state.json["10140TAXRE-000007"],beSureBtnClick:e.changeEnableClick.bind(e)});break;case"Disable":e.enableClick=!1,(0,l.promptBox)({color:"warning",title:e.state.json["10140TAXRE-000016"],content:e.state.json["10140TAXRE-000017"],noFooter:!1,noCancelBtn:!1,beSureBtnName:e.state.json["10140TAXRE-000006"],cancelBtnName:e.state.json["10140TAXRE-000007"],beSureBtnClick:e.changeEnableClick.bind(e)});break;case"SaveAdd":e.saveClick(!0)}},this.pageInfoClick=function(t,a){e.getDataForCache(a)},this.getdata=function(t,a){var o={pk:t};(0,l.ajax)({url:"/nccloud/uapbd/taxregion/queryTaxregionCard.do",data:o,success:function(t){if(t.data.head){e.props.form.setAllFormValue(u({},e.formId,t.data.head[e.formId]));var o=t.data.head[e.formId].rows[0].values.code.value;e.setState({title_code:o});var n=t.data.head[e.formId].rows[0].values.enablestate.value;2==n?(e.props.button.setButtonVisible(["Disable"],!0),e.props.button.setButtonVisible(["Enable"],!1)):3==n&&(e.props.button.setButtonVisible(["Disable"],!1),e.props.button.setButtonVisible(["Enable"],!0)),e.toggleShow(n);var s=t.data.head[e.formId].rows[0].values.pk_country,r=e.props.meta.getMeta();r&&r[k]?(console.log("modifierMeta in getData"),r[k].items.map((function(e){"pk_region"==e.attrcode&&(e.queryCondition=function(){return{pk_country:s.value}})})),r.taxregionb_childform1.items.find((function(e){return"pk_region"==e.attrcode})).queryCondition=function(){return{pk_country:s.value}},r.taxregionb_childform2.items.find((function(e){return"pk_region"==e.attrcode})).queryCondition=function(){return{pk_country:s.value}},e.props.meta.setMeta(r)):S=s,h(X,t.data.head[A].rows[0].values[X].value,t.data,A,E)}if(t.data.body){e.props.cardTable.setTableData(e.tableId,t.data.body[e.tableId]);var i=e.props.cardTable.getNumberOfRows(e.tableId);e.props.cardTable.getAllRows(e.tableId);e.setState({applycount:0}),e.setState({totalcount:i})}else e.props.cardTable.setTableData(e.tableId,{rows:[]});var l;t.formulamsg&&t.formulamsg instanceof Array&&t.formulamsg.length>0&&e.props.dealFormulamsg(t.formulamsg,(u(l={},A,"form"),u(l,k,"cardTable"),l));a&&"function"==typeof a&&a.call(e)}})},this.saveClick=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e.props.form.isCheckNow(e.formId)){var a=e.props.createMasterChildData(y,e.formId,e.tableId);delete a.head[A].rows[0].values.pk_taxregions;var o=j;"edit"===e.props.getUrlParam("status")&&(o=C),e.props.validateToSave(a,(function(){(0,l.ajax)({url:o,data:a,success:function(a){var n=null;if(a.success){if(a.data&&!t){if(a.data.head&&a.data.head[e.formId]){e.props.form.setAllFormValue(u({},e.formId,a.data.head[e.formId])),n=a.data.head[e.formId].rows[0].values[X].value;var s=a.data.head[e.formId].rows[0].values.enablestate.value;2==s?(e.props.button.setButtonVisible(["Disable"],!0),e.props.button.setButtonVisible(["Enable"],!1)):3==s&&(e.props.button.setButtonVisible(["Disable"],!1),e.props.button.setButtonVisible(["Enable"],!0))}a.data.body&&a.data.body[e.tableId]&&e.props.cardTable.setTableData(e.tableId,a.data.body[e.tableId])}else n=a.data.head[e.formId].rows[0].values[X].value;t?(e.props.form.EmptyAllFormValue(e.formId),e.props.form.setFormStatus(e.formId,"add"),e.setState(e.state,(function(){e.setDefaultValue()}))):(e.props.pushTo("/card",{status:"browse",pagecode:"10140TAXRE_card",id:n}),e.toggleShow(),e.setState({backVisible:!0})),o==j?f(n,a.data,e.formId,E):h(X,a.data.head[A].rows[0].values[X].value,a.data,A,E),(0,l.toast)({content:e.state.json["10140TAXRE-000018"],color:"success"})}}})}),u({head:A},k,"cardTable"))}},this.delConfirm=function(){(0,l.ajax)({url:"/nccloud/uapbd/taxregion/delTaxregion.do",data:{id:e.props.getUrlParam("id"),ts:e.props.form.getFormItemsValue(e.formId,"ts").value},success:function(t){if(t){var a=e.props.getUrlParam("id"),o=g(a,E);v(X,a,E),e.getDataForCache(o,(function(){(0,l.toast)({color:"success",title:e.state.json["10140TAXRE-000019"]})}))}}})},this.modelSave=function(t){t.cardTable.closeModel(e.tableId),e.saveClick()},this.getButtonNames=function(e){return"edit"===e||"add"===e||"save"===e?"main-button":"secondary - button"},this.getTableHead=function(){var t=e.props.button.createButtonApp,a=(e.props.button.getButtons(),e.props.getUrlParam("status"));return i.default.createElement("div",{className:"shoulder-definition-area"},i.default.createElement("div",{className:"definition-search"},"browse"==a?i.default.createElement("div",null,i.default.createElement("span",{className:"definition-search-title"},e.state.json?e.state.json["10140TAXRE-000026"]:"10140TAXRE-000026"," | ",e.state.json?e.state.json["10140TAXRE-000027"]:"10140TAXRE-000027","："),i.default.createElement("span",{className:"count"},e.state.totalcount),i.default.createElement("span",null,e.state.json?e.state.json["10140TAXRE-000028"]:"10140TAXRE-000028")):i.default.createElement("span",{className:"definition-search-title"})),i.default.createElement("div",{className:"definition-icons",style:{padding:"0px"}},t({area:"body-action",onButtonClick:e.buttonClick.bind(e)}),e.props.cardTable.createBrowseIcons(e.tableId,{iconArr:["close","open","max","setCol"],maxDestAreaId:"nc-bill-card"})))}},o);B=(0,l.createPage)({billinfo:{billtype:"card",pagecode:y,headcode:A,bodycode:k},initTemplate:[]})(B),t.default=B},170:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},r=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),i=a(2),l=u(i),c=(u(a(3)),a(1));function u(e){return e&&e.__esModule?e:{default:e}}var d=c.base.NCPopconfirm,p=c.base.NCCheckbox,f=(c.base.NCIcon,c.base.NCTabs.NCTabPane,c.high.PrintOutput),b=c.base.NCDiv,h="10140TAXRE_list",m="taxregionsearch",g="taxregion",v="pk_taxregion",T="/nccloud/uapbd/taxregion/queryTaxregionList.do",E="/nccloud/uapbd/taxregion/delTaxregion.do",A="/nccloud/uapbd/taxregion/printTaxregion.do",k=(o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.call(a),a.searchId=m,a.tableId=g,a.selectedRowRecord=null,a.state={showOffDisable:!1,isShowOff:!1},a.searchVal=null,a.changeEnableInfo={title:"",content:""},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"modifierMeta",value:function(e,t){var a=this;return t[m].items=t[m].items.map((function(e,t){return e.col="3",e})),t[m].items.find((function(e){return"pk_country"==e.attrcode})).isMultiSelectedEnabled=!0,t[g].items=t[g].items.map((function(t,a){return"project_code"==t.attrcode&&(t.render=function(t,a,o){return l.default.createElement("span",{style:{textDecoration:"underline",cursor:"pointer"},onClick:function(){var t=e.search.getAllSearchData(m);c.cacheTools.set("searchParams",t),e.pushTo("/card",{status:"browse",pagecode:"10140TAXRE_card",id:a[v].value})}},a&&a.project_code&&a.project_code.value)}),t})),t[g].items.push({itemtype:"customer",attrcode:"opr",label:this.state.json?this.state.json["10140TAXRE-000000"]:"10140TAXRE-000000",width:200,fixed:"right",className:"table-opr",visible:!0,render:function(t,o,n){return l.default.createElement("span",null,l.default.createElement("span",{style:{cursor:"pointer"},onClick:function(){e.pushTo("/card",{status:"edit",pagecode:"10140TAXRE_card",id:o[v].value})}},a.state.json?a.state.json["10140TAXRE-000038"]:"10140TAXRE-000038"),l.default.createElement("span",null,"   "),l.default.createElement(d,{trigger:"click",placement:"top",content:a.state.json?a.state.json["10140TAXRE-000031"]:"10140TAXRE-000031",onClose:function(){var t=o[v].value;(0,c.ajax)({url:E,data:{id:o[v].value,ts:o.ts.value},success:function(o){o.success&&((0,c.toast)({color:"success",content:a.state.json["10140TAXRE-000032"]}),(0,e.table.deleteCacheId)(g,t),e.table.deleteTableRowsByIndex(g,n))}})}},l.default.createElement("span",{style:{cursor:"pointer"}},a.state.json?a.state.json["10140TAXRE-000025"]:"10140TAXRE-000025")))}}),t}},{key:"componentDidMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"10140TAXRE",domainName:"uapbd",callback:function(t,a,o){a&&e.setState({json:t,inlt:o},(function(){e.initTemplate(e.props)}))}});var t={Enable:!0,Disable:!0};0==this.props.table.getAllTableData(this.tableId).rows.length&&(t.Print=!0,t.Output=!0),this.props.button.setButtonDisabled(t)}},{key:"buttonClick",value:function(e,t){var a=this;switch(t){case"Add":var o=e.search.getAllSearchData(m);c.cacheTools.set("searchParams",o),e.pushTo("/card",{pagecode:"10140TAXRE_card",status:"add"});break;case"Edit":if(o=e.search.getAllSearchData(m),c.cacheTools.set("searchParams",o),null==this.selectedRowRecord)return void(0,c.toast)({content:this.state.json["10140TAXRE-000033"],color:"warning"});e.pushTo("/card",{status:"edit",pagecode:"10140TAXRE_card",id:this.selectedRowRecord[v].value});break;case"Refresh":this.refreshAction(e,!0);break;case"Delete":(0,c.promptBox)({color:"warning",title:this.state.json["10140TAXRE-000004"],content:this.state.json["10140TAXRE-000005"],noFooter:!1,noCancelBtn:!1,beSureBtnName:this.state.json["10140TAXRE-000006"],cancelBtnName:this.state.json["10140TAXRE-000007"],beSureBtnClick:this.deleteAction.bind(this)});break;case"Print":this.output("print");break;case"Enable":(0,c.promptBox)({color:"warning",title:this.state.json["10140TAXRE-000014"],content:this.state.json["10140TAXRE-000015"],noFooter:!1,noCancelBtn:!1,beSureBtnName:this.state.json["10140TAXRE-000006"],cancelBtnName:this.state.json["10140TAXRE-000007"],beSureBtnClick:this.changeEnableClick.bind(this)});break;case"Disable":(0,c.promptBox)({color:"warning",title:this.state.json["10140TAXRE-000016"],content:this.state.json["10140TAXRE-000017"],noFooter:!1,noCancelBtn:!1,beSureBtnName:this.state.json["10140TAXRE-000006"],cancelBtnName:this.state.json["10140TAXRE-000007"],beSureBtnClick:this.changeEnableClick.bind(this)});break;case"Output":var n=this.props.table.getAllTableData(g),s=[];n.rows.forEach((function(e){s.push(e.values[v].value)})),this.setState({pks:s},(function(){a.refs.printOutput.open()}))}}},{key:"changeEnableClick",value:function(){var e=this,t=this.selectedRowRecord[v].value;(0,c.ajax)({url:"/nccloud/uapbd/taxregion/changeEnableTaxregion.do",data:{id:t},success:function(t){if(t.data){var a=e.props.table.getAllTableData(e.tableId);a.rows.forEach((function(a){a.values[v].value==t.data.pk&&(a.values.enablestate={value:t.data.enableState,display:2==t.data.enableState?e.state.json["10140TAXRE-000002"]:e.state.json["10140TAXRE-000034"]},a.values.modifier={value:t.data.modifier,display:t.data.modifierName},a.values.modifiedtime={value:t.data.modifyTime,display:t.data.modifyTime})})),e.props.table.setAllTableData(e.tableId,a)}2==t.data.enableState?(e.props.button.setButtonDisabled({Enable:!0,Disable:!1}),(0,c.toast)({color:"success",title:e.state.json["10140TAXRE-000020"]})):(e.props.button.setButtonDisabled({Enable:!1,Disable:!0}),(0,c.toast)({color:"success",title:e.state.json["10140TAXRE-000021"]}))}})}},{key:"output",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.props.table.getAllTableData(g),a=[];t.rows.forEach((function(e){a.push(e.values[v].value)})),""!=e&&(0,c.print)("pdf",A,{funcode:"10140TAXRE",nodekey:"list",oids:a,outputType:e})}},{key:"onRowClick",value:function(e,t,a,o){this.selectedRowRecord=a,2==a.enablestate.value?e.button.setButtonDisabled({Enable:!0,Disable:!1}):e.button.setButtonDisabled({Enable:!1,Disable:!0})}},{key:"getData",value:function(e,t){var a=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments[3],r=this.props.search.getQueryInfo("taxregionsearch"),i=r.oid,l=s({},r,{pageInfo:{pageIndex:0,pageSize:10,total:0,totalPage:0},pagecode:h,queryAreaCode:m,oid:i,querytype:"tree",showDisable:t});(0,c.ajax)({url:T,data:l,success:function(e){if(a.props.button.setButtonDisabled({Enable:!0,Disable:!0}),e.data){var t=[];e.data[g].rows.forEach((function(e){t.push(e.values[v].value)})),a.props.button.setButtonDisabled({Print:!1,Output:!1}),e.data[g].allpks=t,a.props.table.setAllTableData(a.tableId,e.data[g]);var s=t.length,r=a.state.inlt;o&&(0,c.toast)({title:a.state.json["10140TAXRE-000035"],content:r.get("10140TAXRE-000042",{count:s}),color:"success"})}else{a.props.button.setButtonDisabled({Print:!0,Output:!0}),a.props.table.setAllTableData(g,{allpks:[],rows:[]}),o&&(0,c.toast)({content:a.state.json["10140TAXRE-000036"],color:"warning",title:a.state.json["10140TAXRE-000037"]})}n&&"function"==typeof n&&n()}})}},{key:"showOffChange",value:function(){var e=!this.state.isShowOff;this.setState({isShowOff:!this.state.isShowOff}),this.getData(this.searchVal,e)}},{key:"render",value:function(){var e=this.props,t=e.table,a=e.button,o=e.search,n=(e.base,e.modal),s=e.BillHeadInfo.createBillHeadInfo,r=this.props.button.getButtons();r=r.sort((function(e,t){return t.btnorder-e.btnorder}));var i=t.createSimpleTable,c=o.NCCreateSearch,u=n.createModal,d=a.createButtonApp;a.getButtons;return l.default.createElement("div",{className:"nc-bill-list"},l.default.createElement(b,{areaCode:b.config.HEADER,className:"nc-bill-header-area"},l.default.createElement("div",{className:"header-title-search-area"},s({title:this.state.json?this.state.json["10140TAXRE-000029"]:"10140TAXRE-000029",initShowBackBtn:!1})),l.default.createElement("div",{className:"title-search-detail"},l.default.createElement("span",null,l.default.createElement(p,{checked:this.state.isShowOff,onChange:this.showOffChange.bind(this),disabled:this.state.showOffDisable},this.state.json?this.state.json["10140TAXRE-000041"]:"10140TAXRE-000041"))),l.default.createElement("div",{className:"header-button-area"},d({area:"header-action",buttonLimit:3,onButtonClick:this.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),l.default.createElement("div",{className:"nc-bill-search-area",fieldid:"nc-bill-searchId"},c(this.searchId,{clickSearchBtn:this.clickSearchBtn.bind(this)})),l.default.createElement("div",{className:"nc-bill-table-area",fieldid:"tableId"},i(this.tableId,{dataSource:"upabd.taxinfo.taxregion.data",pkname:v,tableModelConfirm:this.tableModelConfirm,showIndex:!1,onRowClick:this.onRowClick.bind(this),onRowDoubleClick:this.doubleClick.bind(this)})),u("delete",{title:this.state.json?this.state.json["10140TAXRE-000004"]:"10140TAXRE-000004",content:this.state.json?this.state.json["10140TAXRE-000005"]:"10140TAXRE-000005",beSureBtnClick:this.deleteAction.bind(this)}),u("enable",{title:this.state.json?this.state.json["10140TAXRE-000014"]:"10140TAXRE-000014",content:this.state.json?this.state.json["10140TAXRE-000015"]:"10140TAXRE-000015",beSureBtnClick:this.changeEnableClick.bind(this)}),u("disable",{title:this.state.json?this.state.json["10140TAXRE-000016"]:"10140TAXRE-000016",content:this.state.json?this.state.json["10140TAXRE-000017"]:"10140TAXRE-000017",beSureBtnClick:this.changeEnableClick.bind(this)}),l.default.createElement(f,{ref:"printOutput",url:A,data:{funcode:"10140TAXRE",nodekey:"list",oids:this.state.pks,outputType:"output"}}))}}]),t}(i.Component),n=function(){var e=this;this.initTemplate=function(t){t.createUIDom({pagecode:h},(function(a){if(a){if(a.template){var o=a.template;o=e.modifierMeta(t,o),t.meta.setMeta(o);var n=c.cacheTools.get("searchParams"),s=null!=n&&n?n:{conditions:[],logic:"and"},r=a.template.taxregionsearch.oid,i={querycondition:s,pageInfo:{pageIndex:0,pageSize:10,total:0,totalPage:0},pagecode:h,queryAreaCode:m,oid:r,querytype:"tree"};(0,c.ajax)({url:T,data:i,success:function(a){if(a.data){var o=[];a.data[g].rows.forEach((function(e){o.push(e.values[v].value)})),t.button.setButtonDisabled({Print:!1,Output:!1}),a.data[g].allpks=o,t.table.setAllTableData(g,a.data[g])}else{t.button.setButtonDisabled({Print:!0,Output:!0}),t.table.setAllTableData(g,{allpks:[],rows:[]})}var n,s,r;a.formulamsg&&a.formulamsg instanceof Array&&a.formulamsg.length>0&&e.props.dealFormulamsg(a.formulamsg,(r="editTable",(s=g)in(n={})?Object.defineProperty(n,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[s]=r,n))}}),n&&0!=n&&t.search.setSearchValue("taxregionsearch",n)}if(a.button){var l=a.button;t.button.setButtons(l)}}}))},this.getButtonNames=function(e){return"edit"===e||"add"===e||"save"===e?"main-button":"secondary - button"},this.doubleClick=function(t,a,o,n){var s=e.props.search.getAllSearchData(m);c.cacheTools.set("searchParams",s),e.props.pushTo("/card",{status:"browse",pagecode:"10140TAXRE_card",id:t[v].value})},this.deleteAction=function(t){var a={id:e.selectedRowRecord[v].value,ts:e.selectedRowRecord.ts.value};(0,c.ajax)({url:E,data:a,success:function(a){(0,c.toast)({color:"success",title:e.state.json["10140TAXRE-000019"]}),e.refreshAction(t)}})},this.refreshAction=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.getData({},e.state.isShowOff,!1,(function(){a&&(0,c.toast)({title:e.state.json["10140TAXRE-000013"],color:"success"})}))},this.pageInfoClick=function(t,a,o){t.table.getTablePageInfo(e.tableId);var n={allpks:o,pageid:h};(0,c.ajax)({url:"/nccloud/uapbd/taxregion/ProjectQueryPageGridByPks.do",data:n,success:function(e){var a=e.success,o=e.data;a&&(o?t.table.setAllTableData(g,o[g]):t.table.setAllTableData(g,{rows:[]}))}})},this.clickSearchBtn=function(t,a){e.searchVal=a,c.cacheTools.set("searchParams",a),e.getData(a,e.state.isShowOff,!0)}},o);k=(0,c.createPage)({initTemplate:[],mutiLangCode:"10140TAXRE"})(k),t.default=k},176:function(e,t,a){"use strict";var o,n,s,r=a(1),i=a(177),l=(o=i)&&o.__esModule?o:{default:o};n=l.default,s="app",(0,r.RenderRouter)(n,s)},177:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=a(1),s=a(170),r=(o=s)&&o.__esModule?o:{default:o};var i=(0,n.asyncComponent)((function(){return Promise.resolve().then(a.t.bind(null,169,7))})),l=[{path:"/",component:r.default,exact:!0},{path:"/list",component:r.default},{path:"/card",component:i}];t.default=l},2:function(e,a){e.exports=t},3:function(e,t){e.exports=a}})}));
//# sourceMappingURL=index.34727543.js.map