/*! @ncctag {"provider":"test","date":"2020-5-11 22:19:54"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react-dom"],t):"object"==typeof exports?exports["fts/commission/payinfochange/util/index"]=t(require("nc-lightapp-front"),require("react-dom")):e["fts/commission/payinfochange/util/index"]=t(e["nc-lightapp-front"],e.ReactDOM)}(window,(function(e,t){return function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=39)}({0:function(t,a){t.exports=e},1:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.go2CardCheck=t.tbbWarnDialog=t.showTBBMsg=t.getTBBMsg=t.saveCommit=t.frozenBtnCtrl=t.showErrBtn=t.createCardWebSocket=t.createListWebSocket=t.setRate2NewRow=t.getCacheRateValue=t.bodyRateEditOnAfterEdit=t.addDefReferFilter=t.elecSignCardPrint=t.elecSignListPrint=t.createSimpleBillData=t.buildLightBodyAfterEditData=t.loadMultiLang=t.getMultiLangRes=t.appendMultiLangRes=t.saveMultiLangRes=t.getPropCache=t.setPropCache=t.showPagination=t.setDefOrg2AdvanceSrchArea=t.setDefOrg2ListSrchArea=t.setDefOrg2Form=t.hasDefaultOrg=t.isLinkScene=void 0;var r=a(0),n=a(2);function o(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,a){return function r(n,o){try{var i=t[n](o),l=i.value}catch(e){return void a(e)}if(!i.done)return Promise.resolve(l).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(l)}("next")}))}}var i,l,s=t.isLinkScene=function(e){var t=e.getUrlParam(n.URL_PARAM.SCENE);return!(!!!e.getUrlParam(n.URL_PARAM.TBB_LINK)&&t!=n.SCENE.LINK&&t!=n.SCENE.FIP)},u=t.hasDefaultOrg=function(e){return e&&e.context&&e.context&&e.context.pk_org},c=function(e,t,a){if(!(e&&e.search&&t&&a))return!1;try{var r=e.search.getSearchValByField(t,a);return!(!r||!r.value||!r.value.firstvalue&&!r.value.secondvalue)}catch(e){return!0}},d=(t.setDefOrg2Form=function(e,t,a){if(e&&t&&u(a)){var r=a.context,n=r.pk_org,o=r.org_Name,i=r.pk_org_v,l=r.org_v_Name;e.form.setFormItemsValue(t,{pk_org:{value:n,display:o},pk_org_v:{value:i,display:l}})}},t.setDefOrg2ListSrchArea=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org";if(e&&e.search&&t&&u(a)&&!s(e)&&!c(e,t,r)){var n=a.context,o=n.pk_org,i=n.org_Name,l={display:i,value:o};e.search.setSearchValByField(t,r,l)}},t.setDefOrg2AdvanceSrchArea=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org";if(e&&e.search&&t&&u(a)&&a.template&&!s(e)){var n=a.template,o=a.context,i=o.pk_org,l=o.org_Name;n[t].items.map((function(e){e.attrcode==r&&(e.initialvalue={display:l,value:i})}))}},t.showPagination=function(e,t,a){e&&t&&a&&!a.template&&(a.template[t].pagination=!s(e))},function(e){return e+"_extObj"}),f=(t.setPropCache=function(e,t,a,r){if(e&&t&&a){var n=d(t),o=e.ViewModel.getData(n);o||(o={}),o[a]=r,e.ViewModel.setData(n,o)}},t.getPropCache=function(e,t,a){if(!e||!t||!a)return null;var r=d(t),n=e.ViewModel.getData(r);return n&&n.hasOwnProperty(a)?n[a]:null},t.saveMultiLangRes=function(e,t){if(e&&t){e.ViewModel.setData("multiLang",t)}}),_=(t.appendMultiLangRes=function(e,t){if(e&&t){var a=_(e);a?Object.assign(a,t):f(e,t)}},t.getMultiLangRes=function(e){if(e){return e.ViewModel.getData("multiLang")}}),v=t.loadMultiLang=function(e,t){var a=_(e);return a&&a[t]||""},A=function(e,t){var a={},r=e.form.getAllFormValue(t);return r.areacode=t,a[t]=r,a},p=function(e,t){var a={rows:e.cardTable.getChangedRows(t),areaType:"table",areacode:t},r={};return r[t]=a,r},E=function(e,t,a,r,n,o,i,l){var s={head:A(e,a),pageid:t};return l?s.body=p(e,r):s.bodys=p(e,r),{areacode:r,attrcode:n,card:s,changedrows:o,index:i}},C=(t.buildLightBodyAfterEditData=function(e,t,a,r,n,o,i){var l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];try{if(!(e&&t&&a&&r&&n&&o))throw new Error("参数缺失！");var s=E(e,t,a,r,n,o,i,l),u=s.card,c=u.body,d=u.bodys;if(l&&1==c[r].rows.length||!l&&1==d[r].rows.length)return s;var f=[],_=o[0].rowid;if(!(c=l?c[r]:d[r]))throw new Error("未获取到指定的表体["+r+"]!");var v=c,A=v.rows,p=!0,C=!1,O=void 0;try{for(var D,g=A[Symbol.iterator]();!(p=(D=g.next()).done);p=!0){var b=D.value,y=b.rowid;if(y&&y==_){f.push(b);break}}}catch(e){C=!0,O=e}finally{try{!p&&g.return&&g.return()}finally{if(C)throw O}}if(0==f.length)throw new Error("未找到修改的行!");return c.rows=f,s}catch(e){throw e}},function(e){if(!e||0==e.length)return null;var t=!0,a=!1,r=void 0;try{for(var n,o=e[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=n.value;if(i&&i.values&&0!=Object.keys(i.values).length){var l=i.values,s=Object.keys(l),u=!0,c=!1,d=void 0;try{for(var f,_=s[Symbol.iterator]();!(u=(f=_.next()).done);u=!0){var v=f.value,A=l[v];A&&0!=Object.keys(A).length&&A.value||delete l[v]}}catch(e){c=!0,d=e}finally{try{!u&&_.return&&_.return()}finally{if(c)throw d}}}}}catch(e){a=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw r}}}),O=function(e,t,a,r,n){var o=e.createMasterChildDataSimple(t,a,r),i=o.head,l=o.body;return n&&(C(i[a].rows),C(l[r].rows)),o},D=function(e,t,a,r,n){var o=e.createExtCardDataSimple(t,a,r),i=o.head,l=o.bodys;if(n){C(i[a].rows);var s=!0,u=!1,c=void 0;try{for(var d,f=r[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var _=d.value;C(l[_].rows)}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}return o},g=t.createSimpleBillData=function(e,t,a,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!(e&&t&&a&&r))return null;var o=!!Array.isArray(r)&&r.length>1,i=Array.isArray(r)?r:[r];return o?D(e,t,a,i,n):O(e,t,a,i[0],n)},b=(t.elecSignListPrint=function(e,t){var a=t.url,n=t.offical,o=void 0!==n&&n,i=t.appCode,l=t.nodeKey,s=t.tableCode,u=t.field_id,c=t.field_billno,d=void 0===c?"vbillno":c,f=t.getOrgFunc,_=t.validateFunc;if(!(a&&i&&s&&u&&d))throw new Error("参数缺失！");var A=e.table.getCheckedRows(s);if(null!=A&&0!=A.length){var p=[],E=[],C=!0,O=!1,D=void 0;try{for(var g,b=A[Symbol.iterator]();!(C=(g=b.next()).done);C=!0){var I=g.value,h=I&&I.data&&I.data.values&&I.data.values[u]&&I.data.values[u].value;if(h){var P=I&&I.data&&I.data.values&&I.data.values[d]&&I.data.values[d].value,R=I&&I.data&&I.data.values&&I.data.values.pk_org&&I.data.values.pk_org.value,N=I.index;f&&"function"==typeof f&&(R=f(I));var T=!0;if(_&&"function"==typeof _){var F=_(I);F&&(E.push(m(e,F,P,N)),T=!1)}T&&p.push({id:h,vbillno:P,pk_org:R,index:N})}}}catch(e){O=!0,D=e}finally{try{!C&&b.return&&b.return()}finally{if(O)throw D}}y(e,{url:a,offical:o,appCode:i,nodeKey:l,detail:p,errMessArr:E})}else(0,r.toast)({color:"warning",content:v(e,"3601-000010")})},t.elecSignCardPrint=function(e,t){var a=t.url,r=t.offical,n=void 0!==r&&r,o=t.appCode,i=t.nodeKey,l=t.headCode,s=t.field_id,u=t.field_billno,c=void 0===u?"vbillno":u,d=t.getOrgFunc,f=t.validateFunc;if(!(a&&o&&l&&s&&c))throw new Error("参数缺失！");var _=e.form.getFormItemsValue(l,s).value,v=e.form.getFormItemsValue(l,c).value,A=e.form.getFormItemsValue(l,"pk_org").value;d&&"function"==typeof d&&(A=d());var p=[],E=!0;if(f&&"function"==typeof f){var C=f();C&&(p.push(m(e,C,v,0)),E=!1)}y(e,{url:a,offical:n,appCode:o,nodeKey:i,detail:E?[{id:_,vbillno:v,pk_org:A}]:null,errMessArr:p})},function(e,t){t&&0!=t.length&&(1==t.length?(0,r.toast)({duration:"infinity",color:"danger",content:t[0],hasCloseBtn:!0}):(0,r.toast)({duration:"infinity",color:"danger",TextArr:[v(e,"3601-000000"),v(e,"3601-000001"),v(e,"3601-000021")],groupOperation:!0,groupOperationMsg:t}))}),y=function(e,t){var a=t.url,o=t.offical,i=t.appCode,l=t.nodeKey,s=t.detail,u=t.errMessArr,c=void 0===u?[]:u;if(!(c&&c.length>0)||s&&0!=s.length){var d={offical:o,detail:s};(0,r.ajax)({url:n.COMMON_URL.ELECSIGNPRINTCHECK,data:d,success:function(t){var n=t.data,s=n.passPKs,u=n.passInfos,d=n.unPassInfos;if(c.length>0||d&&d.length>0){var f=!0,_=!1,v=void 0;try{for(var A,p=d[Symbol.iterator]();!(f=(A=p.next()).done);f=!0){var E=A.value,C=E.vbillno,O=E.mess,D=E.index,g=m(e,O,C,D);c.push(g)}}catch(e){_=!0,v=e}finally{try{!f&&p.return&&p.return()}finally{if(_)throw v}}b(e,c)}if(s&&s.length>0&&u&&u.length>0){var y={offical:o,detail:u};(0,r.print)("pdf",a,{nodekey:l,appcode:i,oids:s,userjson:JSON.stringify(y)})}}})}else b(e,c)},m=function(e,t,a,r){return v(e,"3601-000008")+a+v(e,"3601-000009")+t||""},I=(t.addDefReferFilter=function(e,t){var a=t.headCode,r=t.areaCode,n=t.meta,o=t.orgField,i=t.getOrgFunc;if(r&&n&&(a||o||i)){var l=Array.isArray(r)?r:[r],s=!0,u=!1,c=void 0;try{for(var d,f=l[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){n[d.value].items.map((function(t){(t.attrcode.startsWith("vdef")||t.attrcode.startsWith("vuserdef"))&&(t.queryCondition=function(){return{pk_org:i&&"function"==typeof i?i():(e.form.getFormItemsValue(a,o)||{}).value}})}))}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}},t.bodyRateEditOnAfterEdit=function(e){var t=e.props,a=e.bodyCodes,o=e.rateInfo,i=e.datasource,l=e.olcRates,s=e.glcRates,u=e.gllcRates;if(t&&o&&i&&a){!function(e){var t=e.rateInfo,a=e.datasource;if(t&&a){r.cardCache.setDefData(n.cache.rateinfo,a,t);r.cardCache.getDefData(n.cache.rateinfo,a)}}({rateInfo:o,datasource:i}),Array.isArray(a)||(a=[a]);var c=o.olcRateEditable,d=o.glcRateEditable,f=o.gllcRateEditable,_=!0,v=!1,A=void 0;try{for(var p,E=a[Symbol.iterator]();!(_=(p=E.next()).done);_=!0){var C=p.value;l&&(Array.isArray(l)||(l=[l]),t.cardTable.setColEditableByKey(C,l,!c)),s&&(Array.isArray(s)||(s=[s]),t.cardTable.setColEditableByKey(C,s,!d)),u&&(Array.isArray(u)||(u=[u]),t.cardTable.setColEditableByKey(C,u,!f))}}catch(e){v=!0,A=e}finally{try{!_&&E.return&&E.return()}finally{if(v)throw A}}}},t.getCacheRateValue=function(e){var t=e.datasource;if(t){var a=r.cardCache.getDefData(n.cache.rateinfo,t);return a?{olcRate:a.olcRate,glcRate:a.glcRate,gllcRate:a.gllcRate}:null}}),h=(t.setRate2NewRow=function(e){var t=e.olcRates,a=e.glcRates,r=e.gllcRates,n=e.datasource,o=e.row;if(n){var i=I({datasource:n});if(i){var l=i.olcRate,s=i.glcRate,u=i.gllcRate;if(t){Array.isArray(t)||(t=[t]);var c=!0,d=!1,f=void 0;try{for(var _,v=t[Symbol.iterator]();!(c=(_=v.next()).done);c=!0){o[_.value]={value:l}}}catch(e){d=!0,f=e}finally{try{!c&&v.return&&v.return()}finally{if(d)throw f}}}if(a){Array.isArray(a)||(a=[a]);var A=!0,p=!1,E=void 0;try{for(var C,O=a[Symbol.iterator]();!(A=(C=O.next()).done);A=!0){o[C.value]={value:s}}}catch(e){p=!0,E=e}finally{try{!A&&O.return&&O.return()}finally{if(p)throw E}}}if(r){Array.isArray(r)||(r=[r]);var D=!0,g=!1,b=void 0;try{for(var y,m=r[Symbol.iterator]();!(D=(y=m.next()).done);D=!0){o[y.value]={value:u}}}catch(e){g=!0,b=e}finally{try{!D&&m.return&&m.return()}finally{if(g)throw b}}}}}},t.createListWebSocket=function(e,t){var a=t.tableAreaCode,r=t.tablePkName,n=t.billtype,o=t.dataSource,i=t.serverLocation;if(e&&a&&r&&n){var l=e.socket,s={tableAreaCode:a,billpkname:r,billtype:n,dataSource:o};return i&&(s.serverLocation=i),React.createElement("div",null,l.connectMesg(s))}},t.createCardWebSocket=function(e,t){var a=t.headBtnAreaCode,r=t.formAreaCode,n=t.billpkname,o=t.billtype,i=t.dataSource,l=t.serverLocation;if(e&&a&&r&&n&&o){var s=e.socket,u={headBtnAreaCode:a,formAreaCode:r,billtype:o,billpkname:n,dataSource:i};return l&&(u.serverLocation=l),React.createElement("div",null,s.connectMesg(u))}},t.showErrBtn=function(e,t){var a=t.headBtnCode,r=t.headAreaCode,o=t.fieldPK;t.datasource;if(e&&a&&r){var i=e.getUrlParam(n.URL_PARAM.STATE),l="0";try{l=e.form.getFormItemsValue(r,n.sagaField.status).value}catch(e){l="0"}var s="1"===l&&"browse"==i;e.button.toggleErrorStatus(a,{isError:s}),s&&h(e,{headAreaCode:r,fieldPK:o})}},function(e,t){var a=t.headAreaCode,r=t.fieldPK;if(a&&r){var o=e.getUrlParam("status"),i=e.form.getFormItemsValue(a,n.sagaField.gtxid),l=e.form.getFormItemsValue(a,r);"browse"==o&&i&&i.value&&l&&l.value&&e.socket.showToast({gtxid:i.value,billpk:l.value})}}),P=(t.frozenBtnCtrl=function(e,t){var a=t.btnCodes;if(e&&a){var r=Array.isArray(a)?a:[a];if("browse"==e.getUrlParam(n.URL_PARAM.STATE)){var o="1";try{o=e.form.getFormItemsValue(headAreaCode,n.sagaField.frozen).value}catch(e){o="1"}e.button.setButtonDisabled(r,"1"==o)}}},function(e,t){var a=t.pageCode,r=t.headCode,n=t.bodyCodeArr,o=t.saveFunc,i={},l={};if(0==n.length)i={pageid:a,model:{areacode:r,rows:e.form.getAllFormValue(r).rows,areaType:"form"}},l[r]="form";else{i=n.length>1?e.createExtCardData(a,r,n):e.createMasterChildData(a,r,n[0]);var s=!0,u=!1,c=void 0;try{for(var d,f=n[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){l[d.value]="cardTable"}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}e.validateToSave(i,o,l,"")}),R=(i=o(regeneratorRuntime.mark((function e(t,a){var r,n=a.pageCode,o=a.headCode,i=a.bodyCodeArr,l=a.saveValidate,s=a.processSaveData;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.form.isCheckNow(o)){e.next=2;break}return e.abrupt("return",null);case 2:if(!(i&&i.length>0)||t.cardTable.checkTableRequired()){e.next=4;break}return e.abrupt("return",null);case 4:if(!l||"function"!=typeof l){e.next=7;break}if(l()){e.next=7;break}return e.abrupt("return",null);case 7:if(r=g(t,n,o,i),!s||"function"!=typeof s){e.next=12;break}return e.next=11,s(r);case 11:r=e.sent;case 12:return e.abrupt("return",{data:JSON.stringify(r),pageCode:n});case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)}),N=(t.saveCommit=(l=o(regeneratorRuntime.mark((function e(t,a){var n,o,i=a.pageCode,l=a.headCode,s=a.bodyCode,u=a.url,c=a.assign,d=a.showAssignFunc,f=a.updateViewFunc,_=a.saveValidate,v=a.processSaveData,A=a.extParam;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&l&&u&&d&&f){e.next=2;break}return e.abrupt("return");case 2:return A||(A={}),n=(a=s)?Array.isArray(a)?a:[a]:[],e.next=6,R(t,{pageCode:i,headCode:l,bodyCodeArr:n,saveValidate:_,processSaveData:v});case 6:if(o=e.sent){e.next=9;break}return e.abrupt("return");case 9:c&&(A.content=JSON.stringify(c)),o.extParam=A,P(t,{pageCode:i,headCode:l,bodyCodeArr:n,saveFunc:function(){(0,r.ajax)({url:u,data:o,success:function(e){var t=e.data.workflow;t&&"approveflow"==t||"workflow"==t?d(e):f(e)}})}});case 12:case"end":return e.stop()}var a}),e,this)}))),function(e,t){return l.apply(this,arguments)}),t.getTBBMsg=function(e){var t=e.row,a=e.msgfield;a||(a="ntbinfo");var r=(t&&t.values&&t.values[a]||{}).value;return r&&(t.values[a]={value:null,display:null}),r});t.showTBBMsg=function(e){var t=e.head,a=e.headCode,n=e.msgfield;if(!(t&&a&&t[a]&&t[a].rows&&0!=t[a].rows.length))return!1;var o=!1,i=t[a].rows[0],l=N({row:i,msgfield:n});return l&&((0,r.toast)({color:"warning",content:l}),o=!0),o},t.tbbWarnDialog=function(e,t){var a=t.ntbinfos,n=t.onConfirm;if(a&&0!=a.length){var o=[],i=a.length>1,l=1,s=i?[v(e,"3601-000019")+"["+a.length+"]"+v(e,"3601-000020")]:[],u=!0,c=!1,d=void 0;try{for(var f,_=a[Symbol.iterator]();!(u=(f=_.next()).done);u=!0){var A=f.value;if(null!=A){var p=A.pk,E=A.msg,C=A.vbillno;if(p&&C){o.push(p);var O="";i&&(O=l+". "+v(e,"3601-000018")+"["+C+"] "),s.push(React.createElement("li",null,O+E)),l++}}}}catch(e){c=!0,d=e}finally{try{!u&&_.return&&_.return()}finally{if(c)throw d}}0!=s.length&&(0,r.promptBox)({color:"warning",title:v(e,"3601-000017"),content:React.createElement("ul",null,s),beSureBtnClick:function(){n(o)}})}},t.go2CardCheck=function(e){var t=e.props,a=e.url,n=e.pk,o=e.ts,i=e.fieldPK,l=e.actionCode,s=e.permissionCode,u=e.checkSaga,c=void 0===u||u,d=e.checkTS,f=void 0===d||d,_=e.go2CardFunc;_&&"function"==typeof _&&(t&&a&&n&&o&&i||_(),(0,r.ajax)({url:a,data:{pk:n,ts:o,actionCode:l,permissionCode:s,fieldPK:i,checkSaga:c,checkTS:f},success:function(e){_()}}))}},10:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.orgVersionView=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pk_org",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org_v";if(e&&t){var n=e.getUrlParam("status"),o="browse"==n,i={};i[a]=!o,i[r]=o,e.form.setFormItemsVisible(t,i)}},t.orgVersionViewNew=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pk_org",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org_v";if(e&&t){var n=e.getUrlParam("status"),o="browse"==n,i={};i[a]=!o,i[r]=o,e.form.setItemsVisible(t,i)}}},12:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkVoucherApp=t.linkApp=void 0;var r=a(0),n=(a(14),a(2)),o=a(1),i=(t.linkApp=function(e,t,a){(0,r.ajax)({url:"/nccloud/tmpub/pub/qrylinkinfo.do",data:{billTypeOrTransType:t},success:function(t){var r=t.data;if(r){r.url;var o=r.appCode,i=r.linkPageCode;a&&0!=Object.keys(a).length||(a={}),a.scene||(a.scene=n.SCENE.LINK),a.status||(a.status="browse"),a.appcode=o,a.pagecode=i,e.openTo(null,a)}}})},"_LinkVouchar2019");t.linkVoucherApp=function(e,t,a,n,l,s,u){var c={pk_group:a,pk_org:n,relationID:t,pk_billtype:l};u&&u.freedef4&&(c={pk_group:a,pk_org:n,relationID:t,pk_billtype:l,freedef4:u.freedef4}),(0,r.ajax)({url:"/nccloud/tmpub/pub/qrylinkvoucherinfo.do",data:c,success:function(t){var a=t.success,n=t.data;if(a&&n&&n.src&&i==n.src&&n.pklist&&0!=n.pklist.length){var l=n.src,u=n.url,c=n.pklist,d=n.appcode,f=n.pagecode,_=n.srcAppCode,v=n.cachekey;n.des?1==c.length?e.openTo(u,{status:"browse",appcode:d,pagecode:f,id:c[0],n:(0,o.loadMultiLang)(e,"3601-000004"),pagekey:"link",backflag:"noback"}):(r.cacheTools.set(v,c),e.openTo(t.data.url,{status:"browse",appcode:d,pagecode:f,n:(0,o.loadMultiLang)(e,"3601-000004"),scene:d+l})):(r.cacheTools.set(_+l,c),e.openTo(t.data.url,{status:"browse",appcode:d,pagecode:f,scene:_+l}))}else(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"3601-000002")+s+(0,o.loadMultiLang)(e,"3601-000003")})}})}},14:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MODULE_H_FTS="FTS",t.MODULE_L_FTS="fts",t.VoucherDataConst={pagecode:"10170410_1017041001",appcode:"10170410",linkIdentification:"36300TP_LinkVouchar"}},15:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.APP_INFO={APP_ID:"0001Z61000000002LX7T",MODULE_ID:"3630",BILLTYPE:"36J8",FUNCODE:"36300CPI",DATA_SOURCE:"tm.commission.payinfochange.datasource"},t.TEMPLATE_INFO={QRY_TEMPLATE_ID:"1001Z61000000002B8ZS",PRINT_TEMPLATE_ID:"1001Z610000000007ZHX"};var r="/nccloud/fts/payinfochange/";t.URL_INFO={LIST_PAGE_URL:"/list",CARD_PAGE_URL:"/card",COMMON:{DELETE:r+"delete.do",COMMIT:r+"commit.do",UNCOMMIT:r+"uncommit.do",PRINT:r+"print.do"},LIST:{PAGECHANGE:r+"pageChange.do",QRY:r+"listqry.do",AUTO_QRY:r+"autoqry.do"},CARD:{QRY:r+"cardqry.do",SAVEUPDATE:r+"cardsave.do",SAVECOMMIT:r+"savecommit.do",LOADBULUINFO:r+"loadbuluinfo.do",SAVEBULU:r+"savebuluinfo.do",AFTEREDIT:r+"afteredit.do",LOADNEWDATA:r+"createnew.do",INITDATA:r+"initdata.do",QRYEDIT:r+"qryedit.do"},PARAM:{ID:"id",ISLINK:"islink",SCENE:"scene"}},t.UI_CONF={BUTTON_LIMIT:3},t.LIST_PAGE_INFO={PAGE_CODE:"36300CPI_L01",SEARCH_CODE:"search_payinfochange_01",TABLE_CODE:"table_payinfochange_01"},t.CARD_PAGE_INFO={PAGE_CODE:"36300CPI_C01",HEAD_CODE:"form_payinfochange_01",AREACODE_CHANGEINFO:"form_payinfochange_03"},t.SHOW_MODE={ADD:"add",BROWSER:"browse",EDIT:"edit"},t.ITEM_INFO={PK:"pk_payinfochange",TS:"ts",VBILLNO:"vbillno",VBILLSTATUS:"vbillstatus",BILLSTATUS:"billstatus"},t.CACHE_KEY={SEARCH_DATA:"searchData",HAS_QRY:"hasQry",ISLINK:"islink",ISFROMTLIST:"isFrontList",LINKDATA:"linkData"},t.BILL_STATE={BillStatus_WaitApprove:0,BillStatus_WaitProcess:1,BillStatus_Complete:2,BillStatus_WaitCommit:3},t.PROP_EXT_OBJ={CONTAIN:"contain"}},18:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryRelationRowsByRowno=t.buildLightBodyAfterEditData=t.validateWriteOffMny=t.setBodyItemProp=t.setHeadItemProp=void 0;var r=a(1),n=(t.setHeadItemProp=function(e,t,a){var r=e.form,n={},o={},i={};if(a&&0!=a.length){var l=!0,s=!1,u=void 0;try{for(var c,d=a[Symbol.iterator]();!(l=(c=d.next()).done);l=!0){var f=c.value;if(f.hasOwnProperty("itemName")){var _=f.itemName;if(_){if(f.hasOwnProperty("editable")){var v=f.editable;null!=v&&(n[_]=!("true"==v))}if(f.hasOwnProperty("require")){var A=f.require;null!=A&&(o[_]="true"==A)}if(f.hasOwnProperty("visible")){var p=f.visible;null!=p&&(i[_]="true"==p)}}}}}catch(e){s=!0,u=e}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}Object.keys(o).length>0&&r.setFormItemsRequired(t,o),Object.keys(n).length>0&&r.setFormItemsDisabled(t,n),Object.keys(i).length>0&&r.setFormItemsVisible(t,i)}},function(e,t,a,r,n){if(a.hasOwnProperty("editable")&&null!=a.editable){var o=a.rowID,i=a.rowIndex,l=a.itemName,s=a.editable;s="true"===a.editable,o||i?o?e.cardTable.setEditableByRowId(t,o,l,s):i&&e.cardTable.setEditableByIndex(t,i,l,s):s?r.push(l):n.push(l)}}),o=function(e,t,a,r,n){if(a.hasOwnProperty("visible")&&null!=a.visible){a.rowID,a.rowIndex;var o=a.itemName;a.visible?r.push(o):n.push(o)}},i=(t.setBodyItemProp=function(e,t){if(e&&0!=Object.keys(t).length){var a=!0,r=!1,i=void 0;try{for(var l,s=Object.keys(t)[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var u=l.value,c=t[u];if(0!=c.length){var d=[],f=[],_=[],v=[],A=!0,p=!1,E=void 0;try{for(var C,O=c[Symbol.iterator]();!(A=(C=O.next()).done);A=!0){var D=C.value;D.itemName&&(n(e,u,D,d,f),o(0,0,D,_,v))}}catch(e){p=!0,E=e}finally{try{!A&&O.return&&O.return()}finally{if(p)throw E}}d.length>0&&e.cardTable.setColEditableByKey(u,d,!0),f.length>0&&e.cardTable.setColEditableByKey(u,f,!1),_.length>0&&e.cardTable.showColByKey(u,_),v.length>0&&e.cardTable.hideColByKey(u,v)}}}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}}},t.validateWriteOffMny=function(e,t,a,n){if(!(Math.sign(a)>=0)&&!(e.form.getFormItemsValue(t,n)&&e.form.getFormItemsValue(t,n).value))throw new Error((0,r.loadMultiLang)(e,"36300-000000"))},t.buildLightBodyAfterEditData=function(e,t,a,r,n,o,i,l){var u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];try{if(!(e&&t&&a&&r&&o&&i))throw new Error("参数缺失！");var c=s(e,t,a,r,n,o,i,l,u),d=c.card,f=d.body,_=d.bodys;return u&&1==f[r].rows.length||!u&&_[r].rows.length,c}catch(e){throw e}},function(e,t){var a={},r=e.form.getAllFormValue(t);return r.areacode=t,a[t]=r,a}),l=function(e,t,a,r){var n=e.cardTable.getChangedRows(t),o=r[0].rowid,i=[];if(n&&n.length>1){var l=!0,s=!1,c=void 0;try{for(var d,f=n[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var _=d.value,v=_.rowid;if(v&&v==o){i.push(_);break}}}catch(e){s=!0,c=e}finally{try{!l&&f.return&&f.return()}finally{if(s)throw c}}}else n&&1==n.length&&i.push(n[0]);var A={rows:i,areaType:"table",areacode:t},p={};p[t]=A;var E=i&&i[0].values.relationindex.value;if(E){var C=u(e,a,E);if(C&&C.length>0){var O={rows:C,areaType:"table",areacode:a};p[a]=O}}return p},s=function(e,t,a,r,n,o,s,u,c){var d={head:i(e,a),pageid:t};return c?d.body=l(e,r):d.bodys=l(e,r,n,s),{areacode:r,attrcode:o,card:d,changedrows:s,index:u}},u=t.queryRelationRowsByRowno=function(e,t,a){for(var r=[],n=e.cardTable.getAllRows(t,!1),o=0;o<n.length;o++){a==n[o].values.relationindex.value&&r.push(n[o])}return r}},19:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,n,o=(r=u(regeneratorRuntime.mark((function e(t,a,r,n){var o,i,l,s,u,c,d,f,_,A,p,E,C,O,D,g,b,y,m,I,h,P,R,N;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="",e.next=3,v(r,n);case 3:if(i=e.sent,l=i.order,s=i.tabledata,u=i.tableinfo,c=i.encryptkey,d=i.tablerelation,f=i.scale,_=void 0===f?{scale:8}:f,"{}"!==JSON.stringify(i)){e.next=7;break}return e.abrupt("return",{});case 7:A=!0,p=!1,E=void 0,e.prev=10,C=u[Symbol.iterator]();case 12:if(A=(O=C.next()).done){e.next=60;break}D=O.value,g=s[D],b=("head"===D?t[a]:t.body||t.bodys)[d[D]].rows.sort((function(e,t){return e.values[l].value-t.values[l].value})),y=!0,m=!1,I=void 0,e.prev=19,h=b[Symbol.iterator]();case 21:if(y=(P=h.next()).done){e.next=43;break}if("3"!==(R=P.value).status){e.next=25;break}return e.abrupt("continue",40);case 25:Object.keys(g).length||(o+="null"),e.t0=regeneratorRuntime.keys(g);case 27:if((e.t1=e.t0()).done){e.next=40;break}N=e.t1.value,e.t2=Number(g[N]),e.next=0===e.t2?32:1===e.t2?34:2===e.t2?36:38;break;case 32:return o+=R.values[N]&&R.values[N].value||"",e.abrupt("break",38);case 34:return o+=R.values[N]&&R.values[N].display||"",e.abrupt("break",38);case 36:return o+=R.values[N]&&R.values[N].value?(Number(R.values[N].value)||0).toFixed(_.scale):"",e.abrupt("break",38);case 38:e.next=27;break;case 40:y=!0,e.next=21;break;case 43:e.next=49;break;case 45:e.prev=45,e.t3=e.catch(19),m=!0,I=e.t3;case 49:e.prev=49,e.prev=50,!y&&h.return&&h.return();case 52:if(e.prev=52,!m){e.next=55;break}throw I;case 55:return e.finish(52);case 56:return e.finish(49);case 57:A=!0,e.next=12;break;case 60:e.next=66;break;case 62:e.prev=62,e.t4=e.catch(10),p=!0,E=e.t4;case 66:e.prev=66,e.prev=67,!A&&C.return&&C.return();case 69:if(e.prev=69,!p){e.next=72;break}throw E;case 72:return e.finish(69);case 73:return e.finish(66);case 74:return e.abrupt("return",{signStr:o,encryptkey:c,tablerelation:d});case 75:case"end":return e.stop()}}),e,this,[[10,62,66,74],[19,45,49,57],[50,,52,56],[67,,69,73]])}))),function(e,t,a,n){return r.apply(this,arguments)}),i=a(0),l=a(4),s=(n=l)&&n.__esModule?n:{default:n};function u(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,a){return function r(n,o){try{var i=t[n](o),l=i.value}catch(e){return void a(e)}if(!i.done)return Promise.resolve(l).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(l)}("next")}))}}var c,d=i.viewModel.setGlobalStorage,f=i.viewModel.getGlobalStorage,_=(i.viewModel.removeGlobalStorage,i.base.NCLoading);function v(e,t){return new Promise((function(a){return(0,i.ajax)({type:"post",url:"/nccloud/tmpub/pub/qryencryptinfo.do",data:{encryptVOClassName:e},loading:!1,async:!1,success:function(e){e.success&&a(e.data)},error:function(e){t&&s.default.unmountComponentAtNode(t),(0,i.toast)({color:"warning",content:e.message}),a({})}})}))}t.default=(c=u(regeneratorRuntime.mark((function e(t){var a,r,n,l,u,c,v,A,p,E,C,O,D,g,b,y=t.data,m=void 0===y?{}:y,I=t.encryptVOClassName,h=void 0===I?"":I,P=t.isSign,R=void 0===P||P,N=t.isKey,T=void 0===N||N,F=t.head,L=void 0===F?"head":F,S=t.isSave,k=void 0!==S&&S,w=t.primaryId,M=void 0===w?null:w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M=M?Array.isArray(M)?M:[M]:M,m=M?{text:M.join(""),signText:null}:m,R||T){e.next=4;break}return e.abrupt("return",{data:m,isStop:!1});case 4:if(k&&("1"===f("localStorage","isSignKey")?T=!1:d("localStorage","isSignKey",T?1:2,(function(){}))),(a=(0,i.getBusinessInfo)())&&a.userCode){e.next=9;break}return(0,i.toast)({color:"warning",content:"无法获取当前登录用户信息, 请重新登录!"}),e.abrupt("return",{data:m,isStop:!0});case 9:if(r=void 0,n={},l="",u={},r=document.createElement("div"),document.body.appendChild(r),s.default.render(React.createElement(_,{show:!0,fullScreen:!0}),r),!R){e.next=26;break}if(M){e.next=25;break}return e.next=17,o(m,L,h,r);case 17:if(n=e.sent,"{}"!==JSON.stringify(n)){e.next=21;break}return r&&s.default.unmountComponentAtNode(r),e.abrupt("return",{data:m,isStop:!0});case 21:l=n.signStr,u=n.encryptkey,e.next=26;break;case 25:l=m.text;case 26:return e.next=28,new Promise((function(e){return(0,i.ajax)({type:"post",url:"/nccloud/tmpub/pub/iscauser.do",loading:!1,async:!1,success:function(t){t.success&&e(t.data)},error:function(t){e(!1)}})}));case 28:if((c=e.sent)||(T=!1),0===(v=superSign(l,a.userCode,T,c)).status){e.next=35;break}return(0,i.toast)({color:"warning",content:v.msg||"系统异常错误, 请重新尝试!"}),r&&s.default.unmountComponentAtNode(r),e.abrupt("return",{data:m,isStop:!0});case 35:if(!R){e.next=69;break}if(M){e.next=67;break}l=v.signStr,A=n.tablerelation,e.t0=regeneratorRuntime.keys(u);case 40:if((e.t1=e.t0()).done){e.next=64;break}for(p=e.t1.value,E=("head"===p?m[L]:m.body||m.bodys)[A[p]].rows,C=!0,O=!1,D=void 0,e.prev=46,g=E[Symbol.iterator]();!(C=(b=g.next()).done);C=!0)b.value.values[u[p]]={value:l};e.next=54;break;case 50:e.prev=50,e.t2=e.catch(46),O=!0,D=e.t2;case 54:e.prev=54,e.prev=55,!C&&g.return&&g.return();case 57:if(e.prev=57,!O){e.next=60;break}throw D;case 60:return e.finish(57);case 61:return e.finish(54);case 62:e.next=40;break;case 64:m.userjson=v.sn,e.next=69;break;case 67:m.signText=v.signStr,m.userjson=v.sn;case 69:return r&&s.default.unmountComponentAtNode(r),e.abrupt("return",{data:m,isStop:!1});case 71:case"end":return e.stop()}}),e,this,[[46,50,54,62],[55,,57,61]])}))),function(e){return c.apply(this,arguments)})},2:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.URL_PARAM={ID:"id",STATE:"status",SCENE:"scene",TBB_LINK:"pk_ntbparadimvo",LINK_ID:"linkId",PK_SRC:"pk_src"},t.sagaField={frozen:"saga_frozen",gtxid:"saga_gtxid",btxid:"saga_btxid",status:"saga_status"},t.sagaFrozenEnum={frozen:1,unfrozen:0},t.sagaStateEnum={success:0,fail:1},t.SCENE={DEFAULT:"defaultsce",APPROVE:"approvesce",LINK:"linksce",FIP:"fip",OTHER:"othersce"},t.LINKTYPE={NORMAL:"NORMAL",BILL_REVIEW:"BILL_REVIEW"},t.LINK_PARAM={ARAP:{FLAG:"flag",FLAG_VALUE:"ftsLinkArap"}},t.MODULE_INFO={TMPUB:"tmpub",TMPUB_NUM:"3601"},t.COMMON_URL={ELECSIGNPRINTCHECK:"/nccloud/tmpub/pub/elecsignprintcheck.do"},t.cache={rateinfo:"rateinfo",iserrtoast:"iserrtoast"},t.SPLIT_TBBCTRLTYPE="_ctrltype_",t.tbbwarntype={flexibility:"0",inflexibility:"1",warning:"2"}},39:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadLinkData=t.autoLoadData=t.listInitData=t.loadSearchCache=t.go2card=t.repaintView=t.loadDataFromCommissionPay=t.err2Browser=t.loadEditData=t.qryDataByPK=t.loadData2Card=t.clearCardData=t.versionControl=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},n=a(0),o=a(15),i=a(2),l=a(56),s=a(18),u=a(63),c=a(10),d=a(1);function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var _=t.versionControl=function(e){(0,c.orgVersionView)(e,o.CARD_PAGE_INFO.HEAD_CODE)},v=t.clearCardData=function(e,t,a,r){e.form.EmptyAllFormValue(o.CARD_PAGE_INFO.HEAD_CODE),t({billID:null,billNO:null}),C(e),a&&(0,n.toast)({color:"warning",content:(0,d.loadMultiLang)(e,"36300-000014")})},A=t.loadData2Card=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments[4];if(a){var i=a.head;i&&e.form.setAllFormValue(f({},o.CARD_PAGE_INFO.HEAD_CODE,i[o.CARD_PAGE_INFO.HEAD_CODE])),n&&"function"==typeof n&&n.call(this,a)}else v(e,t,r)},p=t.qryDataByPK=function(e,t,a,r){if(t||(t=e.getUrlParam("id"))){var i={pk:t,pageCode:o.CARD_PAGE_INFO.PAGE_CODE};(0,n.ajax)({url:o.URL_INFO.CARD.QRY,data:i,success:function(t){var i=t.data;A(e,a,t.data,!0,(function(){var l=t.data.head[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[o.ITEM_INFO.PK].value,s=t.data.head[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values.vbillno.value;a&&"function"==typeof a&&a({billID:l,billNO:s}),n.cardCache.updateCache(o.ITEM_INFO.PK,l,i,o.CARD_PAGE_INFO.HEAD_CODE,o.APP_INFO.DATA_SOURCE),_(e),C(e),r&&"function"==typeof r&&r()}))}})}},E=(t.loadEditData=function(e,t,a,r){var i={};i[t]=a;var l={uiState:e.getUrlParam("status"),edit_notetype:"Y"},u={pkMapTs:i,pageCode:o.CARD_PAGE_INFO.PAGE_CODE,extParam:l};(0,n.ajax)({url:o.URL_INFO.CARD.QRYEDIT,data:u,success:function(t){var a=t.data,i=a.card,l=(a.extParam,a.headItemProps),u=i.head;e.form.setAllFormValue(f({},o.CARD_PAGE_INFO.HEAD_CODE,u[o.CARD_PAGE_INFO.HEAD_CODE])),(0,s.setHeadItemProp)(e,o.CARD_PAGE_INFO.HEAD_CODE,l);var c=u[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[o.ITEM_INFO.PK].value,d=u[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[o.ITEM_INFO.VBILLNO].value;r&&"function"==typeof r&&r({billID:c,billNO:d}),C(e),n.cardCache.updateCache(o.ITEM_INFO.PK,c,i,o.CARD_PAGE_INFO.HEAD_CODE,o.APP_INFO.DATA_SOURCE)},error:function(a){E(e,a,t)}})},t.err2Browser=function(e,t,a){(0,n.toast)({color:"danger",content:t.message}),e.setUrlParam({status:"browse",id:a}),C(e)}),C=(t.loadDataFromCommissionPay=function(e,t,a,r){var i={};i.bodypk=a;var l={};l[t]=null;var u={pkMapTs:l,pageCode:o.CARD_PAGE_INFO.PAGE_CODE,extParam:i,isRet:!0};(0,n.ajax)({url:o.URL_INFO.CARD.LOADNEWDATA,data:u,success:function(t){var a=t.data,r=a.card,n=(a.extParam,a.headItemProps),i=r.head;e.form.setAllFormValue(f({},o.CARD_PAGE_INFO.HEAD_CODE,i[o.CARD_PAGE_INFO.HEAD_CODE])),(0,s.setHeadItemProp)(e,o.CARD_PAGE_INFO.HEAD_CODE,n),C(e)},error:function(a){E(e,a,t)}})},t.repaintView=function(e){var t=e.getUrlParam("status");e.form.setFormStatus(o.CARD_PAGE_INFO.HEAD_CODE,t),e.form.setFormItemsDisabled(o.CARD_PAGE_INFO.HEAD_CODE,{pk_org:!0}),_(e),(0,l.buttonVisible)(e)}),O=t.go2card=function(e,t,a,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];i&&n.cardCache.setDefData(o.CACHE_KEY.ISFROMTLIST,o.APP_INFO.DATA_SOURCE,i),t||((t={}).status="browse"),t.pagecode=o.CARD_PAGE_INFO.PAGE_CODE,e.pushTo(o.URL_INFO.CARD_PAGE_URL,t),r&&"function"==typeof r&&r(e)};t.loadSearchCache=function(e){var t=n.cardCache.getDefData(o.CACHE_KEY.SEARCH_DATA,o.APP_INFO.DATA_SOURCE);t&&e.search.setSearchValue(o.LIST_PAGE_INFO.SEARCH_CODE,t)},t.listInitData=function(e,t){var a=this,l=e.getUrlParam("id"),s={};s.pk_paymentfund=e.getUrlParam("pk_paymentfund");var c=JSON.stringify(e.table.getTablePageInfo(o.LIST_PAGE_INFO.TABLE_CODE));s.pageInfo=c,(0,n.ajax)({url:o.URL_INFO.CARD.INITDATA,data:{pk:l,extParam:s},success:function(t){var l=t.data;if(l){var s=l.head;l.grid;if(s){n.cardCache.setDefData(o.CACHE_KEY.LINKDATA,o.APP_INFO.DATA_SOURCE,JSON.parse(JSON.stringify(l)));var c={};c[o.LIST_PAGE_INFO.TABLE_CODE]=r({},s[o.CARD_PAGE_INFO.HEAD_CODE]),t.data={grid:c}}(0,u.updateListView)(e,t);var f=t.data.grid[o.LIST_PAGE_INFO.TABLE_CODE].rows;if(f&&1==f.length){var _=f[0].values[o.ITEM_INFO.PK].value;O(e,{pagecode:o.CARD_PAGE_INFO.PAGE_CODE,status:"browse",id:_,scene:i.SCENE.LINK},a.getState.bind(a))}}else(0,n.toast)({color:"warning",title:(0,d.loadMultiLang)(e,"36300CPI-000021")})}})},t.autoLoadData=function(e){var t=this,a=e.search.getQueryInfo(o.LIST_PAGE_INFO.SEARCH_CODE,!1),r=(0,u.buildQryData)(e,a.querycondition),i={appCode:o.APP_INFO.FUNCODE};r.extParam=i,(0,n.ajax)({url:o.URL_INFO.LIST.AUTO_QRY,data:r,success:function(a){u.updateListView.call(t,e,a)}})},t.loadLinkData=function(e,t){var a=n.cardCache.getDefData(o.CACHE_KEY.LINKDATA,o.APP_INFO.DATA_SOURCE);if(a)A(e,t,a,!0,(function(a){var r=a.head,n=r[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[o.ITEM_INFO.PK].value,i=r[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[o.ITEM_INFO.VBILLNO].value;t({billID:n,billNO:i}),C(e)}));else{var r=e.getUrlParam(o.URL_INFO.PARAM.ID);p(e,r,t)}}},4:function(e,a){e.exports=t},5:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.linkSucessPro=t.cardOperator=t.cardOperatorForCash=t.showTBBMsg=t.listSingleOperator=t.listSingleOperatorNoRecord=t.listMultiOperator=t.CopyLine=t.BatchCopy=t.Open=t.DelLine=t.BatchDelLine=t.InsertLine=t.AddLine=void 0,t.BatchCopyForCash=function(e,t,a,n){var i=e.cardTable.getCheckedRows(t);if(null==i||0==i.length)return(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"36300-000002")}),!1;var l=[],s=JSON.parse(JSON.stringify(i)),u=!0,c=!1,d=void 0;try{for(var f,_=s[Symbol.iterator]();!(u=(f=_.next()).done);u=!0){var v=f.value;v.data.selected=!1,v.data.values[n]&&v.data.values[n].value&&(v.data.values[n].value=null),v.data.values.rowno&&v.data.values.rowno.value&&(v.data.values.rowno.value=null),l.push(v.data)}}catch(e){c=!0,d=e}finally{try{!u&&_.return&&_.return()}finally{if(c)throw d}}null!=a&&null!=a||(a=e.cardTable.getNumberOfRows(t,!1));return e.cardTable.insertRowsAfterIndex(t,l,a),!0};var r=a(0),n=a(2),o=a(1);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}r.cardCache.getNextId,r.cardCache.deleteCacheById,t.AddLine=function(e,t,a,r){if(a){var n=e.cardTable.getNumberOfRows(t);e.cardTable.addRow(t,n,a)}else e.cardTable.addRow(t);r&&"function"==typeof r&&afterFunc(e,t)},t.InsertLine=function(e,t,a,r){e.cardTable.addRow(t,a+1,r)},t.BatchDelLine=function(e,t,a){var n=e.cardTable.getCheckedRows(t);if(null==n||0==n.length)return(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"36300-000001")}),!1;var i=[],l=!0,s=!1,u=void 0;try{for(var c,d=n[Symbol.iterator]();!(l=(c=d.next()).done);l=!0){var f=c.value;i.push(f.index)}}catch(e){s=!0,u=e}finally{try{!l&&d.return&&d.return()}finally{if(s)throw u}}return a&&"function"==typeof a?e.cardTable.delRowsByIndex(t,i,a):e.cardTable.delRowsByIndex(t,i),!0},t.DelLine=function(e,t,a,r){r&&"function"==typeof r?e.cardTable.delRowsByIndex(t,a,r):e.cardTable.delRowsByIndex(t,a)},t.Open=function(e,t,a,r,n){e.cardTable.openModel(t,n,r,a)};t.BatchCopy=function(e,t,a){var n=e.cardTable.getCheckedRows(t);if(null==n||0==n.length)return(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"36300-000002")}),!1;var i=[],l=JSON.parse(JSON.stringify(n)),s=!0,u=!1,c=void 0;try{for(var d,f=l[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var _=d.value;_.data.selected=!1,i.push(_.data)}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}return null==a&&(a=e.cardTable.getNumberOfRows(t,!1)),e.cardTable.insertRowsAfterIndex(t,i,a),!0},t.CopyLine=function(e,t,a){e.cardTable.pasteRow(t,a)};var l=function(e,t,a){e.errContent=e.errContent+t,e.failCount=Number(e.failCount)+1,e.errMsgArr.push(a||"")},s=function(e,t){e.succContent=e.succContent+t,e.succCount=Number(e.succCount)+1},u=(t.listMultiOperator=function(e,t,a,n,i,u,f,_,v,A){var p=e.table.getCheckedRows(a);if(null!=p&&0!=p.length){if(1==p.length){var E={};return E[n]=p[0]&&p[0].data&&p[0].data.values&&p[0].data.values[n],E.ts=p[0]&&p[0].data&&p[0].data.values&&p[0].data.values.ts,void c(e,t,a,i,E,n,p[0].index,u,f,_,v,A)}var C={},O={},D={},g=0,b=void 0,y=void 0,m=void 0;v||(v={});for(;g<p.length;)b=p[g]&&p[g].data&&p[g].data.values&&p[g].data.values[n]&&p[g].data.values[n].value,y=p[g]&&p[g].data&&p[g].data.values&&p[g].data.values.ts&&p[g].data.values.ts.value,m=p[g]&&p[g].data&&p[g].data.values&&p[g].data.values.vbillno&&p[g].data.values.vbillno.value,D[b]=p[g].index,b&&y&&(C[b]=y),b&&m&&(O[b]=m),g++;Object.keys(C).length>0&&(0,r.ajax)({url:i,data:{pkMapRowIndex:D,pkMapTs:C,pkMapVbillno:O,pageCode:t,extParam:v},success:function(t){var n=t.data.data,i=[],c=[],f={errMsgArr:[],succContent:"",errContent:"",succCount:0,failCount:0};if(n&&n.length>0){var v=!0,p=!1,E=void 0;try{for(var C,O=n[Symbol.iterator]();!(v=(C=O.next()).done);v=!0){var D=C.value,g=D.state,b=D.msg,y=D.result,m=D.pk,I=(D.vbillno,D.rowIndex),h=Number(I)+1;if(0==g)if(y){if(y&&y.head&&y.head[a]&&y.head[a].rows&&y.head[a].rows.length>0){var P=y.head[a].rows[0];if(_){var R=d(P);R?l(f,h,R=h+"."+R):s(f,h)}else s(f,h);var N={index:I,data:{values:P.values}};i.push(N)}}else s(f,h),e.table.deleteCacheId(a,m),c.push(I);else 1==g&&l(f,h,b)}}catch(e){p=!0,E=e}finally{try{!v&&O.return&&O.return()}finally{if(p)throw E}}i.length>0&&e.table.updateDataByIndexs(a,i),c.length>0&&e.table.deleteTableRowsByIndex(a,c)}var T=t.data,F=T.status,L=(T.msg,f.succContent),S=f.errContent,k=f.succCount,w=f.failCount,M=f.errMsgArr,x=(""==(L=k>0?L+(0,o.loadMultiLang)(e,"36300-000004")+u+(0,o.loadMultiLang)(e,"36300-000005"):"")?"":L+"，")+(w>0?S+(0,o.loadMultiLang)(e,"36300-000004")+u+(0,o.loadMultiLang)(e,"36300-000006"):"");if(0==F&&0==M.length){(0,o.loadMultiLang)(e,"36300-000007"),(0,o.loadMultiLang)(e,"36300-000008");(0,r.toast)({color:"success",content:u+(0,o.loadMultiLang)(e,"36300-000007")+k+(0,o.loadMultiLang)(e,"36300-000008")})}else(1==F||2==F||M.length>0)&&(0,r.toast)({duration:"infinity",color:"danger",content:x,TextArr:[(0,o.loadMultiLang)(e,"36300-000009"),(0,o.loadMultiLang)(e,"36300-000010"),(0,o.loadMultiLang)(e,"36300-000011")],groupOperation:!0,groupOperationMsg:M});A&&"function"==typeof A&&A(e,n)}})}else(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"36300-000003")})},t.listSingleOperatorNoRecord=function(e,t,a,n,i,l,s,u,c,d,_,v){var A={};A[i]=l,_||(_={}),(0,r.ajax)({url:n,data:{pkMapTs:A,pageCode:t,extParam:_},success:function(t){var n=t.data,l=!1;if(n){if(n&&n.head&&n.head[a]&&n.head[a].rows&&1==n.head[a].rows.length){d&&(l=f(n.head,a));var c=n.head[a].rows[0],_=[{index:s,data:{values:c.values}}];e.table.updateDataByIndexs(a,_),l||(0,r.toast)({color:"success",content:u+(0,o.loadMultiLang)(e,"36300-000005")})}}else e.table.deleteCacheId(a,i),e.table.deleteTableRowsByIndex(a,s),(0,r.toast)({color:"success",content:u+(0,o.loadMultiLang)(e,"36300-000005")});v&&"function"==typeof v&&v(e,n)}})}),c=t.listSingleOperator=function(e,t,a,r,n,o,i,l,s,c,d,f){var _=n[o].value,v=n.ts.value;u(e,t,a,r,_,v,i,l,s,c,d,f)},d=function(e){var t=(e&&e.values&&e.values.ntbinfo||{}).value;return t&&(e.values.ntbinfo={value:null,display:null}),t},f=t.showTBBMsg=function(e,t){if(!(e&&t&&e[t]&&e[t].rows&&0!=e[t].rows.length))return!1;var a=!1,n=e[t].rows[0],o=d(n);return o&&((0,r.toast)({color:"warning",content:o}),a=!0),a},_=function(e,t,a){var r={},n="array"==typeof a?a:Object.keys(a);if(!n||0==n.length)return null;var o={},i=!0,l=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value,f="array"==typeof a?null:a[d];if(f){var _=e.cardTable.getAllRows(d);if(_&&0!=_.length){var v=!0,A=!1,p=void 0;try{for(var E,C=_[Symbol.iterator]();!(v=(E=C.next()).done);v=!0){var O=E.value;if(O&&O.values&&0!=O.values.length){var D=O.rowid;o[O.values[f].value]=D}}}catch(e){A=!0,p=e}finally{try{!v&&C.return&&C.return()}finally{if(A)throw p}}}}}}catch(e){l=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw s}}return r[t]=o,r},v=function(e,t,a){return a.rows&&a.rows[0]&&a.rows[0].rowid?a=e.cardTable.updateDataByRowId(t,a):e.cardTable.setTableData(t,a),a};t.cardOperatorForCash=function(e,t,a,n,l,s,u,c,d,A,p){var E="array"==typeof n?n:Object.keys(n),C={},O=e.form.getFormItemsValue(a,l).value,D=e.form.getFormItemsValue(a,"ts").value;C[O]=D;var g=_(e,O,n);p||(p={}),(0,r.ajax)({url:s,data:{pkMapTs:C,pageCode:t,isRet:!0,extParam:p,pkMapbodyPKMaprowID:g},success:function(t){var n=t.data,s=!1;if(n){var _=n.head,p=n.body,C=n.bodys;if(_||p||C){if(A&&(s=f(_,a)),_&&e.form.setAllFormValue(i({},a,_[a])),p&&E&&E.length>0){var D=!0,g=!1,b=void 0;try{for(var y,m=E[Symbol.iterator]();!(D=(y=m.next()).done);D=!0){var I=y.value,h=p[I];h&&((h=v(e,I,h))&&(n.body[I]=h))}}catch(e){g=!0,b=e}finally{try{!D&&m.return&&m.return()}finally{if(g)throw b}}}if(C&&E&&E.length>0){var P=!0,R=!1,N=void 0;try{for(var T,F=E[Symbol.iterator]();!(P=(T=F.next()).done);P=!0){var L=T.value,S=C[L];S&&((S=v(e,L,S))&&(n.bodys[L]=S))}}catch(e){R=!0,N=e}finally{try{!P&&F.return&&F.return()}finally{if(R)throw N}}}if(_&&_[a]&&_[a].rows&&_[a].rows[0]){var k=_[a].rows[0],w=k&&k.values&&k.values[l]&&k.values[l].value;r.cardCache.updateCache(l,w,n,a,c)}s||(0,r.toast)({color:"success",content:u+(0,o.loadMultiLang)(e,"36300-000005")})}}else r.cardCache.deleteCacheById(l,O,c),(0,r.toast)({color:"success",content:u+(0,o.loadMultiLang)(e,"36300-000005")});d&&"function"==typeof d&&d(e,n)}})},t.cardOperator=function(e,t,a,n,l,s,u,c,d,A,p){var E="array"==typeof n?n:Object.keys(n),C={},O=e.form.getFormItemsValue(a,l).value,D=e.form.getFormItemsValue(a,"ts").value;C[O]=D;var g=_(e,O,n);p||(p={}),(0,r.ajax)({url:s,data:{pkMapTs:C,pageCode:t,isRet:!0,extParam:p,pkMapbodyPKMaprowID:g},success:function(t){var n=t.data,s=!1;if(n){e.getUrlParam("status");var _=n.head,p=n.body,C=n.bodys;if(_||p||C){if(A&&(s=f(_,a)),_&&e.form.setAllFormValue(i({},a,_[a])),p&&E&&E.length>0){var D=!0,g=!1,b=void 0;try{for(var y,m=E[Symbol.iterator]();!(D=(y=m.next()).done);D=!0){var I=y.value,h=p[I];h&&((h=v(e,I,h))&&(n.body[I]=h))}}catch(e){g=!0,b=e}finally{try{!D&&m.return&&m.return()}finally{if(g)throw b}}}if(C&&E&&E.length>0){var P=!0,R=!1,N=void 0;try{for(var T,F=E[Symbol.iterator]();!(P=(T=F.next()).done);P=!0){var L=T.value,S=C[L];S&&((S=v(e,L,S))&&(n.bodys[L]=S))}}catch(e){R=!0,N=e}finally{try{!P&&F.return&&F.return()}finally{if(R)throw N}}}if(_&&_[a]&&_[a].rows&&_[a].rows[0]){var k=_[a].rows[0],w=k&&k.values&&k.values[l]&&k.values[l].value;r.cardCache.updateCache(l,w,n,a,c)}s||(0,r.toast)({color:"success",content:u+(0,o.loadMultiLang)(e,"36300-000005")})}}else r.cardCache.deleteCacheById(l,O,c),(0,r.toast)({color:"success",content:u+(0,o.loadMultiLang)(e,"36300-000005")});d&&"function"==typeof d&&d(e,n)}})},t.linkSucessPro=function(e,t,a){var r=t.data;if(r&&r.length>0)for(var o=0;o<r.length;o++){var i=r[o],l=(i.url,i.pks),s=i.appCode,u=i.linkPageCode;a&&0!=Object.keys(a).length||(a={status:"browse"}),a.scene||(a.scene=n.SCENE.LINK),a.srcbillid||(a.srcbillid=l),a.appcode=s,a.pagecode=u,a.pks=l,a.id=l,e.openTo(null,a)}}},56:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttonVisible=t.pageInfoClick=t.initTemplate=t.afterEvent=t.buttonClick=void 0;var r=a(85),n=s(a(87)),o=s(a(88)),i=s(a(89)),l=a(90);function s(e){return e&&e.__esModule?e:{default:e}}t.buttonClick=r.buttonClick,t.afterEvent=o.default,t.initTemplate=n.default,t.pageInfoClick=i.default,t.buttonVisible=l.buttonVisible},6:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.button_limit=5,t.module_id="3630",t.module_name="fts",t.module_tmpub_name="tmpub",t.module_tmpub_id="3601",t.sourceModel_FTS="FTS",t.PaymentMergeBillType="36J5",t.PaymentBillType="36J1",t.SHOWMODEL_BULU=0,t.SHOWMODEL_LIULAN=1,t.SHOWMODEL_ZHIFU=3,t.PAYMODEL_COMBINEPAY=13,t.BILLTYPE_ARAP=["F2","F3"]},63:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateListView=t.buildQryData=t.refresh=t.searchBtnClick=void 0;var r=a(0),n=a(15),o=a(1),i=(t.searchBtnClick=function(e,t,a){var s=a.go1thPage;e=this.props;var u=!1;t&&t.conditions&&0!=t.conditions.length?(r.cardCache.setDefData(n.CACHE_KEY.SEARCH_DATA,n.APP_INFO.DATA_SOURCE,t),r.cardCache.setDefData(n.CACHE_KEY.HAS_QRY,n.APP_INFO.DATA_SOURCE,"true"),u=!0):t=r.cardCache.getDefData(n.CACHE_KEY.SEARCH_DATA,n.APP_INFO.DATA_SOURCE);r.cardCache.getDefData(n.CACHE_KEY.HAS_QRY,n.APP_INFO.DATA_SOURCE);if(t&&t.conditions&&0!=t.conditions.length){var c=i.call(this,e,t,s),d=this;(0,r.ajax)({url:n.URL_INFO.LIST.QRY,data:c,success:function(t){u&&(t.data.hasData?(0,r.toast)({color:"success",title:(0,o.loadMultiLang)(e,"36300CPI-000022")+t.data.grid[n.LIST_PAGE_INFO.TABLE_CODE].allpks.length+(0,o.loadMultiLang)(e,"36300CPI-000023")}):(0,r.toast)({color:"warning",title:(0,o.loadMultiLang)(e,"3601-000016")}));l.call(d,e,t)}})}},t.refresh=function(e){var t=r.cardCache.getDefData(n.CACHE_KEY.SEARCH_DATA,n.APP_INFO.DATA_SOURCE);if(r.cardCache.getDefData(n.CACHE_KEY.HAS_QRY,n.APP_INFO.DATA_SOURCE)){var a=i.call(this,e,t,!1),s=this;(0,r.ajax)({url:n.URL_INFO.LIST.QRY,data:a,success:function(t){(0,r.toast)({color:"success",title:(0,o.loadMultiLang)(e,"3601-000013")}),l.call(s,e,t)}})}},t.buildQryData=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.table.getTablePageInfo(n.LIST_PAGE_INFO.TABLE_CODE);a&&(r.pageIndex=0);var o=e.getSearchParam("p"),i=e.search.getQueryInfo(n.LIST_PAGE_INFO.SEARCH_CODE,!1);return i.querycondition=t,i.custcondition={logic:"or",conditions:[]},i.pageInfo=r,{data:JSON.stringify(i),pageCode:o}}),l=t.updateListView=function(e,t){var a=t.data.grid;a?e.table.setAllTableData(n.LIST_PAGE_INFO.TABLE_CODE,a[n.LIST_PAGE_INFO.TABLE_CODE]):e.table.setAllTableData(n.LIST_PAGE_INFO.TABLE_CODE,{rows:[]})}},85:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttonClick=void 0;var r,n=a(0),o=a(15),i=a(56),l=a(39),s=a(5),u=a(6),c=a(12),d=a(19),f=(r=d)&&r.__esModule?r:{default:r},_=a(86),v=a(1);function A(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}t.buttonClick=function(e,t){var a=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_org").value,r=this.props.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.PK).value,c=(e.getUrlParam("status"),A({},o.CARD_PAGE_INFO.HEAD_CODE,"form")),d={pageid:o.CARD_PAGE_INFO.PAGE_CODE,model:{areacode:o.CARD_PAGE_INFO.HEAD_CODE,rows:e.form.getAllFormValue(o.CARD_PAGE_INFO.HEAD_CODE).rows,areaType:"form"}};switch(t){case"Refresh":(0,l.qryDataByPK)(e,r,this.updateState.bind(this),(function(){(0,n.toast)({color:"success",title:(0,v.loadMultiLang)(e,"3601-000013")})}));break;case"Edit":e.setUrlParam({status:"edit",from:"card",id:e.getUrlParam("id")});var f=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"paymode");(0,i.afterEvent)(e,o.CARD_PAGE_INFO.HEAD_CODE,"edit",f),(0,l.repaintView)(e);break;case"Cancel":(0,n.promptBox)({color:"warning",title:(0,v.loadMultiLang)(e,"36300CPI-000000"),content:(0,v.loadMultiLang)(e,"36300CPI-000001"),beSureBtnClick:g.bind(this,e)});break;case"Delete":(0,n.promptBox)({color:"warning",title:(0,v.loadMultiLang)(e,"36300CPI-000002"),content:(0,v.loadMultiLang)(e,"36300CPI-000003"),beSureBtnClick:b.bind(this,e)});break;case"Save":e.validateToSave(d,D.bind(this,e),c,"");break;case"SaveCommit":e.validateToSave(d,m.bind(this,e),c,"");break;case"Commit":(0,s.cardOperator)(e,o.CARD_PAGE_INFO.PAGE_CODE,o.CARD_PAGE_INFO.HEAD_CODE,[],o.ITEM_INFO.PK,o.URL_INFO.COMMON.COMMIT,(0,v.loadMultiLang)(e,"36300CPI-000004"),o.APP_INFO.DATA_SOURCE,I.bind(this));break;case"UnCommit":(0,s.cardOperator)(e,o.CARD_PAGE_INFO.PAGE_CODE,o.CARD_PAGE_INFO.HEAD_CODE,[],o.ITEM_INFO.PK,o.URL_INFO.COMMON.UNCOMMIT,(0,v.loadMultiLang)(e,"36300CPI-000005"),o.APP_INFO.DATA_SOURCE,l.repaintView.bind(this,e));break;case"Bulu":O.call(this,u.SHOWMODEL_BULU);break;case"BuluView":O.call(this,u.SHOWMODEL_LIULAN);break;case"File":this.setState({showUploader:!this.state.showUploader});break;case"Print":(0,n.print)("pdf",o.URL_INFO.COMMON.PRINT,{nodekey:null,appcode:o.APP_INFO.FUNCODE,oids:[r]});break;case"OutPut":(0,n.output)({url:o.URL_INFO.COMMON.PRINT,data:{nodekey:null,appcode:o.APP_INFO.FUNCODE,oids:[r],outputType:"output"}});break;case"LinkPayAcc":var _=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_bankaccount_p").value;C.call(this,a,"pk_account",_);break;case"LinkCashAcc":var p=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_fundcashaccount").value;C.call(this,a,"pk_cashaccount",p);break;case"LinkApproveMess":this.setState({showApproveDetail:!0,billID:r});break;case"LinkSrcBill":y(e)}};var p,E,C=function(e,t,a){if(a){var r={};r.pk_org=e,r[t]=a;var o=[r];this.setState({showBankAccBalance:!0,bankAccBalanceParam:o})}else(0,n.toast)({color:"warning",content:(0,v.loadMultiLang)(this.props,"36300CPI-000006")})},O=function(e){var t=this;if(this.props.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"isnetpay").value){var a=this.props.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.PK).value,r=this.props.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.TS).value,i={};i[a]=r;var l={pkMapTs:i,ischeckfull:e==u.SHOWMODEL_LIULAN};(0,n.ajax)({url:o.URL_INFO.CARD.LOADBULUINFO,data:l,success:function(a){var r=a.data,n=a.success;n&&t.setState({onLineData:r||[],modelType:e},(function(){t.setState({showBuLu:!0})}))}})}else(0,n.toast)({color:"danger",content:(0,v.loadMultiLang)(this.props,"36300CPI-000007")})},D=(p=regeneratorRuntime.mark((function e(t,a){var r,i,s,u,c,d=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.getUrlParam("status"),i=o.URL_INFO.CARD.SAVEUPDATE,t.form.isCheckNow(o.CARD_PAGE_INFO.HEAD_CODE)){e.next=4;break}return e.abrupt("return");case 4:return s=t.createMasterChildData(o.CARD_PAGE_INFO.PAGE_CODE,o.CARD_PAGE_INFO.HEAD_CODE,null),e.next=7,(0,f.default)({isSign:!0,isKey:!0,data:s,encryptVOClassName:"nccloud.dto.fts.commission.payinfochange.PayInfoChangeEncryptVO4NCC"});case 7:if(!(u=e.sent).isStop){e.next=10;break}return e.abrupt("return");case 10:s=u.data,c={data:JSON.stringify(s),pageCode:o.CARD_PAGE_INFO.PAGE_CODE},(0,n.ajax)({url:i,data:c,success:function(e){var i=e.data,s=i.head;if(s){t.form.setAllFormValue(A({},o.CARD_PAGE_INFO.HEAD_CODE,s[o.CARD_PAGE_INFO.HEAD_CODE]));var u=s[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values.pk_payinfochange.value,c=s[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[o.ITEM_INFO.VBILLNO].value;r==_.SHOW_MODE.ADD?n.cardCache.addCache(u,i,o.CARD_PAGE_INFO.HEAD_CODE,o.APP_INFO.DATA_SOURCE):n.cardCache.updateCache(o.ITEM_INFO.PK,u,i,o.CARD_PAGE_INFO.HEAD_CODE,o.APP_INFO.DATA_SOURCE),t.setUrlParam({status:_.SHOW_MODE.BROWSER,id:u}),d.setState({billID:u,billNO:c}),(0,l.repaintView)(t);var f=a&&"function"==typeof a;f||(0,n.toast)({color:"success",content:(0,v.loadMultiLang)(t,"36300CPI-000008")}),f&&a(t,i)}}});case 13:case"end":return e.stop()}}),e,this)})),E=function(){var e=p.apply(this,arguments);return new Promise((function(t,a){return function r(n,o){try{var i=e[n](o),l=i.value}catch(e){return void a(e)}if(!i.done)return Promise.resolve(l).then((function(e){r("next",e)}),(function(e){r("throw",e)}));t(l)}("next")}))},function(e,t){return E.apply(this,arguments)}),g=function(e){var t=e.getUrlParam("id");t?(e.setUrlParam({status:"browse",id:t}),(0,l.qryDataByPK)(e,t)):(e.setUrlParam({status:"browse"}),e.form.EmptyAllFormValue(o.CARD_PAGE_INFO.HEAD_CODE)),(0,l.repaintView)(e)},b=function(e){var t=this,a={},r=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.PK).value,s=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"ts").value;a[r]=s;var u={pkMapTs:a,pageCode:o.CARD_PAGE_INFO.PAGE_CODE};(0,n.ajax)({url:o.URL_INFO.COMMON.DELETE,data:u,success:function(a){n.cardCache.deleteCacheById(o.ITEM_INFO.PK,r,o.APP_INFO.DATA_SOURCE);var s={id:e.getUrlParam("id"),status:3},u=e.cardPagination.getNextCardPaginationId(s);u?(e.cardPagination.setCardPaginationId(s),i.pageInfoClick.call(t,e,u)):(0,l.loadData2Card)(e,t.setState.bind(t),null),l.repaintView.call(t,e),(0,n.toast)({color:"success",content:(0,v.loadMultiLang)(e,"36300CPI-000009")})}})},y=function(e){var t=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_srcbilltype").value,a={status:"browse",islink:!0,id:e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_payment").value};(0,c.linkApp)(e,t,a)},m=function(e){var t=this;D.call(this,e,(function(){(0,s.cardOperator)(e,o.CARD_PAGE_INFO.PAGE_CODE,o.CARD_PAGE_INFO.HEAD_CODE,[],o.ITEM_INFO.PK,o.URL_INFO.COMMON.COMMIT,(0,v.loadMultiLang)(e,"36300CPI-000004"),o.APP_INFO.DATA_SOURCE,I.bind(t))}))},I=function(e,t){var a=t.workflow;a&&"approveflow"==a||"workflow"==a?this.setState({assignData:t,assignShow:t}):(0,l.repaintView)(e)}},86:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.APP_INFO={APP_ID:"0001Z6100000000236U1",MODULE_ID:"3630",BILLTYPE:"36J3",FUNCODE:"36300IT",CLASS_AGGVO:"nc.vo.fts.innertransfer.AggInnerTransferVO",DATA_SOURCE:"tm.innertransfer.innertransfer.datasource",PRINTNODEKEY_OFFICAL:"offical",PRINTNODEKEY_SUPPLAY:"inoffical"},t.TEMPLATE_INFO={QRY_TEMPLATE_ID:"1001Z610000000020OIK",PRINT_TEMPLATE_ID:"1001Z610000000007Z1H"},t.UI_CONF={BUTTON_LIMIT:3},t.LIST_PAGE_INFO={PAGE_CODE:"36300IT_L01",SEARCH_CODE:"search_innertransfer_01",TABLE_CODE:"table_innertransfer_01",GROUP:{NEEDDEAL:"0",NEEDCOMMIT:"1",APPROVING:"2",NEEDPAY:"3",ALL:"4"}};var r,n,o,i=t.CARD_PAGE_INFO={PAGE_CODE:"36300IT_C01",HEAD_CODE:"form_innertransfer_01",DELIVER_CODE:"form_innertransfer_05",BODY_CODE:"table_innertransfer_02",BODY_BROWSE_CODE:"form_innertransfer_03",BODY_EDIT_CODE:"form_innertransfer_02"},l=(t.SHOW_MODE={ADD:"add",BROWSER:"browse",EDIT:"edit",DEAL:"deal",COPY:"copy"},t.ITEM_INFO={PK:"pk_innertransfer_h",VBILLNO:"vbillno",TS:"ts",BPK:"pk_innertransfer_b",PSEUDOCOLUMN:"pseudocolumn",PK_DELDESTORG:"pk_deldestorg",BILLSTATUS:"billstatus",PK_ORG:"pk_org",SAGA_GTXID:"saga_gtxid"}),s=(t.SRCTYPE={CenterInput:0,TransferCreate:1,PayCreate:2,GatherCreate:3,InnerChangeCreate:4},t.ACCEPT={STATUS:{UNACCEPT:0,ACCEPTING:1,ACCEPTED:2},TYPE:{ACCEPT_ALL:0,UNACCEPT_ALL:1,ACCEPT_PART:2,FORCE_ACCEPT:3}},t.BILLSTATE={WAITCOMMIT:0,WAITDECIDE:1,WAITAPPROVE:2,WAITTRANSFER:3,TRANSFERED:4,WAITACCEPT:5,ACCEPTTING:6,REFUSEACCEPT:7,WAITPAY:8,PAYOK:9,BACK:10},t.WORK_FLOW_STATE={WFStatus_PersonRun:3},"/nccloud/fts/innertransfer/");t.URL_INFO={LIST_PAGE_URL:"/list",CARD_PAGE_URL:"/card",PARAM:{ID:"id",ISLINK:"islink"},LIST:{QRY:s+"listqry.do",PAGECHANGE:s+"pageChange.do",LISTINITDATA:s+"listinit.do",AUTO_QRY:s+"autoqry.do",GO2CARD_CHECK:s+"go2cardcheck.do"},CARD:{QRY:s+"cardqry.do",QRYDEALINFO:s+"cardloadDealInfo.do",LOADCOPYINFO:s+"cardCopy.do",SAVENEW:s+"cardSaveNew.do",SAVEDEAL:s+"carddeal.do",SAVEUPDATE:s+"cardSaveUpdate.do",SAVECOMMIT:s+"cardSaveCommit.do",AFTEREDIT:s+"afteredit.do",QRYCOPY:s+"qrycop.do",QRYEDIT:s+"qryedit.do"},COMMON:{DELETE:s+"delete.do",COMMIT:s+"commit.do",UNCOMMIT:s+"uncommit.do",REBACK:s+"reback.do",UNDEAL:s+"undeal.do",TRANSFER:s+"transfer.do",UNTRANSFER:s+"untransfer.do",VOUCHER:s+"voucher.do",UNVOUCHER:s+"unvoucher.do",DELIVER:s+"deliver.do",UNDELIVER:s+"undeliver.do",FORCEPAY:s+"forcepay.do",UNFORCEPAY:s+"unforcepay.do",REBACKPAY:s+"rebackpay.do",PRINT:s+"print.do",LINKSRCBILL:s+"linksrcbill.do",LINKDOWNBILL:s+"linkdownbill.do",LINKNTB:s+"linkntb.do",ELECSIGNPRINT:s+"elecsignprint.do",LINKRECEIPT:s+"linkreceipt.do"}},t.CACHE_KEY={GROUP_COUNT:"groupCount",SEARCH_DATA:"searchData",SELECT_GROUP:"selectedGroup",HAS_QRY:"hasQry",ISLINK:"islink",HASBACK:"hasback",ISFROMTLIST:"isFrontList",LINKDATA:"linkData",ID:"id"},t.PROP_EXT_OBJ={CONTAIN:"contain",ISROWCOPY:"isRowCopy"},t.bodyCodeMapBodyPKName=(o=l.BPK,(n=i.BODY_CODE)in(r={})?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r),t.permission={action:{edit:"maintain",decide:"decide"},appcode:"innertransfer"},t.cache={iserrtoast:"iserrtoast"}},87:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(0,s.getPropCache)(e,o.APP_INFO.FUNCODE,o.PROP_EXT_OBJ.CONTAIN);e.createUIDom({pagecode:o.CARD_PAGE_INFO.PAGE_CODE},(function(a){if(a){if(a.template){var r=a.template;!function(e,t){var a=e.getUrlParam("status");t[o.CARD_PAGE_INFO.HEAD_CODE].status=a,t[o.CARD_PAGE_INFO.AREACODE_CHANGEINFO].items.map((function(t){"pk_bankaccount_p"==t.attrcode&&(t.queryCondition=function(){return{pk_payment:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_payment")||{}).value,pk_currtype:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_currtype")||{}).value,isnetpay:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"isnetpay")||{}).value,noConditionOrg:"Y",GridRefActionExt:"nccloud.web.fts.commission.payinfochange.filter.PayBankAccFilter"}},t.showHistory=!1),"pk_fundcashaccount"==t.attrcode&&(t.queryCondition=function(){return{pk_org:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_org")||{}).value,pk_currtype:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_currtype")||{}).value,GridRefActionExt:"nccloud.web.fts.commission.payinfochange.filter.FundCashAccFilter"}},t.showHistory=!1),"pk_billno"==t.attrcode?t.queryCondition=function(){return{pk_org:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_org")||{}).value,pk_currtype:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_currtype")||{}).value,pk_notetype:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_notetype")||{}).value,GridRefActionExt:"nccloud.web.fts.commission.payinfochange.filter.BillFilter"}}:"pk_drawer"==t.attrcode?(t.queryCondition=function(){return{pk_org:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_org")||{}).value}},t.showHistory=!1):"pk_payplan"==t.attrcode&&(t.queryCondition=function(){return{pk_org:(e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_org")||{}).value}})}))}(e,r),e.meta.setMeta(r),u.call(t,e)}if(a.button){var i=a.button;e.button.setButtons(i),(0,n.buttonVisible)(e)}}}))};var r=a(0),n=a(56),o=a(15),i=a(2),l=a(39),s=a(1);r.base.NCPopconfirm;var u=function(e){var t=e.getUrlParam("scene"),a=e.getUrlParam("status"),r=e.getUrlParam("id"),n=e.getUrlParam("ts");if(t){e.getUrlParam("sourceBillType");if(t==i.SCENE.OTHER){var s=e.getUrlParam("sourceBillID"),u=e.getUrlParam("sourceBillBID");(0,l.loadDataFromCommissionPay)(e,s,u,this.updateState.bind(this))}else t==i.SCENE.LINK&&(0,l.loadLinkData)(e,this.updateState.bind(this))}else a==o.SHOW_MODE.EDIT?(0,l.loadEditData)(e,r,n,this.updateState.bind(this)):a==o.SHOW_MODE.BROWSER?(0,l.qryDataByPK)(e,r,this.updateState.bind(this)):(0,l.loadData2Card)(e,this.updateState.bind(this),null)}},88:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,r){["dealway","paymode","pk_billno","pk_bankaccount_p","pk_notetype","pk_allotaccount"].includes(a)?l(e,a,r):"edit"==a&&s(e,a,r)};var r=a(0),n=a(15),o=a(18);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=function(e,t,a){var o=e.createHeadAfterEventData(n.CARD_PAGE_INFO.PAGE_CODE,n.CARD_PAGE_INFO.HEAD_CODE,[],n.CARD_PAGE_INFO.HEAD_CODE,t,a),i=JSON.parse(JSON.stringify(o.newvalue)),l=JSON.parse(JSON.stringify(o.oldvalue));if(o.card.head[n.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[t]=i,i&&i.value){if(!l||!l.value||i.value!=l.value){var s=d(e,t,o);(0,r.ajax)({url:n.URL_INFO.CARD.AFTEREDIT,data:s,async:!1,success:function(a){f(e,a,t,i)},error:function(a){u(e,a,t,l)}})}}else c(e,t)},s=function(e,t,a){var l=e.createHeadAfterEventData(n.CARD_PAGE_INFO.PAGE_CODE,n.CARD_PAGE_INFO.HEAD_CODE,[],n.CARD_PAGE_INFO.HEAD_CODE,t,a);(0,r.ajax)({url:n.URL_INFO.CARD.AFTEREDIT,data:d(e,t,l),async:!1,success:function(t){var a=t.data,r=a.card,l=(a.extParam,a.headItemProps),s=r.head;e.form.setAllFormValue(i({},n.CARD_PAGE_INFO.HEAD_CODE,s[n.CARD_PAGE_INFO.HEAD_CODE])),(0,o.setHeadItemProp)(e,n.CARD_PAGE_INFO.HEAD_CODE,l)},error:function(a){u(e,a,t,oldvalue)}})},u=function(e,t,a,o){var i={};i[a]={value:o.value||null,display:o.display||null,scale:o.scale||-1},e.form.setFormItemsValue(n.CARD_PAGE_INFO.HEAD_CODE,i),(0,r.toast)({color:"warning",content:t.message})},c=function(e,t){"pk_billno"==t?e.form.setFormItemsValue(n.CARD_PAGE_INFO.HEAD_CODE,{billno:{value:null,display:null}}):"pk_bankaccount_p"==t&&e.form.setFormItemsValue(n.CARD_PAGE_INFO.HEAD_CODE,{pk_paybank:{value:null,display:null},bankaccname_p:{value:null,display:null},bankaccount_p:{value:null,display:null}})},d=function(e,t,a){var r={uiState:e.getUrlParam("status")},o="Y"==e.form.getFormItemsDisabled(n.CARD_PAGE_INFO.AREACODE_CHANGEINFO,"pk_notetype")?"N":"Y";r.edit_notetype=o;var i="Y"==e.form.getFormItemsDisabled(n.CARD_PAGE_INFO.AREACODE_CHANGEINFO,"pk_allotaccount")?"N":"Y";return r.edit_allotacc=i,{eventPosition:"head",eventType:"card",eventData:JSON.stringify(a),extParam:r}},f=function(e,t,a,r){var l=t.data,s=l.card,u=(l.extParam,l.headItemProps),c=s.head;if(e.form.setAllFormValue(i({},n.CARD_PAGE_INFO.HEAD_CODE,c[n.CARD_PAGE_INFO.HEAD_CODE])),(0,o.setHeadItemProp)(e,n.CARD_PAGE_INFO.HEAD_CODE,u),"pk_billno"==a){var d=r.refname,f=(r.values,d);e.form.setFormItemsValue(n.CARD_PAGE_INFO.HEAD_CODE,{billno:{value:f,display:f}})}else if("pk_bankaccount_p"==a){r.refname;var _=r.refcode,v=r.values;e.form.setFormItemsValue(n.CARD_PAGE_INFO.HEAD_CODE,{bankaccount_p:{value:_,display:_},bankaccname_p:{value:v["bd_bankaccsub.accname"].value,display:v["bd_bankaccsub.accname"].value},pk_paybank:{value:v["bd_bankdoc.pk_bankdoc"].value,display:v["bd_bankdoc.name"].value}})}}},89:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var a=this;if(t){e.setUrlParam(t);var i=r.cardCache.getCacheById(t,n.APP_INFO.DATA_SOURCE);i?(0,o.loadData2Card)(e,this.setState.bind(this),i,!1,(function(e){var r=e.head,i=t,l=r[n.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[n.ITEM_INFO.VBILLNO].value;a.setState({billID:i,billNO:l}),(0,o.repaintView)(a.props)})):(0,o.qryDataByPK)(e,t,this.updateState.bind(this))}};var r=a(0),n=a(15),o=a(39)},90:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttonVisible=void 0;var r=a(0),n=a(15),o=a(15),i=a(2);t.buttonVisible=function(e){if(0!=e.button.getButtons().length){var t=e.getUrlParam("status")||"browse",a=e.getUrlParam(n.URL_INFO.PARAM.SCENE),l=r.cardCache.getDefData(n.CACHE_KEY.ISLINK,n.APP_INFO.DATA_SOURCE);if(a==i.SCENE.LINK||l)e.button.setButtonVisible(["File","LinkList","Print","Refresh"],!0),e.button.setButtonVisible(["BaseGroup","SaveGroup","Cancel","Commit","UnCommit","Bulu"],!1);else if("browse"==t){e.button.setButtonVisible(["BaseGroup","File","LinkList","Print","Refresh"],!0),e.button.setButtonVisible(["SaveGroup","Cancel"],!1);var s=e.form.getFormItemsValue(n.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.BILLSTATUS).value,u=(e.form.getFormItemsValue(n.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.VBILLSTATUS).value,e.form.getFormItemsValue(n.CARD_PAGE_INFO.HEAD_CODE,"isnetpay").value);e.button.setButtonVisible(["BuluView"],u),3==s?(e.button.setButtonVisible(["Commit","Bulu"],!0),e.button.setButtonVisible(["UnCommit","LinkApproveMess"],!1)):0==s||1==s?(e.button.setButtonVisible(["UnCommit","Bulu","LinkApproveMess"],!0),e.button.setButtonVisible(["BaseGroup","Commit"],!1)):2==s?(e.button.setButtonVisible(["Bulu","LinkApproveMess"],!0),e.button.setButtonVisible(["BaseGroup","Commit","UnCommit"],!1)):e.button.setButtonVisible(["Bulu","BaseGroup","Commit","UnCommit","File","LinkList","Print","Refresh"],!1)}else"edit"!=t&&"add"!=t||(e.button.setButtonVisible(["SaveGroup","Cancel"],!0),e.button.setButtonVisible(["Commit","UnCommit","Bulu","File"],!1),e.button.setButtonVisible(["BaseGroup","LinkList","Print","Refresh"],!1))}}}})}));
//# sourceMappingURL=index.12f8eaec.js.map