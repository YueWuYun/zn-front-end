/*! @ncctag {"provider":"test","date":"2020-5-11 22:19:54"} */
!function(e,a){"object"==typeof exports&&"object"==typeof module?module.exports=a(require("nc-lightapp-front"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react-dom"],a):"object"==typeof exports?exports["fts/commission/payinfochangeapprove/util/index"]=a(require("nc-lightapp-front"),require("react-dom")):e["fts/commission/payinfochangeapprove/util/index"]=a(e["nc-lightapp-front"],e.ReactDOM)}(window,(function(e,a){return function(e){var a={};function t(r){if(a[r])return a[r].exports;var n=a[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=a,t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var n in e)t.d(r,n,function(a){return e[a]}.bind(null,n));return r},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="../../../../",t(t.s=64)}({0:function(a,t){a.exports=e},1:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.go2CardCheck=a.tbbWarnDialog=a.showTBBMsg=a.getTBBMsg=a.saveCommit=a.frozenBtnCtrl=a.showErrBtn=a.createCardWebSocket=a.createListWebSocket=a.setRate2NewRow=a.getCacheRateValue=a.bodyRateEditOnAfterEdit=a.addDefReferFilter=a.elecSignCardPrint=a.elecSignListPrint=a.createSimpleBillData=a.buildLightBodyAfterEditData=a.loadMultiLang=a.getMultiLangRes=a.appendMultiLangRes=a.saveMultiLangRes=a.getPropCache=a.setPropCache=a.showPagination=a.setDefOrg2AdvanceSrchArea=a.setDefOrg2ListSrchArea=a.setDefOrg2Form=a.hasDefaultOrg=a.isLinkScene=void 0;var r=t(0),n=t(2);function o(e){return function(){var a=e.apply(this,arguments);return new Promise((function(e,t){return function r(n,o){try{var i=a[n](o),l=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(l).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(l)}("next")}))}}var i,l,u=a.isLinkScene=function(e){var a=e.getUrlParam(n.URL_PARAM.SCENE);return!(!!!e.getUrlParam(n.URL_PARAM.TBB_LINK)&&a!=n.SCENE.LINK&&a!=n.SCENE.FIP)},s=a.hasDefaultOrg=function(e){return e&&e.context&&e.context&&e.context.pk_org},c=function(e,a,t){if(!(e&&e.search&&a&&t))return!1;try{var r=e.search.getSearchValByField(a,t);return!(!r||!r.value||!r.value.firstvalue&&!r.value.secondvalue)}catch(e){return!0}},d=(a.setDefOrg2Form=function(e,a,t){if(e&&a&&s(t)){var r=t.context,n=r.pk_org,o=r.org_Name,i=r.pk_org_v,l=r.org_v_Name;e.form.setFormItemsValue(a,{pk_org:{value:n,display:o},pk_org_v:{value:i,display:l}})}},a.setDefOrg2ListSrchArea=function(e,a,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org";if(e&&e.search&&a&&s(t)&&!u(e)&&!c(e,a,r)){var n=t.context,o=n.pk_org,i=n.org_Name,l={display:i,value:o};e.search.setSearchValByField(a,r,l)}},a.setDefOrg2AdvanceSrchArea=function(e,a,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org";if(e&&e.search&&a&&s(t)&&t.template&&!u(e)){var n=t.template,o=t.context,i=o.pk_org,l=o.org_Name;n[a].items.map((function(e){e.attrcode==r&&(e.initialvalue={display:l,value:i})}))}},a.showPagination=function(e,a,t){e&&a&&t&&!t.template&&(t.template[a].pagination=!u(e))},function(e){return e+"_extObj"}),f=(a.setPropCache=function(e,a,t,r){if(e&&a&&t){var n=d(a),o=e.ViewModel.getData(n);o||(o={}),o[t]=r,e.ViewModel.setData(n,o)}},a.getPropCache=function(e,a,t){if(!e||!a||!t)return null;var r=d(a),n=e.ViewModel.getData(r);return n&&n.hasOwnProperty(t)?n[t]:null},a.saveMultiLangRes=function(e,a){if(e&&a){e.ViewModel.setData("multiLang",a)}}),v=(a.appendMultiLangRes=function(e,a){if(e&&a){var t=v(e);t?Object.assign(t,a):f(e,a)}},a.getMultiLangRes=function(e){if(e){return e.ViewModel.getData("multiLang")}}),p=a.loadMultiLang=function(e,a){var t=v(e);return t&&t[a]||""},g=function(e,a){var t={},r=e.form.getAllFormValue(a);return r.areacode=a,t[a]=r,t},b=function(e,a){var t={rows:e.cardTable.getChangedRows(a),areaType:"table",areacode:a},r={};return r[a]=t,r},y=function(e,a,t,r,n,o,i,l){var u={head:g(e,t),pageid:a};return l?u.body=b(e,r):u.bodys=b(e,r),{areacode:r,attrcode:n,card:u,changedrows:o,index:i}},_=(a.buildLightBodyAfterEditData=function(e,a,t,r,n,o,i){var l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];try{if(!(e&&a&&t&&r&&n&&o))throw new Error("参数缺失！");var u=y(e,a,t,r,n,o,i,l),s=u.card,c=s.body,d=s.bodys;if(l&&1==c[r].rows.length||!l&&1==d[r].rows.length)return u;var f=[],v=o[0].rowid;if(!(c=l?c[r]:d[r]))throw new Error("未获取到指定的表体["+r+"]!");var p=c,g=p.rows,b=!0,_=!1,C=void 0;try{for(var h,A=g[Symbol.iterator]();!(b=(h=A.next()).done);b=!0){var m=h.value,E=m.rowid;if(E&&E==v){f.push(m);break}}}catch(e){_=!0,C=e}finally{try{!b&&A.return&&A.return()}finally{if(_)throw C}}if(0==f.length)throw new Error("未找到修改的行!");return c.rows=f,u}catch(e){throw e}},function(e){if(!e||0==e.length)return null;var a=!0,t=!1,r=void 0;try{for(var n,o=e[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var i=n.value;if(i&&i.values&&0!=Object.keys(i.values).length){var l=i.values,u=Object.keys(l),s=!0,c=!1,d=void 0;try{for(var f,v=u[Symbol.iterator]();!(s=(f=v.next()).done);s=!0){var p=f.value,g=l[p];g&&0!=Object.keys(g).length&&g.value||delete l[p]}}catch(e){c=!0,d=e}finally{try{!s&&v.return&&v.return()}finally{if(c)throw d}}}}}catch(e){t=!0,r=e}finally{try{!a&&o.return&&o.return()}finally{if(t)throw r}}}),C=function(e,a,t,r,n){var o=e.createMasterChildDataSimple(a,t,r),i=o.head,l=o.body;return n&&(_(i[t].rows),_(l[r].rows)),o},h=function(e,a,t,r,n){var o=e.createExtCardDataSimple(a,t,r),i=o.head,l=o.bodys;if(n){_(i[t].rows);var u=!0,s=!1,c=void 0;try{for(var d,f=r[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){var v=d.value;_(l[v].rows)}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}}return o},A=a.createSimpleBillData=function(e,a,t,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!(e&&a&&t&&r))return null;var o=!!Array.isArray(r)&&r.length>1,i=Array.isArray(r)?r:[r];return o?h(e,a,t,i,n):C(e,a,t,i[0],n)},m=(a.elecSignListPrint=function(e,a){var t=a.url,n=a.offical,o=void 0!==n&&n,i=a.appCode,l=a.nodeKey,u=a.tableCode,s=a.field_id,c=a.field_billno,d=void 0===c?"vbillno":c,f=a.getOrgFunc,v=a.validateFunc;if(!(t&&i&&u&&s&&d))throw new Error("参数缺失！");var g=e.table.getCheckedRows(u);if(null!=g&&0!=g.length){var b=[],y=[],_=!0,C=!1,h=void 0;try{for(var A,m=g[Symbol.iterator]();!(_=(A=m.next()).done);_=!0){var D=A.value,P=D&&D.data&&D.data.values&&D.data.values[s]&&D.data.values[s].value;if(P){var I=D&&D.data&&D.data.values&&D.data.values[d]&&D.data.values[d].value,w=D&&D.data&&D.data.values&&D.data.values.pk_org&&D.data.values.pk_org.value,k=D.index;f&&"function"==typeof f&&(w=f(D));var R=!0;if(v&&"function"==typeof v){var N=v(D);N&&(y.push(O(e,N,I,k)),R=!1)}R&&b.push({id:P,vbillno:I,pk_org:w,index:k})}}}catch(e){C=!0,h=e}finally{try{!_&&m.return&&m.return()}finally{if(C)throw h}}E(e,{url:t,offical:o,appCode:i,nodeKey:l,detail:b,errMessArr:y})}else(0,r.toast)({color:"warning",content:p(e,"3601-000010")})},a.elecSignCardPrint=function(e,a){var t=a.url,r=a.offical,n=void 0!==r&&r,o=a.appCode,i=a.nodeKey,l=a.headCode,u=a.field_id,s=a.field_billno,c=void 0===s?"vbillno":s,d=a.getOrgFunc,f=a.validateFunc;if(!(t&&o&&l&&u&&c))throw new Error("参数缺失！");var v=e.form.getFormItemsValue(l,u).value,p=e.form.getFormItemsValue(l,c).value,g=e.form.getFormItemsValue(l,"pk_org").value;d&&"function"==typeof d&&(g=d());var b=[],y=!0;if(f&&"function"==typeof f){var _=f();_&&(b.push(O(e,_,p,0)),y=!1)}E(e,{url:t,offical:n,appCode:o,nodeKey:i,detail:y?[{id:v,vbillno:p,pk_org:g}]:null,errMessArr:b})},function(e,a){a&&0!=a.length&&(1==a.length?(0,r.toast)({duration:"infinity",color:"danger",content:a[0],hasCloseBtn:!0}):(0,r.toast)({duration:"infinity",color:"danger",TextArr:[p(e,"3601-000000"),p(e,"3601-000001"),p(e,"3601-000021")],groupOperation:!0,groupOperationMsg:a}))}),E=function(e,a){var t=a.url,o=a.offical,i=a.appCode,l=a.nodeKey,u=a.detail,s=a.errMessArr,c=void 0===s?[]:s;if(!(c&&c.length>0)||u&&0!=u.length){var d={offical:o,detail:u};(0,r.ajax)({url:n.COMMON_URL.ELECSIGNPRINTCHECK,data:d,success:function(a){var n=a.data,u=n.passPKs,s=n.passInfos,d=n.unPassInfos;if(c.length>0||d&&d.length>0){var f=!0,v=!1,p=void 0;try{for(var g,b=d[Symbol.iterator]();!(f=(g=b.next()).done);f=!0){var y=g.value,_=y.vbillno,C=y.mess,h=y.index,A=O(e,C,_,h);c.push(A)}}catch(e){v=!0,p=e}finally{try{!f&&b.return&&b.return()}finally{if(v)throw p}}m(e,c)}if(u&&u.length>0&&s&&s.length>0){var E={offical:o,detail:s};(0,r.print)("pdf",t,{nodekey:l,appcode:i,oids:u,userjson:JSON.stringify(E)})}}})}else m(e,c)},O=function(e,a,t,r){return p(e,"3601-000008")+t+p(e,"3601-000009")+a||""},D=(a.addDefReferFilter=function(e,a){var t=a.headCode,r=a.areaCode,n=a.meta,o=a.orgField,i=a.getOrgFunc;if(r&&n&&(t||o||i)){var l=Array.isArray(r)?r:[r],u=!0,s=!1,c=void 0;try{for(var d,f=l[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){n[d.value].items.map((function(a){(a.attrcode.startsWith("vdef")||a.attrcode.startsWith("vuserdef"))&&(a.queryCondition=function(){return{pk_org:i&&"function"==typeof i?i():(e.form.getFormItemsValue(t,o)||{}).value}})}))}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}}},a.bodyRateEditOnAfterEdit=function(e){var a=e.props,t=e.bodyCodes,o=e.rateInfo,i=e.datasource,l=e.olcRates,u=e.glcRates,s=e.gllcRates;if(a&&o&&i&&t){!function(e){var a=e.rateInfo,t=e.datasource;if(a&&t){r.cardCache.setDefData(n.cache.rateinfo,t,a);r.cardCache.getDefData(n.cache.rateinfo,t)}}({rateInfo:o,datasource:i}),Array.isArray(t)||(t=[t]);var c=o.olcRateEditable,d=o.glcRateEditable,f=o.gllcRateEditable,v=!0,p=!1,g=void 0;try{for(var b,y=t[Symbol.iterator]();!(v=(b=y.next()).done);v=!0){var _=b.value;l&&(Array.isArray(l)||(l=[l]),a.cardTable.setColEditableByKey(_,l,!c)),u&&(Array.isArray(u)||(u=[u]),a.cardTable.setColEditableByKey(_,u,!d)),s&&(Array.isArray(s)||(s=[s]),a.cardTable.setColEditableByKey(_,s,!f))}}catch(e){p=!0,g=e}finally{try{!v&&y.return&&y.return()}finally{if(p)throw g}}}},a.getCacheRateValue=function(e){var a=e.datasource;if(a){var t=r.cardCache.getDefData(n.cache.rateinfo,a);return t?{olcRate:t.olcRate,glcRate:t.glcRate,gllcRate:t.gllcRate}:null}}),P=(a.setRate2NewRow=function(e){var a=e.olcRates,t=e.glcRates,r=e.gllcRates,n=e.datasource,o=e.row;if(n){var i=D({datasource:n});if(i){var l=i.olcRate,u=i.glcRate,s=i.gllcRate;if(a){Array.isArray(a)||(a=[a]);var c=!0,d=!1,f=void 0;try{for(var v,p=a[Symbol.iterator]();!(c=(v=p.next()).done);c=!0){o[v.value]={value:l}}}catch(e){d=!0,f=e}finally{try{!c&&p.return&&p.return()}finally{if(d)throw f}}}if(t){Array.isArray(t)||(t=[t]);var g=!0,b=!1,y=void 0;try{for(var _,C=t[Symbol.iterator]();!(g=(_=C.next()).done);g=!0){o[_.value]={value:u}}}catch(e){b=!0,y=e}finally{try{!g&&C.return&&C.return()}finally{if(b)throw y}}}if(r){Array.isArray(r)||(r=[r]);var h=!0,A=!1,m=void 0;try{for(var E,O=r[Symbol.iterator]();!(h=(E=O.next()).done);h=!0){o[E.value]={value:s}}}catch(e){A=!0,m=e}finally{try{!h&&O.return&&O.return()}finally{if(A)throw m}}}}}},a.createListWebSocket=function(e,a){var t=a.tableAreaCode,r=a.tablePkName,n=a.billtype,o=a.dataSource,i=a.serverLocation;if(e&&t&&r&&n){var l=e.socket,u={tableAreaCode:t,billpkname:r,billtype:n,dataSource:o};return i&&(u.serverLocation=i),React.createElement("div",null,l.connectMesg(u))}},a.createCardWebSocket=function(e,a){var t=a.headBtnAreaCode,r=a.formAreaCode,n=a.billpkname,o=a.billtype,i=a.dataSource,l=a.serverLocation;if(e&&t&&r&&n&&o){var u=e.socket,s={headBtnAreaCode:t,formAreaCode:r,billtype:o,billpkname:n,dataSource:i};return l&&(s.serverLocation=l),React.createElement("div",null,u.connectMesg(s))}},a.showErrBtn=function(e,a){var t=a.headBtnCode,r=a.headAreaCode,o=a.fieldPK;a.datasource;if(e&&t&&r){var i=e.getUrlParam(n.URL_PARAM.STATE),l="0";try{l=e.form.getFormItemsValue(r,n.sagaField.status).value}catch(e){l="0"}var u="1"===l&&"browse"==i;e.button.toggleErrorStatus(t,{isError:u}),u&&P(e,{headAreaCode:r,fieldPK:o})}},function(e,a){var t=a.headAreaCode,r=a.fieldPK;if(t&&r){var o=e.getUrlParam("status"),i=e.form.getFormItemsValue(t,n.sagaField.gtxid),l=e.form.getFormItemsValue(t,r);"browse"==o&&i&&i.value&&l&&l.value&&e.socket.showToast({gtxid:i.value,billpk:l.value})}}),I=(a.frozenBtnCtrl=function(e,a){var t=a.btnCodes;if(e&&t){var r=Array.isArray(t)?t:[t];if("browse"==e.getUrlParam(n.URL_PARAM.STATE)){var o="1";try{o=e.form.getFormItemsValue(headAreaCode,n.sagaField.frozen).value}catch(e){o="1"}e.button.setButtonDisabled(r,"1"==o)}}},function(e,a){var t=a.pageCode,r=a.headCode,n=a.bodyCodeArr,o=a.saveFunc,i={},l={};if(0==n.length)i={pageid:t,model:{areacode:r,rows:e.form.getAllFormValue(r).rows,areaType:"form"}},l[r]="form";else{i=n.length>1?e.createExtCardData(t,r,n):e.createMasterChildData(t,r,n[0]);var u=!0,s=!1,c=void 0;try{for(var d,f=n[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){l[d.value]="cardTable"}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}}e.validateToSave(i,o,l,"")}),w=(i=o(regeneratorRuntime.mark((function e(a,t){var r,n=t.pageCode,o=t.headCode,i=t.bodyCodeArr,l=t.saveValidate,u=t.processSaveData;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.form.isCheckNow(o)){e.next=2;break}return e.abrupt("return",null);case 2:if(!(i&&i.length>0)||a.cardTable.checkTableRequired()){e.next=4;break}return e.abrupt("return",null);case 4:if(!l||"function"!=typeof l){e.next=7;break}if(l()){e.next=7;break}return e.abrupt("return",null);case 7:if(r=A(a,n,o,i),!u||"function"!=typeof u){e.next=12;break}return e.next=11,u(r);case 11:r=e.sent;case 12:return e.abrupt("return",{data:JSON.stringify(r),pageCode:n});case 13:case"end":return e.stop()}}),e,this)}))),function(e,a){return i.apply(this,arguments)}),k=(a.saveCommit=(l=o(regeneratorRuntime.mark((function e(a,t){var n,o,i=t.pageCode,l=t.headCode,u=t.bodyCode,s=t.url,c=t.assign,d=t.showAssignFunc,f=t.updateViewFunc,v=t.saveValidate,p=t.processSaveData,g=t.extParam;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&l&&s&&d&&f){e.next=2;break}return e.abrupt("return");case 2:return g||(g={}),n=(t=u)?Array.isArray(t)?t:[t]:[],e.next=6,w(a,{pageCode:i,headCode:l,bodyCodeArr:n,saveValidate:v,processSaveData:p});case 6:if(o=e.sent){e.next=9;break}return e.abrupt("return");case 9:c&&(g.content=JSON.stringify(c)),o.extParam=g,I(a,{pageCode:i,headCode:l,bodyCodeArr:n,saveFunc:function(){(0,r.ajax)({url:s,data:o,success:function(e){var a=e.data.workflow;a&&"approveflow"==a||"workflow"==a?d(e):f(e)}})}});case 12:case"end":return e.stop()}var t}),e,this)}))),function(e,a){return l.apply(this,arguments)}),a.getTBBMsg=function(e){var a=e.row,t=e.msgfield;t||(t="ntbinfo");var r=(a&&a.values&&a.values[t]||{}).value;return r&&(a.values[t]={value:null,display:null}),r});a.showTBBMsg=function(e){var a=e.head,t=e.headCode,n=e.msgfield;if(!(a&&t&&a[t]&&a[t].rows&&0!=a[t].rows.length))return!1;var o=!1,i=a[t].rows[0],l=k({row:i,msgfield:n});return l&&((0,r.toast)({color:"warning",content:l}),o=!0),o},a.tbbWarnDialog=function(e,a){var t=a.ntbinfos,n=a.onConfirm;if(t&&0!=t.length){var o=[],i=t.length>1,l=1,u=i?[p(e,"3601-000019")+"["+t.length+"]"+p(e,"3601-000020")]:[],s=!0,c=!1,d=void 0;try{for(var f,v=t[Symbol.iterator]();!(s=(f=v.next()).done);s=!0){var g=f.value;if(null!=g){var b=g.pk,y=g.msg,_=g.vbillno;if(b&&_){o.push(b);var C="";i&&(C=l+". "+p(e,"3601-000018")+"["+_+"] "),u.push(React.createElement("li",null,C+y)),l++}}}}catch(e){c=!0,d=e}finally{try{!s&&v.return&&v.return()}finally{if(c)throw d}}0!=u.length&&(0,r.promptBox)({color:"warning",title:p(e,"3601-000017"),content:React.createElement("ul",null,u),beSureBtnClick:function(){n(o)}})}},a.go2CardCheck=function(e){var a=e.props,t=e.url,n=e.pk,o=e.ts,i=e.fieldPK,l=e.actionCode,u=e.permissionCode,s=e.checkSaga,c=void 0===s||s,d=e.checkTS,f=void 0===d||d,v=e.go2CardFunc;v&&"function"==typeof v&&(a&&t&&n&&o&&i||v(),(0,r.ajax)({url:t,data:{pk:n,ts:o,actionCode:l,permissionCode:u,fieldPK:i,checkSaga:c,checkTS:f},success:function(e){v()}}))}},10:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.orgVersionView=function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pk_org",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org_v";if(e&&a){var n=e.getUrlParam("status"),o="browse"==n,i={};i[t]=!o,i[r]=o,e.form.setFormItemsVisible(a,i)}},a.orgVersionViewNew=function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pk_org",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org_v";if(e&&a){var n=e.getUrlParam("status"),o="browse"==n,i={};i[t]=!o,i[r]=o,e.form.setItemsVisible(a,i)}}},111:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.buttonClick=void 0;var r,n=t(0),o=t(54),i=t(64),l=t(5),u=t(6),s=t(12),c=t(19),d=(r=c)&&r.__esModule?r:{default:r},f=t(1);a.buttonClick=function(e,a){var t=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_org").value,r=this.props.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.PK).value;e.getUrlParam("status");switch(a){case"Refresh":(0,i.qryDataByPK)(e,r,null,(function(){(0,n.toast)({color:"success",title:(0,f.loadMultiLang)(e,"3601-000013")})}));break;case"Edit":e.setUrlParam({status:"edit",from:"card",id:e.getUrlParam("id")}),(0,i.repaintView)(e);break;case"Cancel":(0,n.promptBox)({color:"warning",content:(0,f.loadMultiLang)(e,"36300CPI000-000000"),beSureBtnClick:b.bind(this,e)});break;case"Delete":(0,n.promptBox)({color:"warning",content:(0,f.loadMultiLang)(e,"36300CPI000-000001"),beSureBtnClick:y.bind(this,e)});break;case"Save":g(e);break;case"Commit":(0,l.cardOperator)(e,o.CARD_PAGE_INFO.PAGE_CODE,o.CARD_PAGE_INFO.HEAD_CODE,[],o.ITEM_INFO.PK,o.URL_INFO.COMMON.COMMIT,(0,f.loadMultiLang)(e,"36300CPI000-000002"),o.APP_INFO.DATA_SOURCE,i.repaintView.bind(this,e));break;case"UnCommit":(0,l.cardOperator)(e,o.CARD_PAGE_INFO.PAGE_CODE,o.CARD_PAGE_INFO.HEAD_CODE,[],o.ITEM_INFO.PK,o.URL_INFO.COMMON.UNCOMMIT,(0,f.loadMultiLang)(e,"36300CPI000-000003"),o.APP_INFO.DATA_SOURCE,i.repaintView.bind(this,e));break;case"Bulu":p.call(this,u.SHOWMODEL_BULU);break;case"BuluView":p.call(this,u.SHOWMODEL_LIULAN);break;case"File":this.setState({showUploader:!this.state.showUploader});break;case"Print":(0,n.print)("pdf",o.URL_INFO.COMMON.PRINT,{nodekey:null,appcode:o.APP_INFO.NORMAL_FUNCODE,oids:[r]});break;case"OutPut":(0,n.output)({url:o.URL_INFO.COMMON.PRINT,data:{nodekey:null,appcode:o.APP_INFO.NORMAL_FUNCODE,oids:[r],outputType:"output"}});break;case"LinkPayAcc":var s=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_bankaccount_p").value;v.call(this,t,"pk_account",s);break;case"LinkCashAcc":var c=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_fundcashaccount").value;v.call(this,t,"pk_cashaccount",c);break;case"LinkApproveMess":this.setState({showApproveDetail:!0,billID:r});break;case"LinkSrcBill":_(e)}};var v=function(e,a,t){if(t){var r={};r.pk_org=e,r[a]=t;var o=[r];this.setState({showBankAccBalance:!0,bankAccBalanceParam:o})}else(0,n.toast)({color:"warning",content:(0,f.loadMultiLang)(this.props,"36300CPI000-000004")})},p=function(e){var a=this,t=this.props.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.PK).value,r=this.props.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.TS).value,i={};i[t]=r;var l={pkMapTs:i,ischeckfull:e==u.SHOWMODEL_LIULAN};(0,n.ajax)({url:o.URL_INFO.CARD.LOADBULUINFO,data:l,success:function(t){var r=t.data,n=t.success;n&&a.setState({showBuLu:!0,onLineData:r||[],modelType:e})}})},g=function(e){if("edit"==e.getUrlParam("status")){var a=o.URL_INFO.CARD.SAVEUPDATE,t=e.createMasterChildData(o.CARD_PAGE_INFO.PAGE_CODE,o.CARD_PAGE_INFO.HEAD_CODE,null),r=(0,d.default)({isSign:!0,isKey:!0,data:t,encryptVOClassName:"nccloud.web.vo.fts.commission.payinfochange.PayInfoChangeEncryptVO4NCC"});if(!r.isStop){t=r.data;var l={data:JSON.stringify(t),pageCode:o.CARD_PAGE_INFO.PAGE_CODE};(0,n.ajax)({url:a,data:l,success:function(a){var t=a.success,r=a.data;if(t){var n=r.head;r.body;n&&e.form.setAllFormValue(function(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}({},o.CARD_PAGE_INFO.HEAD_CODE,n[o.CARD_PAGE_INFO.HEAD_CODE]));var l=n[o.CARD_PAGE_INFO.HEAD_CODE].rows[0].values.pk_payinfochange.value;e.setUrlParam({status:"browse",id:l}),(0,i.versionControl)(e),(0,i.repaintView)(e)}}})}}},b=function(e){var a=e.getUrlParam("id");a?(e.setUrlParam({status:"browse",id:a}),(0,i.qryDataByPK)(e,a)):(e.setUrlParam({status:"browse"}),e.form.EmptyAllFormValue(o.CARD_PAGE_INFO.HEAD_CODE)),(0,i.versionControl)(e),(0,i.repaintView)(e)},y=function(e){var a={},t=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,o.ITEM_INFO.PK).value,r=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"ts").value;a[t]=r;var l={pkMapTs:a,pageCode:o.CARD_PAGE_INFO.PAGE_CODE};(0,n.ajax)({url:o.URL_INFO.COMMON.DELETE,data:l,success:function(){n.cardCache.deleteCacheById(o.ITEM_INFO.PK,t,o.APP_INFO.DATA_SOURCE);var a={id:e.getUrlParam("id"),status:3},r=e.cardPagination.getNextCardPaginationId(a);r?(e.cardPagination.setCardPaginationId(a),pageInfoClick(e,r)):(0,i.loadData2Card)(e,null),(0,n.toast)({color:"success",content:(0,f.loadMultiLang)(e,"36300CPI000-000005")})}})},_=function(e){var a=e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_srcbilltype").value,t={status:"browse",islink:!0,id:e.form.getFormItemsValue(o.CARD_PAGE_INFO.HEAD_CODE,"pk_payment").value};(0,s.linkApp)(e,a,t)}},112:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){var a=(0,l.getPropCache)(e,o.APP_INFO.FUNCODE,o.PROP_EXT_OBJ.CONTAIN);e.createUIDom({pagecode:o.CARD_PAGE_INFO.PAGE_CODE},(function(t){if(t){if(t.template){var r=t.template;!function(e,a){var t=e.getUrlParam("status");a[o.CARD_PAGE_INFO.HEAD_CODE].status=t}(e,r),e.meta.setMeta(r),u.call(a,e)}if(t.button){var i=t.button;e.button.setButtons(i),(0,n.buttonVisible)(e)}}}))};var r=t(0),n=t(74),o=t(54),i=t(64),l=t(1);r.base.NCPopconfirm;var u=function(e){var a=e.getUrlParam("id");(0,i.qryDataByPK)(e,a,this.updateState.bind(this))}},12:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.linkVoucherApp=a.linkApp=void 0;var r=t(0),n=(t(14),t(2)),o=t(1),i=(a.linkApp=function(e,a,t){(0,r.ajax)({url:"/nccloud/tmpub/pub/qrylinkinfo.do",data:{billTypeOrTransType:a},success:function(a){var r=a.data;if(r){r.url;var o=r.appCode,i=r.linkPageCode;t&&0!=Object.keys(t).length||(t={}),t.scene||(t.scene=n.SCENE.LINK),t.status||(t.status="browse"),t.appcode=o,t.pagecode=i,e.openTo(null,t)}}})},"_LinkVouchar2019");a.linkVoucherApp=function(e,a,t,n,l,u,s){var c={pk_group:t,pk_org:n,relationID:a,pk_billtype:l};s&&s.freedef4&&(c={pk_group:t,pk_org:n,relationID:a,pk_billtype:l,freedef4:s.freedef4}),(0,r.ajax)({url:"/nccloud/tmpub/pub/qrylinkvoucherinfo.do",data:c,success:function(a){var t=a.success,n=a.data;if(t&&n&&n.src&&i==n.src&&n.pklist&&0!=n.pklist.length){var l=n.src,s=n.url,c=n.pklist,d=n.appcode,f=n.pagecode,v=n.srcAppCode,p=n.cachekey;n.des?1==c.length?e.openTo(s,{status:"browse",appcode:d,pagecode:f,id:c[0],n:(0,o.loadMultiLang)(e,"3601-000004"),pagekey:"link",backflag:"noback"}):(r.cacheTools.set(p,c),e.openTo(a.data.url,{status:"browse",appcode:d,pagecode:f,n:(0,o.loadMultiLang)(e,"3601-000004"),scene:d+l})):(r.cacheTools.set(v+l,c),e.openTo(a.data.url,{status:"browse",appcode:d,pagecode:f,scene:v+l}))}else(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"3601-000002")+u+(0,o.loadMultiLang)(e,"3601-000003")})}})}},14:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.MODULE_H_FTS="FTS",a.MODULE_L_FTS="fts",a.VoucherDataConst={pagecode:"10170410_1017041001",appcode:"10170410",linkIdentification:"36300TP_LinkVouchar"}},19:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r,n,o=(r=s(regeneratorRuntime.mark((function e(a,t,r,n){var o,i,l,u,s,c,d,f,v,g,b,y,_,C,h,A,m,E,O,D,P,I,w,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="",e.next=3,p(r,n);case 3:if(i=e.sent,l=i.order,u=i.tabledata,s=i.tableinfo,c=i.encryptkey,d=i.tablerelation,f=i.scale,v=void 0===f?{scale:8}:f,"{}"!==JSON.stringify(i)){e.next=7;break}return e.abrupt("return",{});case 7:g=!0,b=!1,y=void 0,e.prev=10,_=s[Symbol.iterator]();case 12:if(g=(C=_.next()).done){e.next=60;break}h=C.value,A=u[h],m=("head"===h?a[t]:a.body||a.bodys)[d[h]].rows.sort((function(e,a){return e.values[l].value-a.values[l].value})),E=!0,O=!1,D=void 0,e.prev=19,P=m[Symbol.iterator]();case 21:if(E=(I=P.next()).done){e.next=43;break}if("3"!==(w=I.value).status){e.next=25;break}return e.abrupt("continue",40);case 25:Object.keys(A).length||(o+="null"),e.t0=regeneratorRuntime.keys(A);case 27:if((e.t1=e.t0()).done){e.next=40;break}k=e.t1.value,e.t2=Number(A[k]),e.next=0===e.t2?32:1===e.t2?34:2===e.t2?36:38;break;case 32:return o+=w.values[k]&&w.values[k].value||"",e.abrupt("break",38);case 34:return o+=w.values[k]&&w.values[k].display||"",e.abrupt("break",38);case 36:return o+=w.values[k]&&w.values[k].value?(Number(w.values[k].value)||0).toFixed(v.scale):"",e.abrupt("break",38);case 38:e.next=27;break;case 40:E=!0,e.next=21;break;case 43:e.next=49;break;case 45:e.prev=45,e.t3=e.catch(19),O=!0,D=e.t3;case 49:e.prev=49,e.prev=50,!E&&P.return&&P.return();case 52:if(e.prev=52,!O){e.next=55;break}throw D;case 55:return e.finish(52);case 56:return e.finish(49);case 57:g=!0,e.next=12;break;case 60:e.next=66;break;case 62:e.prev=62,e.t4=e.catch(10),b=!0,y=e.t4;case 66:e.prev=66,e.prev=67,!g&&_.return&&_.return();case 69:if(e.prev=69,!b){e.next=72;break}throw y;case 72:return e.finish(69);case 73:return e.finish(66);case 74:return e.abrupt("return",{signStr:o,encryptkey:c,tablerelation:d});case 75:case"end":return e.stop()}}),e,this,[[10,62,66,74],[19,45,49,57],[50,,52,56],[67,,69,73]])}))),function(e,a,t,n){return r.apply(this,arguments)}),i=t(0),l=t(4),u=(n=l)&&n.__esModule?n:{default:n};function s(e){return function(){var a=e.apply(this,arguments);return new Promise((function(e,t){return function r(n,o){try{var i=a[n](o),l=i.value}catch(e){return void t(e)}if(!i.done)return Promise.resolve(l).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(l)}("next")}))}}var c,d=i.viewModel.setGlobalStorage,f=i.viewModel.getGlobalStorage,v=(i.viewModel.removeGlobalStorage,i.base.NCLoading);function p(e,a){return new Promise((function(t){return(0,i.ajax)({type:"post",url:"/nccloud/tmpub/pub/qryencryptinfo.do",data:{encryptVOClassName:e},loading:!1,async:!1,success:function(e){e.success&&t(e.data)},error:function(e){a&&u.default.unmountComponentAtNode(a),(0,i.toast)({color:"warning",content:e.message}),t({})}})}))}a.default=(c=s(regeneratorRuntime.mark((function e(a){var t,r,n,l,s,c,p,g,b,y,_,C,h,A,m,E=a.data,O=void 0===E?{}:E,D=a.encryptVOClassName,P=void 0===D?"":D,I=a.isSign,w=void 0===I||I,k=a.isKey,R=void 0===k||k,N=a.head,L=void 0===N?"head":N,T=a.isSave,F=void 0!==T&&T,S=a.primaryId,M=void 0===S?null:S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M=M?Array.isArray(M)?M:[M]:M,O=M?{text:M.join(""),signText:null}:O,w||R){e.next=4;break}return e.abrupt("return",{data:O,isStop:!1});case 4:if(F&&("1"===f("localStorage","isSignKey")?R=!1:d("localStorage","isSignKey",R?1:2,(function(){}))),(t=(0,i.getBusinessInfo)())&&t.userCode){e.next=9;break}return(0,i.toast)({color:"warning",content:"无法获取当前登录用户信息, 请重新登录!"}),e.abrupt("return",{data:O,isStop:!0});case 9:if(r=void 0,n={},l="",s={},r=document.createElement("div"),document.body.appendChild(r),u.default.render(React.createElement(v,{show:!0,fullScreen:!0}),r),!w){e.next=26;break}if(M){e.next=25;break}return e.next=17,o(O,L,P,r);case 17:if(n=e.sent,"{}"!==JSON.stringify(n)){e.next=21;break}return r&&u.default.unmountComponentAtNode(r),e.abrupt("return",{data:O,isStop:!0});case 21:l=n.signStr,s=n.encryptkey,e.next=26;break;case 25:l=O.text;case 26:return e.next=28,new Promise((function(e){return(0,i.ajax)({type:"post",url:"/nccloud/tmpub/pub/iscauser.do",loading:!1,async:!1,success:function(a){a.success&&e(a.data)},error:function(a){e(!1)}})}));case 28:if((c=e.sent)||(R=!1),0===(p=superSign(l,t.userCode,R,c)).status){e.next=35;break}return(0,i.toast)({color:"warning",content:p.msg||"系统异常错误, 请重新尝试!"}),r&&u.default.unmountComponentAtNode(r),e.abrupt("return",{data:O,isStop:!0});case 35:if(!w){e.next=69;break}if(M){e.next=67;break}l=p.signStr,g=n.tablerelation,e.t0=regeneratorRuntime.keys(s);case 40:if((e.t1=e.t0()).done){e.next=64;break}for(b=e.t1.value,y=("head"===b?O[L]:O.body||O.bodys)[g[b]].rows,_=!0,C=!1,h=void 0,e.prev=46,A=y[Symbol.iterator]();!(_=(m=A.next()).done);_=!0)m.value.values[s[b]]={value:l};e.next=54;break;case 50:e.prev=50,e.t2=e.catch(46),C=!0,h=e.t2;case 54:e.prev=54,e.prev=55,!_&&A.return&&A.return();case 57:if(e.prev=57,!C){e.next=60;break}throw h;case 60:return e.finish(57);case 61:return e.finish(54);case 62:e.next=40;break;case 64:O.userjson=p.sn,e.next=69;break;case 67:O.signText=p.signStr,O.userjson=p.sn;case 69:return r&&u.default.unmountComponentAtNode(r),e.abrupt("return",{data:O,isStop:!1});case 71:case"end":return e.stop()}}),e,this,[[46,50,54,62],[55,,57,61]])}))),function(e){return c.apply(this,arguments)})},2:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.URL_PARAM={ID:"id",STATE:"status",SCENE:"scene",TBB_LINK:"pk_ntbparadimvo",LINK_ID:"linkId",PK_SRC:"pk_src"},a.sagaField={frozen:"saga_frozen",gtxid:"saga_gtxid",btxid:"saga_btxid",status:"saga_status"},a.sagaFrozenEnum={frozen:1,unfrozen:0},a.sagaStateEnum={success:0,fail:1},a.SCENE={DEFAULT:"defaultsce",APPROVE:"approvesce",LINK:"linksce",FIP:"fip",OTHER:"othersce"},a.LINKTYPE={NORMAL:"NORMAL",BILL_REVIEW:"BILL_REVIEW"},a.LINK_PARAM={ARAP:{FLAG:"flag",FLAG_VALUE:"ftsLinkArap"}},a.MODULE_INFO={TMPUB:"tmpub",TMPUB_NUM:"3601"},a.COMMON_URL={ELECSIGNPRINTCHECK:"/nccloud/tmpub/pub/elecsignprintcheck.do"},a.cache={rateinfo:"rateinfo",iserrtoast:"iserrtoast"},a.SPLIT_TBBCTRLTYPE="_ctrltype_",a.tbbwarntype={flexibility:"0",inflexibility:"1",warning:"2"}},4:function(e,t){e.exports=a},5:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.linkSucessPro=a.cardOperator=a.cardOperatorForCash=a.showTBBMsg=a.listSingleOperator=a.listSingleOperatorNoRecord=a.listMultiOperator=a.CopyLine=a.BatchCopy=a.Open=a.DelLine=a.BatchDelLine=a.InsertLine=a.AddLine=void 0,a.BatchCopyForCash=function(e,a,t,n){var i=e.cardTable.getCheckedRows(a);if(null==i||0==i.length)return(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"36300-000002")}),!1;var l=[],u=JSON.parse(JSON.stringify(i)),s=!0,c=!1,d=void 0;try{for(var f,v=u[Symbol.iterator]();!(s=(f=v.next()).done);s=!0){var p=f.value;p.data.selected=!1,p.data.values[n]&&p.data.values[n].value&&(p.data.values[n].value=null),p.data.values.rowno&&p.data.values.rowno.value&&(p.data.values.rowno.value=null),l.push(p.data)}}catch(e){c=!0,d=e}finally{try{!s&&v.return&&v.return()}finally{if(c)throw d}}null!=t&&null!=t||(t=e.cardTable.getNumberOfRows(a,!1));return e.cardTable.insertRowsAfterIndex(a,l,t),!0};var r=t(0),n=t(2),o=t(1);function i(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}r.cardCache.getNextId,r.cardCache.deleteCacheById,a.AddLine=function(e,a,t,r){if(t){var n=e.cardTable.getNumberOfRows(a);e.cardTable.addRow(a,n,t)}else e.cardTable.addRow(a);r&&"function"==typeof r&&afterFunc(e,a)},a.InsertLine=function(e,a,t,r){e.cardTable.addRow(a,t+1,r)},a.BatchDelLine=function(e,a,t){var n=e.cardTable.getCheckedRows(a);if(null==n||0==n.length)return(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"36300-000001")}),!1;var i=[],l=!0,u=!1,s=void 0;try{for(var c,d=n[Symbol.iterator]();!(l=(c=d.next()).done);l=!0){var f=c.value;i.push(f.index)}}catch(e){u=!0,s=e}finally{try{!l&&d.return&&d.return()}finally{if(u)throw s}}return t&&"function"==typeof t?e.cardTable.delRowsByIndex(a,i,t):e.cardTable.delRowsByIndex(a,i),!0},a.DelLine=function(e,a,t,r){r&&"function"==typeof r?e.cardTable.delRowsByIndex(a,t,r):e.cardTable.delRowsByIndex(a,t)},a.Open=function(e,a,t,r,n){e.cardTable.openModel(a,n,r,t)};a.BatchCopy=function(e,a,t){var n=e.cardTable.getCheckedRows(a);if(null==n||0==n.length)return(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"36300-000002")}),!1;var i=[],l=JSON.parse(JSON.stringify(n)),u=!0,s=!1,c=void 0;try{for(var d,f=l[Symbol.iterator]();!(u=(d=f.next()).done);u=!0){var v=d.value;v.data.selected=!1,i.push(v.data)}}catch(e){s=!0,c=e}finally{try{!u&&f.return&&f.return()}finally{if(s)throw c}}return null==t&&(t=e.cardTable.getNumberOfRows(a,!1)),e.cardTable.insertRowsAfterIndex(a,i,t),!0},a.CopyLine=function(e,a,t){e.cardTable.pasteRow(a,t)};var l=function(e,a,t){e.errContent=e.errContent+a,e.failCount=Number(e.failCount)+1,e.errMsgArr.push(t||"")},u=function(e,a){e.succContent=e.succContent+a,e.succCount=Number(e.succCount)+1},s=(a.listMultiOperator=function(e,a,t,n,i,s,f,v,p,g){var b=e.table.getCheckedRows(t);if(null!=b&&0!=b.length){if(1==b.length){var y={};return y[n]=b[0]&&b[0].data&&b[0].data.values&&b[0].data.values[n],y.ts=b[0]&&b[0].data&&b[0].data.values&&b[0].data.values.ts,void c(e,a,t,i,y,n,b[0].index,s,f,v,p,g)}var _={},C={},h={},A=0,m=void 0,E=void 0,O=void 0;p||(p={});for(;A<b.length;)m=b[A]&&b[A].data&&b[A].data.values&&b[A].data.values[n]&&b[A].data.values[n].value,E=b[A]&&b[A].data&&b[A].data.values&&b[A].data.values.ts&&b[A].data.values.ts.value,O=b[A]&&b[A].data&&b[A].data.values&&b[A].data.values.vbillno&&b[A].data.values.vbillno.value,h[m]=b[A].index,m&&E&&(_[m]=E),m&&O&&(C[m]=O),A++;Object.keys(_).length>0&&(0,r.ajax)({url:i,data:{pkMapRowIndex:h,pkMapTs:_,pkMapVbillno:C,pageCode:a,extParam:p},success:function(a){var n=a.data.data,i=[],c=[],f={errMsgArr:[],succContent:"",errContent:"",succCount:0,failCount:0};if(n&&n.length>0){var p=!0,b=!1,y=void 0;try{for(var _,C=n[Symbol.iterator]();!(p=(_=C.next()).done);p=!0){var h=_.value,A=h.state,m=h.msg,E=h.result,O=h.pk,D=(h.vbillno,h.rowIndex),P=Number(D)+1;if(0==A)if(E){if(E&&E.head&&E.head[t]&&E.head[t].rows&&E.head[t].rows.length>0){var I=E.head[t].rows[0];if(v){var w=d(I);w?l(f,P,w=P+"."+w):u(f,P)}else u(f,P);var k={index:D,data:{values:I.values}};i.push(k)}}else u(f,P),e.table.deleteCacheId(t,O),c.push(D);else 1==A&&l(f,P,m)}}catch(e){b=!0,y=e}finally{try{!p&&C.return&&C.return()}finally{if(b)throw y}}i.length>0&&e.table.updateDataByIndexs(t,i),c.length>0&&e.table.deleteTableRowsByIndex(t,c)}var R=a.data,N=R.status,L=(R.msg,f.succContent),T=f.errContent,F=f.succCount,S=f.failCount,M=f.errMsgArr,x=(""==(L=F>0?L+(0,o.loadMultiLang)(e,"36300-000004")+s+(0,o.loadMultiLang)(e,"36300-000005"):"")?"":L+"，")+(S>0?T+(0,o.loadMultiLang)(e,"36300-000004")+s+(0,o.loadMultiLang)(e,"36300-000006"):"");if(0==N&&0==M.length){(0,o.loadMultiLang)(e,"36300-000007"),(0,o.loadMultiLang)(e,"36300-000008");(0,r.toast)({color:"success",content:s+(0,o.loadMultiLang)(e,"36300-000007")+F+(0,o.loadMultiLang)(e,"36300-000008")})}else(1==N||2==N||M.length>0)&&(0,r.toast)({duration:"infinity",color:"danger",content:x,TextArr:[(0,o.loadMultiLang)(e,"36300-000009"),(0,o.loadMultiLang)(e,"36300-000010"),(0,o.loadMultiLang)(e,"36300-000011")],groupOperation:!0,groupOperationMsg:M});g&&"function"==typeof g&&g(e,n)}})}else(0,r.toast)({color:"warning",content:(0,o.loadMultiLang)(e,"36300-000003")})},a.listSingleOperatorNoRecord=function(e,a,t,n,i,l,u,s,c,d,v,p){var g={};g[i]=l,v||(v={}),(0,r.ajax)({url:n,data:{pkMapTs:g,pageCode:a,extParam:v},success:function(a){var n=a.data,l=!1;if(n){if(n&&n.head&&n.head[t]&&n.head[t].rows&&1==n.head[t].rows.length){d&&(l=f(n.head,t));var c=n.head[t].rows[0],v=[{index:u,data:{values:c.values}}];e.table.updateDataByIndexs(t,v),l||(0,r.toast)({color:"success",content:s+(0,o.loadMultiLang)(e,"36300-000005")})}}else e.table.deleteCacheId(t,i),e.table.deleteTableRowsByIndex(t,u),(0,r.toast)({color:"success",content:s+(0,o.loadMultiLang)(e,"36300-000005")});p&&"function"==typeof p&&p(e,n)}})}),c=a.listSingleOperator=function(e,a,t,r,n,o,i,l,u,c,d,f){var v=n[o].value,p=n.ts.value;s(e,a,t,r,v,p,i,l,u,c,d,f)},d=function(e){var a=(e&&e.values&&e.values.ntbinfo||{}).value;return a&&(e.values.ntbinfo={value:null,display:null}),a},f=a.showTBBMsg=function(e,a){if(!(e&&a&&e[a]&&e[a].rows&&0!=e[a].rows.length))return!1;var t=!1,n=e[a].rows[0],o=d(n);return o&&((0,r.toast)({color:"warning",content:o}),t=!0),t},v=function(e,a,t){var r={},n="array"==typeof t?t:Object.keys(t);if(!n||0==n.length)return null;var o={},i=!0,l=!1,u=void 0;try{for(var s,c=n[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var d=s.value,f="array"==typeof t?null:t[d];if(f){var v=e.cardTable.getAllRows(d);if(v&&0!=v.length){var p=!0,g=!1,b=void 0;try{for(var y,_=v[Symbol.iterator]();!(p=(y=_.next()).done);p=!0){var C=y.value;if(C&&C.values&&0!=C.values.length){var h=C.rowid;o[C.values[f].value]=h}}}catch(e){g=!0,b=e}finally{try{!p&&_.return&&_.return()}finally{if(g)throw b}}}}}}catch(e){l=!0,u=e}finally{try{!i&&c.return&&c.return()}finally{if(l)throw u}}return r[a]=o,r},p=function(e,a,t){return t.rows&&t.rows[0]&&t.rows[0].rowid?t=e.cardTable.updateDataByRowId(a,t):e.cardTable.setTableData(a,t),t};a.cardOperatorForCash=function(e,a,t,n,l,u,s,c,d,g,b){var y="array"==typeof n?n:Object.keys(n),_={},C=e.form.getFormItemsValue(t,l).value,h=e.form.getFormItemsValue(t,"ts").value;_[C]=h;var A=v(e,C,n);b||(b={}),(0,r.ajax)({url:u,data:{pkMapTs:_,pageCode:a,isRet:!0,extParam:b,pkMapbodyPKMaprowID:A},success:function(a){var n=a.data,u=!1;if(n){var v=n.head,b=n.body,_=n.bodys;if(v||b||_){if(g&&(u=f(v,t)),v&&e.form.setAllFormValue(i({},t,v[t])),b&&y&&y.length>0){var h=!0,A=!1,m=void 0;try{for(var E,O=y[Symbol.iterator]();!(h=(E=O.next()).done);h=!0){var D=E.value,P=b[D];P&&((P=p(e,D,P))&&(n.body[D]=P))}}catch(e){A=!0,m=e}finally{try{!h&&O.return&&O.return()}finally{if(A)throw m}}}if(_&&y&&y.length>0){var I=!0,w=!1,k=void 0;try{for(var R,N=y[Symbol.iterator]();!(I=(R=N.next()).done);I=!0){var L=R.value,T=_[L];T&&((T=p(e,L,T))&&(n.bodys[L]=T))}}catch(e){w=!0,k=e}finally{try{!I&&N.return&&N.return()}finally{if(w)throw k}}}if(v&&v[t]&&v[t].rows&&v[t].rows[0]){var F=v[t].rows[0],S=F&&F.values&&F.values[l]&&F.values[l].value;r.cardCache.updateCache(l,S,n,t,c)}u||(0,r.toast)({color:"success",content:s+(0,o.loadMultiLang)(e,"36300-000005")})}}else r.cardCache.deleteCacheById(l,C,c),(0,r.toast)({color:"success",content:s+(0,o.loadMultiLang)(e,"36300-000005")});d&&"function"==typeof d&&d(e,n)}})},a.cardOperator=function(e,a,t,n,l,u,s,c,d,g,b){var y="array"==typeof n?n:Object.keys(n),_={},C=e.form.getFormItemsValue(t,l).value,h=e.form.getFormItemsValue(t,"ts").value;_[C]=h;var A=v(e,C,n);b||(b={}),(0,r.ajax)({url:u,data:{pkMapTs:_,pageCode:a,isRet:!0,extParam:b,pkMapbodyPKMaprowID:A},success:function(a){var n=a.data,u=!1;if(n){e.getUrlParam("status");var v=n.head,b=n.body,_=n.bodys;if(v||b||_){if(g&&(u=f(v,t)),v&&e.form.setAllFormValue(i({},t,v[t])),b&&y&&y.length>0){var h=!0,A=!1,m=void 0;try{for(var E,O=y[Symbol.iterator]();!(h=(E=O.next()).done);h=!0){var D=E.value,P=b[D];P&&((P=p(e,D,P))&&(n.body[D]=P))}}catch(e){A=!0,m=e}finally{try{!h&&O.return&&O.return()}finally{if(A)throw m}}}if(_&&y&&y.length>0){var I=!0,w=!1,k=void 0;try{for(var R,N=y[Symbol.iterator]();!(I=(R=N.next()).done);I=!0){var L=R.value,T=_[L];T&&((T=p(e,L,T))&&(n.bodys[L]=T))}}catch(e){w=!0,k=e}finally{try{!I&&N.return&&N.return()}finally{if(w)throw k}}}if(v&&v[t]&&v[t].rows&&v[t].rows[0]){var F=v[t].rows[0],S=F&&F.values&&F.values[l]&&F.values[l].value;r.cardCache.updateCache(l,S,n,t,c)}u||(0,r.toast)({color:"success",content:s+(0,o.loadMultiLang)(e,"36300-000005")})}}else r.cardCache.deleteCacheById(l,C,c),(0,r.toast)({color:"success",content:s+(0,o.loadMultiLang)(e,"36300-000005")});d&&"function"==typeof d&&d(e,n)}})},a.linkSucessPro=function(e,a,t){var r=a.data;if(r&&r.length>0)for(var o=0;o<r.length;o++){var i=r[o],l=(i.url,i.pks),u=i.appCode,s=i.linkPageCode;t&&0!=Object.keys(t).length||(t={status:"browse"}),t.scene||(t.scene=n.SCENE.LINK),t.srcbillid||(t.srcbillid=l),t.appcode=u,t.pagecode=s,t.pks=l,t.id=l,e.openTo(null,t)}}},54:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.APP_INFO={APP_ID:"0001Z61000000002LX7T",MODULE_ID:"3630",BILLTYPE:"36J8",FUNCODE:"36300CPI000",NORMAL_FUNCODE:"36300CPI",DATA_SOURCE:"tm.commission.payinfochange.datasource"},a.TEMPLATE_INFO={QRY_TEMPLATE_ID:"1001Z61000000002B8ZS",PRINT_TEMPLATE_ID:"1001Z610000000007ZHX"};var r="/nccloud/fts/payinfochange/";a.URL_INFO={LIST_PAGE_URL:"/list",CARD_PAGE_URL:"/card",COMMON:{DELETE:r+"delete.do",COMMIT:r+"commit.do",UNCOMMIT:r+"uncommit.do",PRINT:r+"print.do"},LIST:{PAGECHANGE:r+"pageChange.do",QRY:r+"listqry.do"},CARD:{QRY:r+"cardqry.do",SAVEUPDATE:r+"cardsave.do",LOADBULUINFO:r+"loadbuluinfo.do",SAVEBULU:r+"savebuluinfo.do",AFTEREDIT:r+"afteredit.do",LOADNEWDATA:r+"createnew.do"},PARAM:{ID:"id",ISLINK:"islink"}},a.UI_CONF={BUTTON_LIMIT:3},a.LIST_PAGE_INFO={PAGE_CODE:"36300CPI_L01",SEARCH_CODE:"search_payinfochange_01",TABLE_CODE:"table_payinfochange_01"},a.CARD_PAGE_INFO={PAGE_CODE:"36300CPIA_C01",HEAD_CODE:"form_payinfochange_01",AREACODE_CHANGEINFO:"form_payinfochange_03"},a.ITEM_INFO={PK:"pk_payinfochange",TS:"ts",VBILLNO:"vbillno",VBILLSTATUS:"vbillstatus",BILLSTATUS:"billstatus"},a.CACHE_KEY={SEARCH_DATA:"searchData"},a.PROP_EXT_OBJ={CONTAIN:"contain"}},6:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.button_limit=5,a.module_id="3630",a.module_name="fts",a.module_tmpub_name="tmpub",a.module_tmpub_id="3601",a.sourceModel_FTS="FTS",a.PaymentMergeBillType="36J5",a.PaymentBillType="36J1",a.SHOWMODEL_BULU=0,a.SHOWMODEL_LIULAN=1,a.SHOWMODEL_ZHIFU=3,a.PAYMODEL_COMBINEPAY=13,a.BILLTYPE_ARAP=["F2","F3"]},64:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.loadLinkData2Table=a.initData=a.loadSearchCache=a.go2card=a.repaintView=a.loadDataFromCommissionPay=a.qryDataByPK=a.loadData2Card=a.versionControl=void 0;var r=t(0),n=t(54),o=t(2),i=t(91),l=t(10);function u(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var s=a.versionControl=function(e){(0,l.orgVersionView)(e,n.CARD_PAGE_INFO.HEAD_CODE)},c=a.loadData2Card=function(e,a,t){if(a){var r=a.head;r&&(t&&"function"==typeof t?e.form.setAllFormValue(u({},n.CARD_PAGE_INFO.HEAD_CODE,r[n.CARD_PAGE_INFO.HEAD_CODE]),!0,!1,null,t.bind(this,a)):e.form.setAllFormValue(u({},n.CARD_PAGE_INFO.HEAD_CODE,r[n.CARD_PAGE_INFO.HEAD_CODE])))}else e.form.EmptyAllFormValue(n.CARD_PAGE_INFO.HEAD_CODE)},d=(a.qryDataByPK=function(e,a,t,o){var i={pk:e.getUrlParam("id"),pageCode:n.CARD_PAGE_INFO.PAGE_CODE};(0,r.ajax)({url:n.URL_INFO.CARD.QRY,data:i,success:function(a){var i=a.data;c(e,a.data,(function(){var l=a.data.head[n.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[n.ITEM_INFO.PK].value,u=a.data.head[n.CARD_PAGE_INFO.HEAD_CODE].rows[0].values.vbillno.value;t&&"function"==typeof t&&t({billID:l,billNO:u}),r.cardCache.updateCache(n.ITEM_INFO.PK,l,i,n.CARD_PAGE_INFO.HEAD_CODE,n.APP_INFO.DATA_SOURCE),s(e),d(e),o&&"function"==typeof o&&o()}))}})},a.loadDataFromCommissionPay=function(e,a,t,o){var i={};i.bodypk=t;var l={};l[a]=null;var u={pkMapTs:l,pageCode:n.CARD_PAGE_INFO.PAGE_CODE,extParam:i,isRet:!0};(0,r.ajax)({url:n.URL_INFO.CARD.LOADNEWDATA,data:u,success:function(a){var t=a.data;c(e,t,(function(){var i=a.data.head[n.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[n.ITEM_INFO.PK].value,l=a.data.head[n.CARD_PAGE_INFO.HEAD_CODE].rows[0].values.vbillno.value;o&&"function"==typeof o&&o({billID:i,billNO:l}),r.cardCache.updateCache(n.ITEM_INFO.PK,i,t,n.CARD_PAGE_INFO.HEAD_CODE,n.APP_INFO.DATA_SOURCE),d(e)}))}})},a.repaintView=function(e){var a=e.getUrlParam("status"),t="browse"===a?"browse":"edit";e.form.setFormStatus(n.CARD_PAGE_INFO.HEAD_CODE,t);var r="add"==a;e.form.setFormItemsDisabled(n.CARD_PAGE_INFO.HEAD_CODE,{pk_org:!r}),s(e),(0,i.buttonVisible)(e)});a.go2card=function(e,a,t,o){var i=e.search.getQueryInfo(n.LIST_PAGE_INFO.SEARCH_CODE,!1);r.cardCache.setDefData(n.CACHE_KEY.SEARCH_DATA,n.APP_INFO.DATA_SOURCE,i&&i.querycondition&&i.querycondition.conditions||null),a||((a={}).status="browse"),a.pagecode=n.CARD_PAGE_INFO.PAGE_CODE,e.pushTo(n.URL_INFO.CARD_PAGE_URL,a),o&&"function"==typeof o&&o(e)},a.loadSearchCache=function(e){var a=r.cardCache.getDefData(n.CACHE_KEY.SEARCH_DATA,n.APP_INFO.DATA_SOURCE);a&&e.search.setSearchValue(n.LIST_PAGE_INFO.SEARCH_CODE,a)},a.initData=function(e,a){var t=e.getUrlParam("id"),i={};i.pk_paymentfund=e.getUrlParam("pk_paymentfund"),(0,r.ajax)({url:n.URL_INFO.CARD.INITDATA,data:{pk:t,extParam:i},success:function(t){var i=t.data;if(i){var l=i.grid,u=i.head;l?(r.cardCache.setDefData(n.CACHE_KEY.LINK_DATA,n.APP_INFO.DATA_SOURCE,l),e.pushTo(n.URL_INFO.LIST_PAGE_URL,{status:"browse",scene:o.SCENE.LINK,pagecode:n.LIST_PAGE_INFO.PAGE_CODE})):u&&c(e,t.data,(function(){var o=t.data.head[n.CARD_PAGE_INFO.HEAD_CODE].rows[0].values[n.ITEM_INFO.PK].value,l=t.data.head[n.CARD_PAGE_INFO.HEAD_CODE].rows[0].values.vbillno.value;a&&"function"==typeof a&&a({billID:o,billNO:l}),r.cardCache.updateCache(n.ITEM_INFO.PK,o,i,n.CARD_PAGE_INFO.HEAD_CODE,n.APP_INFO.DATA_SOURCE),s(e),d(e)}))}}})},a.loadLinkData2Table=function(e){var a=r.cardCache.getDefData(n.CACHE_KEY.LINK_DATA,n.APP_INFO.DATA_SOURCE);a&&e.table.setAllTableData(n.LIST_PAGE_INFO.TABLE_CODE,a[n.LIST_PAGE_INFO.TABLE_CODE])}},74:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.buttonVisible=void 0;t(54),t(54),a.buttonVisible=function(e){0!=e.button.getButtons().length&&(e.button.setButtonVisible(["LinkList","Print","Refresh"],!0),e.button.setButtonVisible(["BaseGroup","Save","Cancel"],!1),e.button.setButtonVisible(["Commit","UnCommit","Bulu","BuluView"],!1))}},91:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.buttonVisible=a.initTemplate=a.buttonClick=void 0;var r,n=t(111),o=t(112),i=(r=o)&&r.__esModule?r:{default:r},l=t(74);a.buttonClick=n.buttonClick,a.initTemplate=i.default,a.buttonVisible=l.buttonVisible}})}));
//# sourceMappingURL=index.12f8eaec.js.map