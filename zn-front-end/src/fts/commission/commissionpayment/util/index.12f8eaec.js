/*! @ncctag {"provider":"test","date":"2020-5-11 22:19:54"} */
!function(e,a){"object"==typeof exports&&"object"==typeof module?module.exports=a(require("nc-lightapp-front")):"function"==typeof define&&define.amd?define(["nc-lightapp-front"],a):"object"==typeof exports?exports["fts/commission/commissionpayment/util/index"]=a(require("nc-lightapp-front")):e["fts/commission/commissionpayment/util/index"]=a(e["nc-lightapp-front"])}(window,(function(e){return function(e){var a={};function t(r){if(a[r])return a[r].exports;var n=a[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=a,t.d=function(e,a,r){t.o(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,a){if(1&a&&(e=t(e)),8&a)return e;if(4&a&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&a&&"string"!=typeof e)for(var n in e)t.d(r,n,function(a){return e[a]}.bind(null,n));return r},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="../../../../",t(t.s=55)}({0:function(a,t){a.exports=e},10:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.orgVersionView=function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pk_org",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org_v";if(e&&a){var n=e.getUrlParam("status"),i="browse"==n,o={};o[t]=!i,o[r]=i,e.form.setFormItemsVisible(a,o)}},a.orgVersionViewNew=function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pk_org",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org_v";if(e&&a){var n=e.getUrlParam("status"),i="browse"==n,o={};o[t]=!i,o[r]=i,e.form.setItemsVisible(a,o)}}},2:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.URL_PARAM={ID:"id",STATE:"status",SCENE:"scene",TBB_LINK:"pk_ntbparadimvo",LINK_ID:"linkId",PK_SRC:"pk_src"},a.sagaField={frozen:"saga_frozen",gtxid:"saga_gtxid",btxid:"saga_btxid",status:"saga_status"},a.sagaFrozenEnum={frozen:1,unfrozen:0},a.sagaStateEnum={success:0,fail:1},a.SCENE={DEFAULT:"defaultsce",APPROVE:"approvesce",LINK:"linksce",FIP:"fip",OTHER:"othersce"},a.LINKTYPE={NORMAL:"NORMAL",BILL_REVIEW:"BILL_REVIEW"},a.LINK_PARAM={ARAP:{FLAG:"flag",FLAG_VALUE:"ftsLinkArap"}},a.MODULE_INFO={TMPUB:"tmpub",TMPUB_NUM:"3601"},a.COMMON_URL={ELECSIGNPRINTCHECK:"/nccloud/tmpub/pub/elecsignprintcheck.do"},a.cache={rateinfo:"rateinfo",iserrtoast:"iserrtoast"},a.SPLIT_TBBCTRLTYPE="_ctrltype_",a.tbbwarntype={flexibility:"0",inflexibility:"1",warning:"2"}},25:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.app_id="0001Z61000000001TS3P",a.module_id="3630",a.oid="1001Z61000000002M6N3",a.base_url="/nccloud/fts/commission/",a.base_path="/fts/commission/commissionpayment/",a.ConfirmData={pmtConfirmUrl:"/obm/ebankconfirmpay/confirmpay/main/index.html#/card",pagecode:"36100CONFM_C01",appcode:"36100CONFM",billtype:"36CC"},a.PayChangeData={payChangeUrl:"/fts/commission/payinfochange/card/index.html",pagecode:"36300CPI_C01",appcode:"36300CPI",billtype:"36J8"},a.button_limit=3,a.billtype="36J5",a.link_billtype="36J1",a.funcode="36300TP",a.print_templateid="1001Z61000000001NJ9N",a.print_nodekey=null,a.printnodekey={official:"OFFICIAL",inofficial:"INOFFICIAL"},a.PaymentConst={dataSource:"TM_FTS_CommissionPayment_base",pk_filed:"pk_payment",hasQryFlag:"hasQryFlag",queryCondition:"queryCondition",islink:"islinkpayment",saveAddOrg:"saveaddorg",linkSourceData:"linkSourceData",billType:"36J1"},a.list_page_id="36300TP_L01",a.list_search_id="36300TP_search",a.list_table_id="payment",a.card_page_id="36300TP_C01",a.card_from_id="payment",a.card_from_exchangemsg_id="exchangepay",a.card_from_delivermsg_id="deliver",a.card_from_vsourcemsg_id="vsourcemsg",a.card_from_auditinfo_id="auditinfo",a.card_table1_id="paymentfinance",a.card_table2_id="paymentfund",a.card_tablebrowse1_id="childform1",a.card_tablebrowse2_id="childform3",a.card_tableedit1_id="childform2",a.card_tableedit2_id="childform4",a.saga_gtxid="saga_gtxid",a.pk="pk_payment",a.PayFundVO={ISEBANKWRITEFULL:"isebankwritefull",ISEBANKBACKFULL:"isebankbackfull",ISEBANKUNBACKFULL:"isebankunbackfull",ISNETPAY:"isnetpay",ISEBANKUNBACK:"isebankunback",ISEBANKBACK:"isebankback"},a.viewmod_deal="deal",a.LISTGROUP={NEEDDEAL:"0",NEEDCOMMIT:"1",APPROVING:"2",NEEDPAY:"3",PAYING:"4",ALL:"5"},a.billstatus={WaitCommit:0,WaitDecide:1,WaitApprove:2,WaitPay:3,Paying:4,WaitTransfer:5,Transfered:6,Back:7,PayOK:8,Merge:9,Abolish:10},a.group_all=5,a.busType={BusType_BillPay:"billpay",BusType_BillPayAwoke:"billpayawoke",BusType_BillMerge:"billmerge",BusType_BillDeliver:"billdeliver",BusType_BillHand:"billhand",BusType_BillFBM:"billfbm"},a.NetPay_Status={NetPay_Success:0,NetPay_Fail:1,NetPay_Paying:2,NetPay_UnCommit:3},a.IPaymentConst={Pay_Proxy:{value:"proxypay",display:"代理支付"},Pay_Note:{value:"notepay",display:"票据支付"},Pay_Group:{value:"grouppay",display:"集团支付"},Pay_Cash:{value:"cashpay",display:"现金支付"},Pay_Back:{value:"backpay",display:"回拨支付"},Pay_Direct:{value:"directpay",display:"直接支付"},Pay_Hand:{value:"handpay",display:"手工支付"}},a.IClearConst={DeliverDirection_Up:"up",DeliverDirection_Down:"down",DeliverType_Step:"step",DeliverType_Direct:"direct",RefNodeName_InnerAccount:"内部账户",RefNodeName_BankAccount:"使用权参照"},a.Button_PayVisible=["Pay","MergePay","CallBackPay","RecoveryFund","UnPay","Abolish","QueryStatus","PayChangeBill","UnionCheckPayBill"],a.Button_CardHeadDisable=["AddLine","DelLine","CopyLine","AddLine2","DelLine2","CopyLine2"],a.card_hidden_buttons=["BankAccReWrite","Save","SaveAdd","SaveCommit","Delete","Commit","Decide","Back","Undecide","Uncommit","Deliver","Undeliver","Pay","MergePay","CallBackPay","RecoveryFund","UnPay","Abolish","UnionCheckPayBill","QueryStatus","PayChangeBill","Cancel","Add","Premit","Unpremit","Edit","Copy"],a.head_hidden_buttons=["BatchDelete","Copy","BatchCommit","File","Print","BatchBankAccBrowse","BatchDownReBrowse","BatchUpReBrowse","BatchPremit","BatchUnPremit"],a.head_majorbuttons=["Add","Commit","Decide","Pay","Premit","Deliver"],a.cache={iserrtoast:"iserrtoast"}},53:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.rewriteTransferSrcBids=a.deleteCacheDataForList=a.getNextId=a.getCurrentLastId=a.getDefData=a.setDefData=a.hasListCache=a.addCacheData=a.getCacheDataByPk=a.deleteCacheData=a.updateCacheData=a.changeUrlParam=void 0;var r=t(0);a.changeUrlParam=function(e,a){e.setUrlParam(a)},a.updateCacheData=function(e,a,t,n,i,o,l){r.cardCache.addCache;var s=r.cardCache.updateCache;r.cardCache.getCacheById,s(a,t,n,i,o)},a.deleteCacheData=function(e,a,t,n){var i=r.cardCache.deleteCacheById;r.cardCache.getNextId,i(a,t,n)},a.getCacheDataByPk=function(e,a,t){return(0,r.cardCache.getCacheById)(t,a)},a.addCacheData=function(e,a,t,n,i,o,l){(0,r.cardCache.addCache)(t,n,i,o,l)},a.hasListCache=function(e,a){return e.table.hasCacheData(a)},a.setDefData=function(e,a,t){(0,r.cardCache.setDefData)(a,e,t)},a.getDefData=function(e,a){return(0,r.cardCache.getDefData)(a,e)},a.getCurrentLastId=function(e){return(0,r.cardCache.getCurrentLastId)(e)},a.getNextId=function(e,a,t){return(0,r.cardCache.getNextId)(a,t)},a.deleteCacheDataForList=function(e,a,t){e.table.deleteCacheId(a,t)},a.rewriteTransferSrcBids=function(e,a,t){if(t){var r=[];t.forEach((function(e){r.push(e.values[a].value)})),e.transferTable.setSavedTransferTableDataPk(r)}}},55:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.clearOutAccountView=a.fbmBillnoDisplay=a.resetBodysRowno=a.handlerCardTableInsertAfter=a.getRelationIndexFinanceOrg=a.isEbankBuLuInfoFullForList=a.isEbankBuLuInfoFull=a.TbbLinkBill=a.VoucherLinkBill=a.handleIsNeedCADentify=a.setListButtonUseful=a.setCardShouderBtnUseful=a.versionControl=void 0;var r=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},n=t(0),i=t(10),o=t(25),l=(t(2),t(7)),s=(a.versionControl=function(e){var a={};a[o.card_from_id]=["pk_org","pk_fundpayorg","pk_transactorg"];(0,i.orgVersionView)(e,a,{})},a.setCardShouderBtnUseful=function(e,a,t,r){var n="deal"==e.getUrlParam("status"),i=e.form.getFormItemsValue(o.card_from_id,"pk_org")&&e.form.getFormItemsValue(o.card_from_id,"pk_org").value,l=e.cardTable.getCheckedRows(a),s=!1,u=!1,c=e.form.getFormItemsValue(o.card_from_id,"vsourcebustype")&&this.props.form.getFormItemsValue(o.card_from_id,"vsourcebustype").value;if(o.busType.BusType_BillFBM==c&&(u=!0),l&&l.length>0&&(s=!0),a==o.card_table1_id){if(e.button.setButtonDisabled(["AddLine","DelLine","CopyLine"],!0),n)return;if(i&&e.button.setButtonDisabled(["AddLine"],!1),u&&e.button.setButtonDisabled(["AddLine"],!0),e.cardTable.getCheckedRows(a),parseInt(t)>0||s){if(u)return e.button.setButtonDisabled(["DelLine"],!1),void e.button.setButtonDisabled(["AddLine","CopyLine"],!0);e.button.setButtonDisabled(["DelLine","CopyLine"],!1)}}else if(e.button.setButtonDisabled(["AddLine2","DelLine2","CopyLine2"],!0),i&&e.button.setButtonDisabled(["AddLine2"],!1),(u||d(e))&&e.button.setButtonDisabled(["AddLine2"],!0),parseInt(t)>0||s){if(u||d(e))return void e.button.setButtonDisabled(["AddLine2","DelLine2","CopyLine2"],!0);e.button.setButtonDisabled(["DelLine2","CopyLine2"],!1)}},a.setListButtonUseful=function(){this.props.button.setButtonDisabled(list_head_buttons,!0);var e=this.props.table.getCheckedRows(list_table_id);if(e&&0!=e.length){if(1==e.length){this.props.button.setButtonDisabled(["Copy","linkgroup","LinkNtbPlan","File","Print","OutPut","Refresh"],!1);var a=null,t=null,r=null,n=null;e.forEach((function(e){a=e.data.values.billstatus.value,t=e.data.values.vbillstatus.value,r=e.data.values.ismakevoucher.value,n=e.data.values.recmodul.value})),"5"==a?this.props.button.setButtonDisabled(["BatchDelete","BatchCommit"],!1):"2"==a?this.props.button.setButtonDisabled(["BatchUncommit","LinkViewApprove"],!1):"3"!=a||r?"1"==t&&r&&this.props.button.setButtonDisabled(["LinkViewApprove","LinkSendBill","LinkQueryVoucher"],!1):this.props.button.setButtonDisabled(["BatchUncommit","LinkViewApprove","LinkSendBill"],!1),n==sourceModel.ModuleCode_CMP&&this.props.button.setButtonDisabled(["LinkSourceBill"],!1)}else if(e.length>1){this.props.button.setButtonDisabled(["Print","OutPut","Refresh"],!1);var i=this.state.selectedGroup;i==group_approving?this.props.button.setButtonDisabled(["BatchUncommit"],!1):i==group_needcommit?this.props.button.setButtonDisabled(["BatchDelete","BatchCommit"],!1):i==group_all&&this.props.button.setButtonDisabled(["BatchDelete","BatchCommit","BatchUncommit"],!1)}}else this.props.button.setButtonDisabled(list_head_buttons,!0)},a.handleIsNeedCADentify=function(e,a,t,r,i){var l=[];if(i&&0!=i.length)l=i;else if("card"==t){var s=e.form.getFormItemsValue(a,"pk_payment").value;l.push(s)}else{var d=e.table.getCheckedRows(a);if(d&&d.length>0)for(var u=0;u<d.length;u++){var c=d[u].data.values.pk_payment.value;l.push(c)}}if(0==l.length)return!1;var p=!1;return(0,n.ajax)({url:o.base_url+"paymentcadentify.do",data:{actionCode:r,pks:l},async:!1,success:function(e){p=e.data},error:function(e){p="error",(0,n.toast)({color:"warning",content:e.message})}}),p},a.VoucherLinkBill=function(e,a,t){var r;r=n.cacheTools.get("checkedData");var i={pageInfo:JSON.stringify(e.table.getTablePageInfo(t))};r&&r.length>0&&(0,n.ajax)({url:o.base_url+"paymentvoucherbill.do",data:{operatingLogVO:r,pageCode:a,extParam:i},success:function(a){var r=a.success,n=a.data;if(r)if(n){var i=n.grid;if(1==i[t].rows.length){var s=i[t].rows[0].values.pk_payment.value;(0,l.setDefData)(o.PaymentConst.dataSource,o.PaymentConst.linkSourceData+s,i[t]),e.table.setAllTableData(t,i[t]),setTimeout((function(){e.pushTo("/card",{status:"browse",id:s,pagecode:o.card_page_id,autolink:"Y"})}),10)}else i?e.table.setAllTableData(t,i[t]):e.table.setAllTableData(t,{rows:[]})}else e.table.setAllTableData(t,{rows:[]})}})},a.TbbLinkBill=function(e,a,t){var i,s=this,d=(this.state.selectedGroup,this),u=JSON.stringify(e.table.getTablePageInfo(t)),c=e.getUrlParam("pk_ntbparadimvo");c&&(i={pageCode:a,extParam:{tbbParam:c,pageInfo:u}},(0,n.ajax)({url:o.base_url+"paymenttbblinkbill.do",data:i,success:function(a){var n=a.success,i=a.data;if(n)if(i)if(i){var u=i.grid,c=i.head;if(u)e.table.setAllTableData(t,i.grid[t]);else if(c){var p=c[o.card_from_id].rows[0].values.pk_payment.value;(0,l.setDefData)(o.PaymentConst.dataSource,o.PaymentConst.linkSourceData+p,c[o.card_from_id]);var f={};f[t]=r({},c[o.card_from_id]),e.table.setAllTableData(t,f[t]),setTimeout((function(){e.pushTo("/card",{status:"browse",id:p,pagecode:o.card_page_id,autolink:"Y"})}),10)}else s.props.table.setAllTableData(s.tableId,{rows:[]});i.numvalues&&d.setState({numvalues:i.numvalues})}else s.props.table.setAllTableData(s.tableId,{rows:[]}),s.setState({numvalues:{}});else e.table.setAllTableData(t,{rows:[]})}}))},a.isEbankBuLuInfoFull=function(e,a){return"Pay"==a?s(e,o.PayFundVO.ISNETPAY,o.PayFundVO.ISEBANKWRITEFULL):"MergePay"!=a&&("RecoveryFund"==a?s(e,o.PayFundVO.ISEBANKUNBACK,o.PayFundVO.ISEBANKUNBACKFULL):"CallBackPay"==a?s(e,o.PayFundVO.ISEBANKBACK,o.PayFundVO.ISEBANKBACKFULL):void 0)},function(e,a,t){var r=e.cardTable.getAllRows(o.card_table2_id,!1);if(null!=r&&r.length>0)for(var n=0;n<r.length;n++){var i=r[n],l=i.values[a]&&i.values[a].value,s=i.values[t]&&i.values[t].value;if(l&&"N"!=l&&(!s||"N"==s||0==s))return!1}return!0}),d=(a.isEbankBuLuInfoFullForList=function(e,a,t,r){var i=t.pk_payment&&t.pk_payment.value,l=!1;return(0,n.ajax)({url:o.base_url+"paymentisbulufull.do",data:{actionCode:a,pk:i},async:!1,success:function(e){l=e.data},error:function(e){l="error",(0,n.toast)({color:"warning",content:e.message})}}),l},a.getRelationIndexFinanceOrg=function(e,a,t,r){var n=(a.values.relationindex||{}).value;if(null!=n&&null!=n)for(var i=e.cardTable.getAllRows(r,!1),o=0;o<i.length;o++){var l=i[o];if(l.values.relationindex.value==n)return l.values.pk_financeorg_p.value||null}},a.handlerCardTableInsertAfter=function(e,a){var t=this.rateflag;e.cardTable.setColEditableByKey(o.card_table1_id,"olcrate",t),e.cardTable.setColEditableByKey(o.card_table2_id,"olcrate",t)},a.resetBodysRowno=function(e){var a=e.cardTable.getAllRows(o.card_table1_id,!0),t=e.cardTable.getAllRows(o.card_table2_id,!0);this.props.beforeUpdatePage();for(var r=0;r<a.length;r++)"3"==a[r].status&&e.cardTable.setValByKeyAndIndex(o.card_table1_id,r,"dr",{value:Number(parseInt(1)).toString()}),e.cardTable.setValByKeyAndIndex(o.card_table1_id,r,"rowno",{value:Number(parseInt(r)+parseInt(1)).toString()});for(var n=0;n<t.length;n++)"3"==t[n].status&&e.cardTable.setValByKeyAndIndex(o.card_table2_id,n,"dr",{value:Number(parseInt(1)).toString()}),e.cardTable.setValByKeyAndIndex(o.card_table2_id,n,"rowno",{value:Number(parseInt(n)+parseInt(1)).toString()});this.props.updatePage(o.card_from_id,[o.card_table1_id,o.card_table2_id])},a.fbmBillnoDisplay=function(e,a){for(var t=a[o.card_table2_id].rows,r=0;r<t.length;r++){var n=t[r],i=(n.values.paymode||{}).value;if(o.IPaymentConst.Pay_Note.value==i){n.values.pk_billno.value;var l=n.values.billno.value;n.values.notenumber={value:l,display:l}}}return a},a.clearOutAccountView=function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pk_clearoutaccount",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_clearoutbankaccount";if(e&&a){var n=e.getUrlParam("status"),i="browse"==n,l={};if(i)l[t]=!0,l[r]=!1;else{var s=(e.form.getFormItemsValue(o.card_from_id,"clearoutacctype")||{}).value,d=e.form.getFormItemsValue(o.card_from_id,"pk_clearoutbankaccount");d&&d.value||e.form.setFormItemsValue(o.card_from_id,{pk_clearoutbankaccount:{value:e.form.getFormItemsValue(o.card_from_id,"pk_clearoutaccount")&&e.form.getFormItemsValue(o.card_from_id,"pk_clearoutaccount").value,display:e.form.getFormItemsValue(o.card_from_id,"pk_clearoutaccount")&&e.form.getFormItemsValue(o.card_from_id,"pk_clearoutaccount").display}}),s&&"inneraccount"!=s?(l[r]=!0,l[t]=!1):(l[r]=!1,l[t]=!0)}e.form.setFormItemsVisible(o.card_from_id,l)}},function(e){var a=e.form.getFormItemsValue(o.card_from_id,"isinform").value;return!!(a&&1==a||a&&"Y"==a)})},7:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.rewriteTransferSrcBids=a.deleteCacheDataForList=a.getNextId=a.getCurrentLastId=a.getDefData=a.setDefData=a.hasListCache=a.addCacheData=a.getCacheDataByPk=a.deleteCacheData=a.updateCacheData=a.changeUrlParam=void 0;var r=t(53);a.changeUrlParam=r.changeUrlParam,a.updateCacheData=r.updateCacheData,a.deleteCacheData=r.deleteCacheData,a.getCacheDataByPk=r.getCacheDataByPk,a.addCacheData=r.addCacheData,a.hasListCache=r.hasListCache,a.setDefData=r.setDefData,a.getDefData=r.getDefData,a.getCurrentLastId=r.getCurrentLastId,a.getNextId=r.getNextId,a.deleteCacheDataForList=r.deleteCacheDataForList,a.rewriteTransferSrcBids=r.rewriteTransferSrcBids}})}));
//# sourceMappingURL=index.12f8eaec.js.map