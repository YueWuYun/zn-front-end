/*bBCoqjxT9j3Xs5elv8XzMXkXcQatzZQbf2J+0PHwCbQn9I8O70gYqs6WRoYZRPPS*/
/*! @ncctag {"date":"2020-4-17 16:05:39"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["fbm/fbm/discountcalculate/list/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["fbm/fbm/discountcalculate/list/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,(function(e,t,a){return function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=744)}({1:function(t,a){t.exports=e},10:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.go2CardCheck=t.tbbWarnDialog=t.showTBBMsg=t.getTBBMsg=t.saveCommit=t.frozenBtnCtrl=t.showErrBtn=t.createCardWebSocket=t.createListWebSocket=t.setRate2NewRow=t.getCacheRateValue=t.bodyRateEditOnAfterEdit=t.addDefReferFilter=t.elecSignCardPrint=t.elecSignListPrint=t.createSimpleBillData=t.buildLightBodyAfterEditData=t.loadMultiLang=t.getMultiLangRes=t.appendMultiLangRes=t.saveMultiLangRes=t.getPropCache=t.setPropCache=t.showPagination=t.setDefOrg2AdvanceSrchArea=t.setDefOrg2ListSrchArea=t.setDefOrg2Form=t.hasDefaultOrg=t.isLinkScene=void 0;var r=a(1),n=a(9);function o(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,a){return function r(n,o){try{var i=t[n](o),l=i.value}catch(e){return void a(e)}if(!i.done)return Promise.resolve(l).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(l)}("next")}))}}var i,l,s=t.isLinkScene=function(e){var t=e.getUrlParam(n.URL_PARAM.SCENE);return!(!!!e.getUrlParam(n.URL_PARAM.TBB_LINK)&&t!=n.SCENE.LINK&&t!=n.SCENE.FIP)},u=t.hasDefaultOrg=function(e){return e&&e.context&&e.context&&e.context.pk_org},c=function(e,t,a){if(!(e&&e.search&&t&&a))return!1;try{var r=e.search.getSearchValByField(t,a);return!(!r||!r.value||!r.value.firstvalue&&!r.value.secondvalue)}catch(e){return!0}},d=(t.setDefOrg2Form=function(e,t,a){if(e&&t&&u(a)){var r=a.context,n=r.pk_org,o=r.org_Name,i=r.pk_org_v,l=r.org_v_Name;e.form.setFormItemsValue(t,{pk_org:{value:n,display:o},pk_org_v:{value:i,display:l}})}},t.setDefOrg2ListSrchArea=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org";if(e&&e.search&&t&&u(a)&&!s(e)&&!c(e,t,r)){var n=a.context,o=n.pk_org,i=n.org_Name,l={display:i,value:o};e.search.setSearchValByField(t,r,l)}},t.setDefOrg2AdvanceSrchArea=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pk_org";if(e&&e.search&&t&&u(a)&&a.template&&!s(e)){var n=a.template,o=a.context,i=o.pk_org,l=o.org_Name;n[t].items.map((function(e){e.attrcode==r&&(e.initialvalue={display:l,value:i})}))}},t.showPagination=function(e,t,a){e&&t&&a&&!a.template&&(a.template[t].pagination=!s(e))},function(e){return e+"_extObj"}),f=(t.setPropCache=function(e,t,a,r){if(e&&t&&a){var n=d(t),o=e.ViewModel.getData(n);o||(o={}),o[a]=r,e.ViewModel.setData(n,o)}},t.getPropCache=function(e,t,a){if(!e||!t||!a)return null;var r=d(t),n=e.ViewModel.getData(r);return n&&n.hasOwnProperty(a)?n[a]:null},t.saveMultiLangRes=function(e,t){if(e&&t){e.ViewModel.setData("multiLang",t)}}),v=(t.appendMultiLangRes=function(e,t){if(e&&t){var a=v(e);a?Object.assign(a,t):f(e,t)}},t.getMultiLangRes=function(e){if(e){return e.ViewModel.getData("multiLang")}}),h=t.loadMultiLang=function(e,t){var a=v(e);return a&&a[t]||""},p=function(e,t){var a={},r=e.form.getAllFormValue(t);return r.areacode=t,a[t]=r,a},g=function(e,t){var a={rows:e.cardTable.getChangedRows(t),areaType:"table",areacode:t},r={};return r[t]=a,r},y=function(e,t,a,r,n,o,i,l){var s={head:p(e,a),pageid:t};return l?s.body=g(e,r):s.bodys=g(e,r),{areacode:r,attrcode:n,card:s,changedrows:o,index:i}},m=(t.buildLightBodyAfterEditData=function(e,t,a,r,n,o,i){var l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];try{if(!(e&&t&&a&&r&&n&&o))throw new Error("参数缺失！");var s=y(e,t,a,r,n,o,i,l),u=s.card,c=u.body,d=u.bodys;if(l&&1==c[r].rows.length||!l&&1==d[r].rows.length)return s;var f=[],v=o[0].rowid;if(!(c=l?c[r]:d[r]))throw new Error("未获取到指定的表体["+r+"]!");var h=c,p=h.rows,g=!0,m=!1,b=void 0;try{for(var C,_=p[Symbol.iterator]();!(g=(C=_.next()).done);g=!0){var I=C.value,w=I.rowid;if(w&&w==v){f.push(I);break}}}catch(e){m=!0,b=e}finally{try{!g&&_.return&&_.return()}finally{if(m)throw b}}if(0==f.length)throw new Error("未找到修改的行!");return c.rows=f,s}catch(e){throw e}},function(e){if(!e||0==e.length)return null;var t=!0,a=!1,r=void 0;try{for(var n,o=e[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var i=n.value;if(i&&i.values&&0!=Object.keys(i.values).length){var l=i.values,s=Object.keys(l),u=!0,c=!1,d=void 0;try{for(var f,v=s[Symbol.iterator]();!(u=(f=v.next()).done);u=!0){var h=f.value,p=l[h];p&&0!=Object.keys(p).length&&p.value||delete l[h]}}catch(e){c=!0,d=e}finally{try{!u&&v.return&&v.return()}finally{if(c)throw d}}}}}catch(e){a=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw r}}}),b=function(e,t,a,r,n){var o=e.createMasterChildDataSimple(t,a,r),i=o.head,l=o.body;return n&&(m(i[a].rows),m(l[r].rows)),o},C=function(e,t,a,r,n){var o=e.createExtCardDataSimple(t,a,r),i=o.head,l=o.bodys;if(n){m(i[a].rows);var s=!0,u=!1,c=void 0;try{for(var d,f=r[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){var v=d.value;m(l[v].rows)}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}return o},_=t.createSimpleBillData=function(e,t,a,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!(e&&t&&a&&r))return null;var o=!!Array.isArray(r)&&r.length>1,i=Array.isArray(r)?r:[r];return o?C(e,t,a,i,n):b(e,t,a,i[0],n)},I=(t.elecSignListPrint=function(e,t){var a=t.url,n=t.offical,o=void 0!==n&&n,i=t.appCode,l=t.nodeKey,s=t.tableCode,u=t.field_id,c=t.field_billno,d=void 0===c?"vbillno":c,f=t.getOrgFunc,v=t.validateFunc;if(!(a&&i&&s&&u&&d))throw new Error("参数缺失！");var p=e.table.getCheckedRows(s);if(null!=p&&0!=p.length){var g=[],y=[],m=!0,b=!1,C=void 0;try{for(var _,I=p[Symbol.iterator]();!(m=(_=I.next()).done);m=!0){var k=_.value,D=k&&k.data&&k.data.values&&k.data.values[u]&&k.data.values[u].value;if(D){var T=k&&k.data&&k.data.values&&k.data.values[d]&&k.data.values[d].value,S=k&&k.data&&k.data.values&&k.data.values.pk_org&&k.data.values.pk_org.value,E=k.index;f&&"function"==typeof f&&(S=f(k));var P=!0;if(v&&"function"==typeof v){var R=v(k);R&&(y.push(A(e,R,T,E)),P=!1)}P&&g.push({id:D,vbillno:T,pk_org:S,index:E})}}}catch(e){b=!0,C=e}finally{try{!m&&I.return&&I.return()}finally{if(b)throw C}}w(e,{url:a,offical:o,appCode:i,nodeKey:l,detail:g,errMessArr:y})}else(0,r.toast)({color:"warning",content:h(e,"3601-000010")})},t.elecSignCardPrint=function(e,t){var a=t.url,r=t.offical,n=void 0!==r&&r,o=t.appCode,i=t.nodeKey,l=t.headCode,s=t.field_id,u=t.field_billno,c=void 0===u?"vbillno":u,d=t.getOrgFunc,f=t.validateFunc;if(!(a&&o&&l&&s&&c))throw new Error("参数缺失！");var v=e.form.getFormItemsValue(l,s).value,h=e.form.getFormItemsValue(l,c).value,p=e.form.getFormItemsValue(l,"pk_org").value;d&&"function"==typeof d&&(p=d());var g=[],y=!0;if(f&&"function"==typeof f){var m=f();m&&(g.push(A(e,m,h,0)),y=!1)}w(e,{url:a,offical:n,appCode:o,nodeKey:i,detail:y?[{id:v,vbillno:h,pk_org:p}]:null,errMessArr:g})},function(e,t){t&&0!=t.length&&(1==t.length?(0,r.toast)({duration:"infinity",color:"danger",content:t[0],hasCloseBtn:!0}):(0,r.toast)({duration:"infinity",color:"danger",TextArr:[h(e,"3601-000000"),h(e,"3601-000001"),h(e,"3601-000021")],groupOperation:!0,groupOperationMsg:t}))}),w=function(e,t){var a=t.url,o=t.offical,i=t.appCode,l=t.nodeKey,s=t.detail,u=t.errMessArr,c=void 0===u?[]:u;if(!(c&&c.length>0)||s&&0!=s.length){var d={offical:o,detail:s};(0,r.ajax)({url:n.COMMON_URL.ELECSIGNPRINTCHECK,data:d,success:function(t){var n=t.data,s=n.passPKs,u=n.passInfos,d=n.unPassInfos;if(c.length>0||d&&d.length>0){var f=!0,v=!1,h=void 0;try{for(var p,g=d[Symbol.iterator]();!(f=(p=g.next()).done);f=!0){var y=p.value,m=y.vbillno,b=y.mess,C=y.index,_=A(e,b,m,C);c.push(_)}}catch(e){v=!0,h=e}finally{try{!f&&g.return&&g.return()}finally{if(v)throw h}}I(e,c)}if(s&&s.length>0&&u&&u.length>0){var w={offical:o,detail:u};(0,r.print)("pdf",a,{nodekey:l,appcode:i,oids:s,userjson:JSON.stringify(w)})}}})}else I(e,c)},A=function(e,t,a,r){return h(e,"3601-000008")+a+h(e,"3601-000009")+t||""},k=(t.addDefReferFilter=function(e,t){var a=t.headCode,r=t.areaCode,n=t.meta,o=t.orgField,i=t.getOrgFunc;if(r&&n&&(a||o||i)){var l=Array.isArray(r)?r:[r],s=!0,u=!1,c=void 0;try{for(var d,f=l[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){n[d.value].items.map((function(t){(t.attrcode.startsWith("vdef")||t.attrcode.startsWith("vuserdef"))&&(t.queryCondition=function(){return{pk_org:i&&"function"==typeof i?i():(e.form.getFormItemsValue(a,o)||{}).value}})}))}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}},t.bodyRateEditOnAfterEdit=function(e){var t=e.props,a=e.bodyCodes,o=e.rateInfo,i=e.datasource,l=e.olcRates,s=e.glcRates,u=e.gllcRates;if(t&&o&&i&&a){!function(e){var t=e.rateInfo,a=e.datasource;if(t&&a){r.cardCache.setDefData(n.cache.rateinfo,a,t);r.cardCache.getDefData(n.cache.rateinfo,a)}}({rateInfo:o,datasource:i}),Array.isArray(a)||(a=[a]);var c=o.olcRateEditable,d=o.glcRateEditable,f=o.gllcRateEditable,v=!0,h=!1,p=void 0;try{for(var g,y=a[Symbol.iterator]();!(v=(g=y.next()).done);v=!0){var m=g.value;l&&(Array.isArray(l)||(l=[l]),t.cardTable.setColEditableByKey(m,l,!c)),s&&(Array.isArray(s)||(s=[s]),t.cardTable.setColEditableByKey(m,s,!d)),u&&(Array.isArray(u)||(u=[u]),t.cardTable.setColEditableByKey(m,u,!f))}}catch(e){h=!0,p=e}finally{try{!v&&y.return&&y.return()}finally{if(h)throw p}}}},t.getCacheRateValue=function(e){var t=e.datasource;if(t){var a=r.cardCache.getDefData(n.cache.rateinfo,t);return a?{olcRate:a.olcRate,glcRate:a.glcRate,gllcRate:a.gllcRate}:null}}),D=(t.setRate2NewRow=function(e){var t=e.olcRates,a=e.glcRates,r=e.gllcRates,n=e.datasource,o=e.row;if(n){var i=k({datasource:n});if(i){var l=i.olcRate,s=i.glcRate,u=i.gllcRate;if(t){Array.isArray(t)||(t=[t]);var c=!0,d=!1,f=void 0;try{for(var v,h=t[Symbol.iterator]();!(c=(v=h.next()).done);c=!0){o[v.value]={value:l}}}catch(e){d=!0,f=e}finally{try{!c&&h.return&&h.return()}finally{if(d)throw f}}}if(a){Array.isArray(a)||(a=[a]);var p=!0,g=!1,y=void 0;try{for(var m,b=a[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){o[m.value]={value:s}}}catch(e){g=!0,y=e}finally{try{!p&&b.return&&b.return()}finally{if(g)throw y}}}if(r){Array.isArray(r)||(r=[r]);var C=!0,_=!1,I=void 0;try{for(var w,A=r[Symbol.iterator]();!(C=(w=A.next()).done);C=!0){o[w.value]={value:u}}}catch(e){_=!0,I=e}finally{try{!C&&A.return&&A.return()}finally{if(_)throw I}}}}}},t.createListWebSocket=function(e,t){var a=t.tableAreaCode,r=t.tablePkName,n=t.billtype,o=t.dataSource,i=t.serverLocation;if(e&&a&&r&&n){var l=e.socket,s={tableAreaCode:a,billpkname:r,billtype:n,dataSource:o};return i&&(s.serverLocation=i),React.createElement("div",null,l.connectMesg(s))}},t.createCardWebSocket=function(e,t){var a=t.headBtnAreaCode,r=t.formAreaCode,n=t.billpkname,o=t.billtype,i=t.dataSource,l=t.serverLocation;if(e&&a&&r&&n&&o){var s=e.socket,u={headBtnAreaCode:a,formAreaCode:r,billtype:o,billpkname:n,dataSource:i};return l&&(u.serverLocation=l),React.createElement("div",null,s.connectMesg(u))}},t.showErrBtn=function(e,t){var a=t.headBtnCode,r=t.headAreaCode,o=t.fieldPK;t.datasource;if(e&&a&&r){var i=e.getUrlParam(n.URL_PARAM.STATE),l="0";try{l=e.form.getFormItemsValue(r,n.sagaField.status).value}catch(e){l="0"}var s="1"===l&&"browse"==i;e.button.toggleErrorStatus(a,{isError:s}),s&&D(e,{headAreaCode:r,fieldPK:o})}},function(e,t){var a=t.headAreaCode,r=t.fieldPK;if(a&&r){var o=e.getUrlParam("status"),i=e.form.getFormItemsValue(a,n.sagaField.gtxid),l=e.form.getFormItemsValue(a,r);"browse"==o&&i&&i.value&&l&&l.value&&e.socket.showToast({gtxid:i.value,billpk:l.value})}}),T=(t.frozenBtnCtrl=function(e,t){var a=t.btnCodes;if(e&&a){var r=Array.isArray(a)?a:[a];if("browse"==e.getUrlParam(n.URL_PARAM.STATE)){var o="1";try{o=e.form.getFormItemsValue(headAreaCode,n.sagaField.frozen).value}catch(e){o="1"}e.button.setButtonDisabled(r,"1"==o)}}},function(e,t){var a=t.pageCode,r=t.headCode,n=t.bodyCodeArr,o=t.saveFunc,i={},l={};if(0==n.length)i={pageid:a,model:{areacode:r,rows:e.form.getAllFormValue(r).rows,areaType:"form"}},l[r]="form";else{i=n.length>1?e.createExtCardData(a,r,n):e.createMasterChildData(a,r,n[0]);var s=!0,u=!1,c=void 0;try{for(var d,f=n[Symbol.iterator]();!(s=(d=f.next()).done);s=!0){l[d.value]="cardTable"}}catch(e){u=!0,c=e}finally{try{!s&&f.return&&f.return()}finally{if(u)throw c}}}e.validateToSave(i,o,l,"")}),S=(i=o(regeneratorRuntime.mark((function e(t,a){var r,n=a.pageCode,o=a.headCode,i=a.bodyCodeArr,l=a.saveValidate,s=a.processSaveData;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.form.isCheckNow(o)){e.next=2;break}return e.abrupt("return",null);case 2:if(!(i&&i.length>0)||t.cardTable.checkTableRequired()){e.next=4;break}return e.abrupt("return",null);case 4:if(!l||"function"!=typeof l){e.next=7;break}if(l()){e.next=7;break}return e.abrupt("return",null);case 7:if(r=_(t,n,o,i),!s||"function"!=typeof s){e.next=12;break}return e.next=11,s(r);case 11:r=e.sent;case 12:return e.abrupt("return",{data:JSON.stringify(r),pageCode:n});case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)}),E=(t.saveCommit=(l=o(regeneratorRuntime.mark((function e(t,a){var n,o,i=a.pageCode,l=a.headCode,s=a.bodyCode,u=a.url,c=a.assign,d=a.showAssignFunc,f=a.updateViewFunc,v=a.saveValidate,h=a.processSaveData,p=a.extParam;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&l&&u&&d&&f){e.next=2;break}return e.abrupt("return");case 2:return p||(p={}),n=(a=s)?Array.isArray(a)?a:[a]:[],e.next=6,S(t,{pageCode:i,headCode:l,bodyCodeArr:n,saveValidate:v,processSaveData:h});case 6:if(o=e.sent){e.next=9;break}return e.abrupt("return");case 9:c&&(p.content=JSON.stringify(c)),o.extParam=p,T(t,{pageCode:i,headCode:l,bodyCodeArr:n,saveFunc:function(){(0,r.ajax)({url:u,data:o,success:function(e){var t=e.data.workflow;t&&"approveflow"==t||"workflow"==t?d(e):f(e)}})}});case 12:case"end":return e.stop()}var a}),e,this)}))),function(e,t){return l.apply(this,arguments)}),t.getTBBMsg=function(e){var t=e.row,a=e.msgfield;a||(a="ntbinfo");var r=(t&&t.values&&t.values[a]||{}).value;return r&&(t.values[a]={value:null,display:null}),r});t.showTBBMsg=function(e){var t=e.head,a=e.headCode,n=e.msgfield;if(!(t&&a&&t[a]&&t[a].rows&&0!=t[a].rows.length))return!1;var o=!1,i=t[a].rows[0],l=E({row:i,msgfield:n});return l&&((0,r.toast)({color:"warning",content:l}),o=!0),o},t.tbbWarnDialog=function(e,t){var a=t.ntbinfos,n=t.onConfirm;if(a&&0!=a.length){var o=[],i=a.length>1,l=1,s=i?[h(e,"3601-000019")+"["+a.length+"]"+h(e,"3601-000020")]:[],u=!0,c=!1,d=void 0;try{for(var f,v=a[Symbol.iterator]();!(u=(f=v.next()).done);u=!0){var p=f.value;if(null!=p){var g=p.pk,y=p.msg,m=p.vbillno;if(g&&m){o.push(g);var b="";i&&(b=l+". "+h(e,"3601-000018")+"["+m+"] "),s.push(React.createElement("li",null,b+y)),l++}}}}catch(e){c=!0,d=e}finally{try{!u&&v.return&&v.return()}finally{if(c)throw d}}0!=s.length&&(0,r.promptBox)({color:"warning",title:h(e,"3601-000017"),content:React.createElement("ul",null,s),beSureBtnClick:function(){n(o)}})}},t.go2CardCheck=function(e){var t=e.props,a=e.url,n=e.pk,o=e.ts,i=e.fieldPK,l=e.actionCode,s=e.permissionCode,u=e.checkSaga,c=void 0===u||u,d=e.checkTS,f=void 0===d||d,v=e.go2CardFunc;v&&"function"==typeof v&&(t&&a&&n&&o&&i||v(),(0,r.ajax)({url:a,data:{pk:n,ts:o,actionCode:l,permissionCode:s,fieldPK:i,checkSaga:c,checkTS:f},success:function(e){v()}}))}},2:function(e,a){e.exports=t},264:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.base_path="/nccloud/fbm/discountcalculate";t.nodekey="36180DTCPRINTNCC",t.listQueryUrl=r+"/querylist.do",t.printUrl=r+"/print.do",t.afterUrl=r+"/interestafteredit.do",t.searchCache={key:"fbm.fbm.discountcalculate.searchCache",dataSource:"fbm.fbm.discountcalculate.searchSpace"},t.list={pageCode:"36180DTC_LIST",btnCode:"list_head",searchCode:"search",headCode:"head",tableCode:"table",listCache:"fbm.discountcalculate.discountcalculate.datasource"},t.allBtns=["DiscountCalculate","Print","Output"]},519:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchButtonClick=function(e,t,a,s){var u=this,c=e.form.getFormItemsValue(n.list.headCode,"interest_date_year").value,d=e.form.getFormItemsValue(n.list.headCode,"discount_date").value,f=e.form.getFormItemsValue(n.list.headCode,"interest_days").value,v=e.form.getFormItemsValue(n.list.headCode,"auto_calculate").value,h=e.form.getFormItemsValue(n.list.headCode,"delay_days").value,p=!0;c&&d&&f||(p=!1);"undefined"==t&&(t=!0);if(!a&&!s){if(!d)return(0,r.toast)({color:"warning",content:this.props.MutiInit.getIntl("36180DTC")&&this.props.MutiInit.getIntl("36180DTC").get("36180DTC-000001")});if(!c)return(0,r.toast)({color:"warning",content:this.props.MutiInit.getIntl("36180DTC")&&this.props.MutiInit.getIntl("36180DTC").get("36180DTC-000002")});if(!f)return(0,r.toast)({color:"warning",content:this.props.MutiInit.getIntl("36180DTC")&&this.props.MutiInit.getIntl("36180DTC").get("36180DTC-000003")})}var g=[];e.editTable.getCheckedRows(this.tableId).forEach((function(e){g.push(e.index)}));var y=e.search.getAllSearchData(this.searchId);y&&y.conditions&&y.conditions.forEach((function(e){e.field.indexOf("def")>-1&&e.value.firstvalue&&(e.value.firstvalue=e.value.firstvalue+"")}));var m={isCalculate:p,querycondition:y,pagecode:this.pageId,queryAreaCode:this.searchId,oid:this.searchOid,querytype:"tree",discount_date:d,interest_date_year:c,interest_days:f,delay_days:h,auto_calculate:v};l.call(this,n.listQueryUrl,m,t).then((function(t){i(u.searchCache.key,u.searchCache.dataSource,m),e.editTable.setStatus(u.tableId,"browse"),""!=t.digit&&u.props.form.setFormItemsValue("head",{interest_date_year:{value:c,display:c,scale:t.digit}});var a=t.grid[u.tableId];u.props.editTable.setTableData(u.tableId,a),o.buttonVisible.call(u,e),null!=t.validMessage&&(0,r.toast)({color:"warning",content:t.validMessage})}))},t.queryAjax=l;var r=a(1),n=a(264),o=a(520),i=r.cardCache.setDefData;r.cardCache.getDefData;function l(e,t,a){var o=this;return new Promise((function(i){(0,r.ajax)({url:e,data:t,success:function(e){var t=o.props.form.getFormItemsValue(n.list.headCode,"interest_date_year").value;""!=e.data.digit&&o.props.form.setFormItemsValue("head",{interest_date_year:{value:t,display:t,scale:e.data.digit}});var l=e.success,s=e.data;l&&s&&s.grid&&(i(e.data),a&&(0,r.toast)({color:"success",content:(o.props.MutiInit.getIntl("36180DTC")&&o.props.MutiInit.getIntl("36180DTC").get("36180DTC-000017"))+"，"+(o.props.MutiInit.getIntl("36180DTC")&&o.props.MutiInit.getIntl("36180DTC").get("36180DTC-000018"))+s.grid[o.tableId].pageInfo.total+(o.props.MutiInit.getIntl("36180DTC")&&o.props.MutiInit.getIntl("36180DTC").get("36180DTC-000019"))}))}})}))}},520:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttonVisible=function(e){e.button.setButtonVisible(["DiscountCalculate","Refresh","Print","Output"],!0);var t=e.editTable.getNumberOfRows(r.list.tableCode);t&&0!=t.length?e.button.setButtonDisabled(r.allBtns,!1):e.button.setButtonDisabled(r.allBtns,!0)};var r=a(264)},6:function(e,t){e.exports=a},744:function(e,t,a){"use strict";var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),n=a(1),o=a(2),i=h(o),l=h(a(6)),s=a(264),u=a(745),c=a(746),d=a(520),f=h(a(747)),v=a(519);function h(e){return e&&e.__esModule?e:{default:e}}var p=n.base.NCAffix,g=n.base.NCDiv,y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.renderCompleteEvent=function(){var e=a.props.MutiInit.getIntl("36180DTC"),t=e&&e.get("36180DTC-000021"),r=e&&e.get("36180DTC-000022"),n=e&&e.get("36180DTC-000023");a.props.search.setTemlateByField(a.searchId,"money","defaultPlaceholder",{start:t+r,end:t+n})},a.tableId=s.list.tableCode,a.searchId=s.list.searchCode,a.formId=s.list.headCode,a.pageid=s.list.pageCode,a.appcode=e.getSearchParam("c")||e.getUrlParam("c"),a.selectedPKS=[],a.searchCache=s.searchCache,a.state={billtype:"36H8"},f.default.call(a,e),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){d.buttonVisible.call(this,this.props)}},{key:"render",value:function(){var e=this.props,t=e.button,a=e.search,r=e.editTable,n=e.form,o=e.BillHeadInfo,l=n.createForm,f=r.createEditTable,h=a.NCCreateSearch,y=t.createButtonApp,m=o.createBillHeadInfo,b=this.props.MutiInit.getIntl("36180DTC");return i.default.createElement("div",{className:"nc-single-table"},i.default.createElement(p,null,i.default.createElement(g,{areaCode:g.config.HEADER,className:"nc-singleTable-header-area"},i.default.createElement("div",{className:"header-title-search-area"},m({title:b&&b.get("36180DTC-000000"),initShowBackBtn:!1})),i.default.createElement("div",{className:"header-button-area"},y({area:s.list.btnCode,onButtonClick:c.buttonClick.bind(this)})))),i.default.createElement("div",{className:"nc-singleTable-search-area remove-block"},h(this.searchId,{oid:this.searchOid,showAdvBtn:!0,showClearBtn:!0,clickSearchBtn:v.searchButtonClick.bind(this),renderCompleteEvent:this.renderCompleteEvent})),i.default.createElement("div",{className:"nc-bill-top-area remove-block",style:{"background-color":"#f6f6f6"}},i.default.createElement("div",{className:"nc-bill-form-area"},l(this.formId,{onAfterEvent:u.afterEvent.bind(this)}))),i.default.createElement("div",{className:"nc-singleTable-table-area"},f(this.tableId,{showIndex:!0,adaptionHeight:!0,onSelected:d.buttonVisible.bind(this),onSelectedAll:d.buttonVisible.bind(this)})))}}]),t}(o.Component);y=(0,n.createPage)({mutiLangCode:"36180DTC"})(y),l.default.render(i.default.createElement(y,null),document.querySelector("#app"))},745:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.afterEvent=function(e,t,a,i,l,s,u){var c=this,d=this.props.editTable,f=(d.setValByKeyAndIndex,d.getValByKeyAndIndex,e.createHeadAfterEventData(n.list.headCode,t,[],t,a,i)),v=e.form.getFormItemsValue(n.list.headCode,"interest_date_year").value,h=e.form.getFormItemsValue(n.list.headCode,"discount_date").value,p=e.form.getFormItemsValue(n.list.headCode,"interest_days").value,g=e.form.getFormItemsValue(n.list.headCode,"auto_calculate").value,y=e.form.getFormItemsValue(n.list.headCode,"delay_days").value;switch(a){case"discount_date":case"interest_days":case"auto_calculate":if(f.newvalue.value==f.oldvalue.value||!g)return;o.searchButtonClick.call(this,e,!1,!0);break;case"interest_date_year":if(f.newvalue.value==f.oldvalue.value)return;g?o.searchButtonClick.call(this,e,!1,!0):o.queryAjax.call(this,n.afterUrl,null,!1).then((function(e){""!=e.digit&&c.props.form.setFormItemsValue("head",{interest_date_year:{value:v,display:v,scale:e.digit}})}));break;case"delay_days":if(y<0)return(0,r.toast)({color:"warning",content:this.props.MutiInit.getIntl("36180DTC")&&this.props.MutiInit.getIntl("36180DTC").get("36180DTC-000004")});if(f.newvalue.value==f.oldvalue.value||!g)return;v&&h&&p&&o.searchButtonClick.call(this,e,!1,!0)}};var r=a(1),n=a(264),o=a(519)},746:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buttonClick=function(e,t){e.editTable.setStatus;switch(t){case"DiscountCalculate":if(e.form.getFormItemsValue(n.list.headCode,"delay_days").value<0)return(0,r.toast)({color:"warning",content:this.props.MutiInit.getIntl("36180DTC")&&this.props.MutiInit.getIntl("36180DTC").get("36180DTC-000004")});o.searchButtonClick.call(this,e,!1);break;case"Refresh":i(this.searchCache.key,this.searchCache.dataSource)&&(this.setState({showToast:!1}),o.searchButtonClick.call(this,e,!1,!1,!0)),(0,r.toast)({color:"success",content:this.props.MutiInit.getIntl("36180DTC")&&this.props.MutiInit.getIntl("36180DTC").get("36180DTC-000020")});break;case"Print":l.call(this,e,"Print");break;case"Output":l.call(this,e,"Output")}};var r=a(1),n=a(264),o=a(519),i=(r.cardCache.setDefData,r.cardCache.getDefData);function l(e,t){var a=e.form.getFormItemsValue(n.list.headCode,"interest_date_year").value,o=e.form.getFormItemsValue(n.list.headCode,"discount_date").value,i=e.form.getFormItemsValue(n.list.headCode,"interest_days").value,l=e.form.getFormItemsValue(n.list.headCode,"auto_calculate").value,s=e.form.getFormItemsValue(n.list.headCode,"delay_days").value,u=!0;a&&o&&i||(u=!1);var c=[];e.editTable.getAllRows(this.tableId).forEach((function(e){c.push(e.values.pk_register.value+"")})),"Print"==t?(0,r.print)("pdf",n.printUrl,{isCalculate:u,pkArray:c,discount_date:[o],interest_date_year:[a],interest_days:[i],delay_days:[s],auto_calculate:[l],funcode:e.getSearchParam("c")||e.getUrlParam("c"),nodekey:n.nodekey}):(0,r.output)({url:n.printUrl,data:{isCalculate:u,pkArray:c,discount_date:o,interest_date_year:a,interest_days:i,delay_days:s,auto_calculate:l,outputType:"output"}})}},747:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=this;e.createUIDom({pagecode:n.list.pageCode,appcode:e.getSearchParam("c")||e.getUrlParam("c")},(function(a){if(a){if(a.template){var l=a.template;l=i.call(t,e,l),(0,r.setDefOrg2AdvanceSrchArea)(e,n.list.searchCode,a),e.meta.setMeta(l),(0,r.setDefOrg2ListSrchArea)(e,n.list.searchCode,a),t.searchOid=l.search.oid,t.props.form.setFormStatus(n.list.headCode,"edit")}if(a.button){var s=a.button;e.button.setButtons(s),o.buttonVisible.call(t,e)}}}))};var r=a(10),n=a(264),o=a(520);function i(e,t){var a=this;return t[this.searchId].items&&(t[this.searchId].items=t[this.searchId].items.map((function(t,r){return"fbmbilltype"==t.attrcode&&(t.queryCondition=function(){return{GridRefActionExt:"nccloud.web.fbm.fbm.sign.filter.GatherFbmbilltypeRefModelFilter"}}),t.attrcode.indexOf("def")>-1&&(t.queryCondition=function(e){var t=a.props.search.getSearchValByField(a.searchId,"pk_org");if(t&&t.value&&t.value.firstvalue)return{pk_org:t.value.firstvalue}}),"pk_org"==t.attrcode&&(t.queryCondition=function(){return{funcode:e.getSearchParam("c")||e.getUrlParam("c"),TreeRefActionExt:"nccloud.web.tmpub.filter.FinanceOrgPermissionFilter"}}),t}))),t}},9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.URL_PARAM={ID:"id",STATE:"status",SCENE:"scene",TBB_LINK:"pk_ntbparadimvo",LINK_ID:"linkId",PK_SRC:"pk_src"},t.sagaField={frozen:"saga_frozen",gtxid:"saga_gtxid",btxid:"saga_btxid",status:"saga_status"},t.sagaFrozenEnum={frozen:1,unfrozen:0},t.sagaStateEnum={success:0,fail:1},t.SCENE={DEFAULT:"defaultsce",APPROVE:"approvesce",LINK:"linksce",FIP:"fip",OTHER:"othersce"},t.LINKTYPE={NORMAL:"NORMAL",BILL_REVIEW:"BILL_REVIEW"},t.LINK_PARAM={ARAP:{FLAG:"flag",FLAG_VALUE:"ftsLinkArap"}},t.MODULE_INFO={TMPUB:"tmpub",TMPUB_NUM:"3601"},t.COMMON_URL={ELECSIGNPRINTCHECK:"/nccloud/tmpub/pub/elecsignprintcheck.do"},t.cache={rateinfo:"rateinfo",iserrtoast:"iserrtoast"},t.SPLIT_TBBCTRLTYPE="_ctrltype_",t.tbbwarntype={flexibility:"0",inflexibility:"1",warning:"2"}}})}));
//# sourceMappingURL=index.fdcfee7b.js.map
/*bBCoqjxT9j3Xs5elv8XzMXkXcQatzZQbf2J+0PHwCbQn9I8O70gYqs6WRoYZRPPS*/