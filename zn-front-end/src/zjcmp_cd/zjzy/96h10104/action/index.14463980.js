/*! @ncctag {"project":"","branch":"","provider":"","date":"2021/10/20 下午12:36:11"} */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front")):"function"==typeof define&&define.amd?define(["nc-lightapp-front"],t):"object"==typeof exports?exports["zjcmp_cd/zjzy/96h10104/action/index"]=t(require("nc-lightapp-front")):e["zjcmp_cd/zjzy/96h10104/action/index"]=t(e["nc-lightapp-front"])}(window,(function(e){return function(e){var t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=33)}({0:function(t,a){t.exports=e},33:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initTemplate=function(e,t){var a=this;e.createUIDom({pagecode:o},(function(s){if(s){if(s.template){var n=s.template;n=h.call(a,e,n),e.meta.setMeta(n)}if(s.button){var o=s.button;e.button.setButtons(o),e.button.setButtonDisabled({Delete:!0}),e.button.setButtonDisabled({Edit:!0}),e.button.setPopContent("DelLine",a.state.json["96H10104-000019"])}}t()}))},t.onloaddata=function(){this.props.button.setButtonsVisible({Save:!1,Cancel:!1});var e={querycondition:{},pageInfo:this.props.editTable.getTablePageInfo("head"),pagecode:o,queryAreaCode:"search",oid:this.props.meta.getMeta().search.oid,querytype:"tree"};b.call(this,!1,e)},t.onClickButton=function(e,t){var a=this,l=e.editTable.getCheckedRows("head"),h=e.editTable.getTablePageInfo("head"),f=this.state.hasSearched&&1==this.state.hasSearched?e.search.getAllSearchData("search",!1):null,g=this.props.meta.getMeta().search.oid,v={pageInfo:h,querycondition:null==f?{}:f,pagecode:o,queryAreaCode:"search",oid:g,querytype:"tree"};switch(t){case"Add":e.editTable.setStatus("head","edit");var T=this.props.editTable.getNumberOfRows("head");e.editTable.addRow("head",T,!0),e.button.setButtonsVisible("Edit",!1),e.button.setMainButton("Add",!1);break;case"Cancel":(0,s.promptBox)({color:"warning",title:this.state.json["96H10104-000006"],content:this.state.json["96H10104-000007"],beSureBtnClick:function(){e.editTable.cancelEdit("head"),e.editTable.setStatus("head","browse"),e.button.setButtonDisabled("Edit",!0),e.button.setMainButton("Add",!0),e.button.setButtonDisabled("Delete",!0),d.call(a)}});break;case"Edit":e.editTable.setStatus("head","edit"),e.button.setButtonsVisible("Edit",!1),e.button.setMainButton("Add",!1);break;case"Save":e.editTable.filterEmptyRows("head",i);var w=e.editTable.getAllData("head");if(!w||0===w.length)return e.editTable.cancelEdit("head"),e.editTable.setStatus("head","browse"),e.button.setButtonsVisible("Edit",!0),e.button.setMainButton("Add",!0),void d.call(this);if(!e.editTable.checkRequired("head",w.rows))return;e.editTable.setStatus("head","browse");var y={pageid:o,model:{pageInfo:h,rows:w.rows,areaType:"table",areacode:"head"}};this.props.validateToSave(y,(function(){(0,s.ajax)({url:r.saveUrl,data:y,success:function(t){if(this.props.editTable.setStatus("head","browse"),t.data){var a=this.props.editTable.getAllData("head");!function(e,t){if(!t)return;e.rows&&e.rows.forEach((function(a,s){t.forEach((function(t,n){t.rowid===a.rowid&&(e.rows[s]=t)}))}))}(a,t.data.head.rows),this.props.editTable.setTableData("head",a),(0,s.toast)({color:"success",title:this.state.json["96H10104-000008"]})}e.button.setButtonDisabled("Edit",!0),e.button.setMainButton("Add",!0),e.button.setButtonDisabled("Delete",!0),d.call(this)}.bind(a)})}),n({},"head","editTable"),"grid");break;case"Delete":if(0!=l.length)if(e.editTable.getStatus("head")&&"edit"==e.editTable.getStatus("head")){var m=l.map((function(e){return e.index}));e.editTable.deleteTableRowsByIndex("head",m)}else{var j=l.map((function(e){return{status:"3",values:e.data.values}})),S={pageid:o,model:{areaType:"table",pageInfo:h,rows:j}};(0,s.promptBox)({color:"warning",title:this.state.json["96H10104-000009"],content:this.state.json["96H10104-000010"],beSureBtnClick:u.bind(this,S,v)})}else(0,s.promptBox)({color:"warning",title:this.state.json["96H10104-000011"],content:this.state.json["96H10104-000012"]});break;case"PrintGrp":case"Print":c.call(this);break;case"Output":p.call(this);break;case"Refresh":b.call(this,!1,v),(0,s.toast)({title:this.state.json["96H10104-000020"],color:"success"})}},t.onSelected=function(){var e=this.props.editTable.getCheckedRows("head"),t=!(e&&e.length>0);this.props.button.setButtonDisabled(["Delete"],t),this.props.button.setButtonDisabled(["Edit"],t),this.setState(this.state)},t.gridBeChecked=l,t.gridStatusChange=d,t.onClickPageInfo=function(e,t,a){var s=e.editTable.getTablePageInfo("head"),n=e.search.getAllSearchData("search"),o={pks:a,pageInfo:s,querycondition:n};b.call(this,!1,o,"pageQueryUrl")},t.onClickSearchBtn=function(e,t){e.editTable.getStatus()&&"edit"==e.editTable.getStatus()&&(0,s.promptBox)({color:"warning",title:this.state.json["96H10104-000011"],content:this.state.json["96H10104-000015"]});var a=this.props.meta.getMeta().search.oid,n={querycondition:null==t?{}:t,pageInfo:e.editTable.getTablePageInfo("head"),pagecode:o,queryAreaCode:"search",oid:a,querytype:"tree"};b.call(this,!0,n)};var s=a(0);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var o="96H10104_fundplanVO",i=["iseucountry"],r={queryUrl:"/nccloud/zjcmp_cd/fundplanVO/FundplanVOQuery.do",pageQueryUrl:"/nccloud/zjcmp_cd/fundplanVO/FundplanVOQueryPageGridByPks.do",saveUrl:"/nccloud/zjcmp_cd/fundplanVO/FundplanVOSave.do",printUrl:"/nccloud/zjcmp_cd/fundplanVO/FundplanVOPrint.do"};function l(e){var t=e.editTable.getCheckedRows("head").length;e.button.setDisabled({btnDel:0===t})}function d(){var e=this.props.editTable.getStatus("head");this.props.button.setButtonsVisible({Save:"browse"!==e,Cancel:"browse"!==e,Add:"browse"===e,Edit:"browse"===e,Delete:"browse"===e,Refresh:"browse"===e,PrintGrp:"browse"===e,Output:"browse"===e}),this.props.button.setPopContent("DelLine","browse"===e?this.state.json["96H10104-000000"]:"")}function u(e,t){var a=this;(0,s.ajax)({url:r.saveUrl,data:e,success:function(e){e.success?(a.props.button.setButtonDisabled(["Delete"],!0),b.call(a,!1,t),(0,s.toast)({color:"success",title:a.state.json["96H10104-000002"]})):alert(e.message)}})}function c(){var e=this.props.editTable.getAllData("head");if(0!==e.length){var t=[];e.rows.forEach((function(e,a){t.push(e.values.pk_country.value)})),(0,s.print)("pdf",r.printUrl,{funcode:"96H10104",nodekey:null,oids:t})}else(0,s.toast)({content:this.state.json["96H10104-000013"],color:"warning"})}function p(){var e=this.props.editTable.getAllData("head");if(0!==e.length){var t=[];e.rows.forEach((function(e,a){t.push(e.values.true.value)})),this.setState({ids:t},this.refs.printOutput.open())}else(0,s.toast)({content:this.state.json["96H10104-000014"],color:"warning"})}function b(e,t,a){var o=this,i=this,l=null==a?"queryUrl":a;(0,s.ajax)({url:r[l],data:t,success:function(t){var a=t.success,r=t.data;if(a){if(t.formulamsg&&t.formulamsg instanceof Array&&t.formulamsg.length>0&&i.props.dealFormulamsg(t.formulamsg,n({},"head","table")),t.hasOwnProperty("data")&&null!=r)i.props.editTable.setTableData("head",r.head),i.props.button.setButtonDisabled({PrintGrp:!1,Output:!1,Delete:!0,Edit:!0});else{i.props.editTable.setTableData("head",{rows:[]}),i.props.button.setButtonDisabled({PrintGrp:!0,Output:!0,Delete:!0,Edit:!0})}i.props.editTable.setStatus("browse"),!0===e&&(0,s.toast)({color:"success",content:o.state.json["96H10104-000003"]+r.head.allpks.length+o.state.json["96H10104-000004"]}),o.setState({hasSearched:!0})}},error:function(t){!0===e&&(0,s.toast)({color:"warning",content:o.state.json["96H10104-000005"]})}})}function h(e,t){var a=this;return t.head.showindex=!0,t.head.status="browse",t.head.pagination=!1,t.head.items.push({attrcode:"opr",label:this.state.json["96H10104-000001"],width:200,fixed:"right",className:"table-opr",itemtype:"customer",visible:!0,render:function(t,s,n){var o=function(e){return"browse"===e.editTable.getStatus("head")?["EditLine","DelLine"]:["Spread","DelLine"]}(e);return e.button.createOprationButton(o,{area:"table-opr-area",buttonLimit:3,onButtonClick:function(e,o){return f.call(a,e,o,t,s,n)}})}}),t}function f(e,t,a,n,i){var d=this;switch(t){case"DelLine":var u=e.editTable.getStatus("head");if("browse"==u||null==u){var c={status:"3",values:n.values},p={pageid:o,model:{areaType:"table",rows:[c]}};(0,s.ajax)({url:r.saveUrl,data:p,success:function(t){if(t.success){(0,s.toast)({color:"success",title:d.state.json["pk_lang-000002"]}),e.editTable.deleteTableRowsByIndex("head",i);var a=e.editTable.getAllData("head");!function(e){for(var t=e.length-1;t>=0;t--)"3"===e[t].status&&e.splice(t,1)}(a.rows),e.editTable.setTableData("head",a),l.call(d,e)}else alert(t.message)}})}else e.editTable.deleteTableRowsByIndex("head",i);break;case"EditLine":e.editTable.setStatus("head","edit"),e.button.setMainButton("Add",!1),e.editTable.openModel("head","edit",n,i);break;case"Spread":e.editTable.setStatus("head","edit"),e.editTable.openModel("head","edit",n,i);break;default:console.log(t,i)}}}})}));
//# sourceMappingURL=index.14463980.js.map